<?xml version="1.0"?>

<component name="org.nuxeo.theme.nuxeo.default">

  <require>org.nuxeo.theme.core</require>
  <require>org.nuxeo.theme.fragments</require>
  <require>org.nuxeo.theme.html</require>
  <require>org.nuxeo.theme.jsf</require>

  <!-- perspectives -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="perspectives">

    <perspective name="multiple_domains">
      <title>Perspective for multiple domains</title>
    </perspective>

  </extension>

  <!-- themes -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="themes">

    <theme>
      <src>themes/document-management.xml</src>
    </theme>

  </extension>

  <!-- views -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="views">

    <view name="Nuxeo DM logo (Galaxy Theme)" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/logo_DM_galaxy.xhtml</template>
    </view>

    <view name="nuxeo5 includes" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/includes.xhtml</template>
      <resource>dragdrop.js</resource>
      <resource>seam-remote.js</resource>
      <resource>foldable-box.js</resource>
      <resource>window.js</resource>
      <resource>window_effects.js</resource>
      <resource>waitdlg.js</resource>
      <!-- include JS used for D&D and tableSelection -->
      <resource>utils.js</resource>
      <!-- include JS for contextual menu -->
      <resource>jquery.fancybox.js</resource>
      <resource>jquery.fancybox.style.css</resource>
      <resource>jquery.tools.cookie.js</resource>
      <resource>fancybox-popup-utils.js</resource>
      <resource>contextmenu.js</resource>
      <resource>jquery.tools.focusfirst.js</resource>
      <resource>jquery.hotkeys.js</resource>
      <resource>sarissa-ie-workaround.js</resource>
      <resource>static-styles.css</resource>
      <resource>hideableAdminMessage.js</resource>
      <resource>accessKey.js</resource>
      <resource>jquery.nuxeo.doubleclickshield.js</resource>
      <resource>jquery.ambiance.js</resource>
      <resource>jquery.ambiance.css</resource>
      <resource>jquery.nuxeo.dropdown.js</resource>
      <resource>jquery.tipsy.js</resource>
      <resource>tipsy.css</resource>
      <resource>jquery.magnific-popup.js</resource>
      <resource>magnific-popup.css</resource>
      <resource>nuxeo-lightbox.js</resource>
      <resource>jquery.nuxeo.cv-lightbox.js</resource>
      <resource>nuxeo-documents-import.js</resource>
      <resource>fixmultipartajax.js</resource>
      <resource>nuxeo.js</resource>
    </view>

    <view name="Nuxeo header" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/nuxeo_header.xhtml</template>
      <resource>screen.css</resource>
    </view>

    <view name="nuxeo5 breadcrumbs" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/breadcrumb.xhtml</template>
    </view>

    <view name="nuxeo import" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/import.xhtml</template>
    </view>

    <view name="nuxeo5 tree explorer" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/multi_tree_explorer.xhtml</template>
    </view>

    <view name="nuxeo5 clip board" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/user_clipboard.xhtml</template>
      <resource>dragdrop.js</resource>
    </view>

    <view name="Nuxeo footer" template-engine="jsf-facelets">
      <format-type>widget</format-type>
      <template>incl/nuxeo_footer.xhtml</template>
    </view>

  </extension>

  <!-- resources -->
  <extension target="org.nuxeo.ecm.platform.WebResources" point="resources">

    <resource name="static-styles.css">
      <uri>/css/static-styles.css</uri>
    </resource>

    <resource name="screen.css">
      <uri>/css/screen.css</uri>
    </resource>

    <resource name="foldable-box.js">
      <uri>/scripts/foldable-box.js</uri>
      <require>effects.js</require>
    </resource>

    <resource name="window.js">
      <uri>/scripts/window.js</uri>
    </resource>
    <resource name="window_effects.js">
      <uri>/scripts/window_effects.js</uri>
    </resource>
    <resource name="waitdlg.js">
      <uri>/waitdialog/waitdlg.js</uri>
    </resource>
    <resource name="utils.js">
      <uri>/scripts/utils.js</uri>
    </resource>
    <resource name="tableSelections.js">
      <uri>/scripts/tableSelections.js</uri>
    </resource>
    <resource name="contextmenu.js">
      <uri>/scripts/contextmenu.js</uri>
    </resource>
    <resource name="DragAndDrop.js">
      <uri>/scripts/DragAndDrop.js</uri>
    </resource>
    <resource name="hideableAdminMessage.js">
      <uri>/scripts/hideableAdminMessage.js</uri>
    </resource>
    <!-- jquery cookie plugin -->
    <resource name="jquery.tools.cookie.js">
      <uri>/scripts/jquery/cookie.js</uri>
    </resource>
    <!-- Fancybox -->
    <resource name="jquery.fancybox.js">
      <uri>/scripts/jquery/jquery.fancybox.js</uri>
    </resource>
    <resource name="jquery.fancybox.style.css">
      <uri>/css/jquery.fancybox.css</uri>
    </resource>
    <resource name="fancybox-popup-utils.js">
      <uri>/scripts/fancybox-popup-utils.js</uri>
    </resource>
    <!-- Hotkeys (e.g. used to focus the search box using '/') -->
    <resource name="jquery.hotkeys.js">
      <uri>/scripts/jquery/jquery.hotkeys.js</uri>
    </resource>
    <!-- Helpers for focus on first input of a form -->
    <resource name="jquery.tools.focusfirst.js">
      <uri>/scripts/jquery/jquery.tools.focusfirst.js</uri>
    </resource>
    <!-- Workaround for jQuery and Sarissa library conflict on IE -->
    <resource name="sarissa-ie-workaround.js">
      <uri>/scripts/sarissa-ie-workaround.js</uri>
    </resource>
    <!-- Mustache -->
    <resource name="mustache.js">
      <uri>/scripts/mustache/mustache.js</uri>
    </resource>
    <!-- Simple Access Key helper -->
    <resource name="accessKey.js">
      <uri>/scripts/accessKey.js</uri>
    </resource>
    <!-- Moment.js -->
    <resource name="moment.js">
      <uri>/scripts/moment.min-1.5.0nx.js</uri>
    </resource>
    <!-- jquery-ui resources: order plugins according to their dependencies. -->
    <resource name="jquery.ui.core.js">
      <uri>/scripts/jquery/jquery.ui.core.js</uri>
    </resource>
    <resource name="jquery.ui.widget.js">
      <uri>/scripts/jquery/jquery.ui.widget.js</uri>
    </resource>
    <resource name="jquery.ui.mouse.js">
      <uri>/scripts/jquery/jquery.ui.mouse.js</uri>
    </resource>
    <resource name="jquery.ui.sortable.js">
      <uri>/scripts/jquery/jquery.ui.sortable.js</uri>
      <require>jquery.ui.core.js</require>
      <require>jquery.ui.widget.js</require>
      <require>jquery.ui.mouse.js</require>
    </resource>
    <!-- Double click shield -->
    <resource name="jquery.nuxeo.doubleclickshield.js">
      <uri>/scripts/jquery.nuxeo.doubleclickshield.js</uri>
    </resource>
    <!-- jQuery Ambiance -->
    <resource name="jquery.ambiance.js">
      <uri>/scripts/jquery/jquery.ambiance.js</uri>
    </resource>
    <resource name="jquery.ambiance.css">
      <uri>/css/jquery.ambiance.css</uri>
    </resource>
    <resource name="jquery.nuxeo.dropdown.js">
      <uri>/scripts/jquery/jquery.nuxeo.dropdown.js</uri>
    </resource>
    <resource name="jquery.tipsy.js">
      <uri>/scripts/jquery/jquery.tipsy.js</uri>
    </resource>
    <resource name="tipsy.css">
      <uri>/css/tipsy.css</uri>
    </resource>
    <resource name="jquery.nuxeo.tipsy.js">
      <uri>/scripts/jquery.nuxeo.tipsy.js</uri>
      <require>jquery.tipsy.js</require>
    </resource>
    <resource name="jquery.magnific-popup.js">
      <uri>/scripts/jquery/jquery.magnific-popup.js</uri>
    </resource>
    <resource name="magnific-popup.css">
      <uri>/css/magnific-popup.css</uri>
    </resource>
    <resource name="nuxeo-lightbox.js">
      <uri>/scripts/nuxeo-lightbox.js</uri>
    </resource>
    <resource name="jquery.nuxeo.cv-lightbox.js">
      <uri>/scripts/jquery.nuxeo.cv-lightbox.js</uri>
      <require>jquery.magnific-popup.js</require>
      <require>nuxeo-lightbox.js</require>
    </resource>
    <resource name="nuxeo-documents-import.js">
      <uri>/scripts/nuxeo-documents-import.js</uri>
    </resource>
    <resource name="fixmultipartajax.js">
      <uri>/scripts/fixmultipartajax.js</uri>
    </resource>

    <resource name="nuxeo.js">
      <path>bower_components/nuxeo/lib/jquery/nuxeo.js</path>
    </resource>
  </extension>

  <!-- Register mapping between theme pages and resources -->
  <extension target="org.nuxeo.theme.styling.service" point="pages">

    <themePage name="galaxy/print">
      <defaultFlavor>default</defaultFlavor>
      <flavors>
        <flavor>default</flavor>
      </flavors>
      <flavors>
        <flavor>rainbow</flavor>
      </flavors>
      <styles>
        <style>basics</style>
        <style>buttons_and_actions</style>
        <style>header</style>
        <style>body</style>
        <style>footer</style>
        <style>grids_and_widgets</style>
        <style>navigation</style>
        <style>forms</style>
        <style>messages_and_tooltips</style>
        <style>foldable_boxes</style>
        <style>tabs_content</style>
        <style>helpers</style>
        <style>print_generic</style>
      </styles>
    </themePage>

    <themePage name="galaxy/popup">
      <defaultFlavor>default</defaultFlavor>
      <flavors>
        <flavor>default</flavor>
        <flavor>rainbow</flavor>
      </flavors>
      <styles>
        <style>basics</style>
        <style>buttons_and_actions</style>
        <style>body</style>
        <style>grids_and_widgets</style>
        <style>navigation</style>
        <style>tables</style>
        <style>forms</style>
        <style>popups</style>
        <style>messages_and_tooltips</style>
        <style>foldable_boxes</style>
        <style>richfaces_components</style>
        <style>tabs_content</style>
        <style>helpers</style>
        <style>nuxeo_dm_specific</style>
      </styles>
    </themePage>

    <themePage name="galaxy/default">
      <defaultFlavor>default</defaultFlavor>
      <flavors>
        <flavor>default</flavor>
        <flavor>rainbow</flavor>
      </flavors>
      <styles>
        <style>basics</style>
        <style>buttons_and_actions</style>
        <style>header</style>
        <style>body</style>
        <style>footer</style>
        <style>grids_and_widgets</style>
        <style>navigation</style>
        <style>tables</style>
        <style>forms</style>
        <style>popups</style>
        <style>breadcrumb</style>
        <style>messages_and_tooltips</style>
        <style>foldable_boxes</style>
        <style>drag_and_drop</style>
        <style>richfaces_components</style>
        <style>tabs_content</style>
        <style>helpers</style>
        <style>nuxeo_dm_specific</style>
      </styles>
    </themePage>

  </extension>

  <!-- Register flavors (collections of presets) -->
  <extension target="org.nuxeo.theme.styling.service" point="flavors">

    <flavor name="default">
      <label>label.theme.flavor.nuxeo.default</label>
      <logo>
        <path>/img/nuxeo_logo.png</path>
        <previewPath>/img/nuxeo_preview_logo_black.png</previewPath>
        <width>113</width>
        <height>20</height>
        <title>Nuxeo</title>
      </logo>
      <presetsList>
        <presets category="border" src="themes/palettes/default-borders.properties" />
        <presets category="background"
          src="themes/palettes/default-backgrounds.properties" />
        <presets category="font" src="themes/palettes/default-fonts.properties" />
        <presets category="color" src="themes/palettes/default-colors.properties" />
      </presetsList>
      <palettePreview>
        <colors>
          <color>#17384e</color>
          <color>#00adff</color>
          <color>#00adff</color>
          <color>#00adff</color>
          <color>#fff</color>
          <color>#00adff</color>
          <color>#404040</color>
          <color>#cfecff</color>
          <color>#e6f1ff</color>
        </colors>
      </palettePreview>
    </flavor>

    <flavor name="rainbow">
      <label>label.theme.flavor.nuxeo.rainbow</label>
      <logo>
        <path>/img/nuxeo_logo.png</path>
        <previewPath>/img/nuxeo_preview_logo_black.png</previewPath>
        <width>113</width>
        <height>20</height>
        <title>Nuxeo</title>
      </logo>
      <presetsList append="true">
        <presets category="border" src="themes/palettes/rainbow-borders.properties" />
        <presets category="background"
          src="themes/palettes/rainbow-backgrounds.properties" />
        <presets category="font" src="themes/palettes/rainbow-fonts.properties" />
        <presets category="color" src="themes/palettes/rainbow-colors.properties" />
      </presetsList>
      <palettePreview>
        <colors>
          <color>#595ca1</color>
          <color>#bdd4ef</color>
          <color>#4095ff</color>
          <color>#da4f70</color>
          <color>#41b6ab</color>
          <color>#b34f94</color>
          <color>#332e2e</color>
          <color>#cfffd1</color>
          <color>#feffe6</color>
        </colors>
      </palettePreview>
    </flavor>

  </extension>

  <!-- Register style resources (contain indirect references to flavor names, i.e. 
    "__FLAVOR__") -->
  <extension target="org.nuxeo.ecm.platform.WebResources" point="resources">
    <!-- Global styles -->
    <resource name="breadcrumb.css">
      <path>themes/css/breadcrumb.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="buttons_and_actions.css">
      <path>themes/css/buttons_and_actions.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="basics.css">
      <path>themes/css/basics.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="body.css">
      <path>themes/css/body.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="drag_and_drop.css">
      <path>themes/css/drag_and_drop.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="foldable_boxes.css">
      <path>themes/css/foldable_boxes.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="forms.css">
      <path>themes/css/forms.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="grids_and_widgets.css">
      <path>themes/css/grids_and_widgets.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="messages_and_tooltips.css">
      <path>themes/css/messages_and_tooltips.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="navigation.css">
      <path>themes/css/navigation.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="popups.css">
      <path>themes/css/popups.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="richfaces_components.css">
      <path>themes/css/richfaces_components.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="tables.css">
      <path>themes/css/tables.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="tabs_content.css">
      <path>themes/css/tabs_content.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="helpers.css">
      <path>themes/css/helpers.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <!-- Header and Footer -->
    <resource name="header.css">
      <path>themes/css/header.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="footer.css">
      <path>themes/css/footer.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <!-- Specific to pages -->
    <resource name="nuxeo_dm_specific.css">
      <path>themes/css/nuxeo_dm_specific.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
    <resource name="print_generic.css">
      <path>themes/css/print_generic.css</path>
      <processors>
        <processor>flavor</processor>
      </processors>
    </resource>
  </extension>

  <!-- application settings -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="applications">

    <application root="${org.nuxeo.ecm.contextPath}"
      template-engine="jsf-facelets">

      <negotiation>
        <strategy>nuxeo5</strategy>
        <default-engine>default</default-engine>
        <default-theme>galaxy/default</default-theme>
        <default-perspective>default</default-perspective>
        <!-- TODO default collection/flavor... -->
      </negotiation>

      <!-- Cache control for theme resources (/nxthemes-lib/) -->
      <resource-caching>
        <lifetime>36000</lifetime>
      </resource-caching>

      <!-- Cache control for theme styles (/nxthemes-css/) -->
      <style-caching>
        <lifetime>900</lifetime>
      </style-caching>

      <view id="/create_relation_search_document_popup.xhtml">
        <theme>galaxy/popup</theme>
      </view>
      <view id="/dndFormCollector.xhtml">
        <theme>galaxy/popup</theme>
      </view>
      <view id="/editor_link_search_document.xhtml">
        <theme>galaxy/popup</theme>
      </view>
      <view id="/editor_image_upload.xhtml">
        <theme>galaxy/popup</theme>
      </view>

      <view id="/info_view.xhtml">
        <theme>galaxy/popup</theme>
      </view>

    </application>
  </extension>


  <!-- negotiation strategy for nuxeo5 -->
  <extension target="org.nuxeo.theme.services.ThemeService" point="negotiations">

    <negotiation object="theme" strategy="nuxeo5">
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.RequestParameter</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.CookieValue</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.ViewId</scheme>
      <!-- local theme (specific to nuxeo5) -->
      <scheme>org.nuxeo.ecm.localconf.LocalTheme</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.theme.DefaultTheme</scheme>
    </negotiation>

    <negotiation object="perspective" strategy="nuxeo5">
      <scheme>
        org.nuxeo.theme.jsf.negotiation.perspective.RequestParameter
      </scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.perspective.CookieValue</scheme>
      <scheme>org.nuxeo.theme.jsf.negotiation.perspective.ViewId</scheme>
      <!-- local perspective (specific to nuxeo5) -->
      <scheme>
        org.nuxeo.ecm.localconf.LocalPerspective
      </scheme>
      <scheme>
        org.nuxeo.theme.jsf.negotiation.perspective.DefaultPerspective
      </scheme>
    </negotiation>

    <negotiation object="collection" strategy="nuxeo5">
      <scheme>
        org.nuxeo.theme.jsf.negotiation.collection.RequestParameter
      </scheme>
      <scheme>
        org.nuxeo.theme.jsf.negotiation.collection.CookieValue
      </scheme>
      <scheme>
        org.nuxeo.theme.jsf.negotiation.collection.RequestAttribute
      </scheme>
      <scheme>
        org.nuxeo.theme.jsf.negotiation.collection.ViewId
      </scheme>
      <!-- local flavor/collection (specific to nuxeo5) -->
      <scheme>
        org.nuxeo.ecm.localconf.LocalThemeFlavor
      </scheme>
      <!-- default flavor/collection (specific to nuxeo5) -->
      <scheme>
        org.nuxeo.ecm.webapp.webcontainer.DefaultThemeFlavor
      </scheme>
      <scheme>
        org.nuxeo.theme.jsf.negotiation.collection.UnspecifiedCollection
      </scheme>
    </negotiation>

  </extension>

</component>
