<component name="org.nuxeo.ecm.platform.routing.audit" version="1.0">

  <extension target="org.nuxeo.ecm.platform.audit.service.NXAuditEventsService"
    point="event">
    <event name="auditLogRoute" />
    <event name="workflowTaskAssigned" />
    <event name="workflowTaskReassigned" />
    <event name="workflowTaskCompleted" />
    <event name="workflowCanceled" />
    <event name="workflowTaskDelegated" />
    <event name="afterWorkflowStarted">
      <extendedInfos>
        <extendedInfo expression="${message.properties.modelId}" key="modelId" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.initiator}" key="initiator" />
        <extendedInfo expression="${message.properties.variables}" key="variables" />
      </extendedInfos>
    </event>
    <event name="afterWorkflowFinish">
      <extendedInfos>
        <extendedInfo expression="${message.properties.modelId}" key="modelId" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.duration}" key="duration" />
        <extendedInfo expression="${message.properties.variables}" key="variables" />
      </extendedInfos>
    </event>
    <event name="beforeWorkflowCanceled">
      <extendedInfos>
        <extendedInfo expression="${principal.name}" key="user" />
        <extendedInfo expression="${message.properties.modelId}" key="modelId" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.pendingNodes}" key="pendingNodes" />
        <extendedInfo expression="${message.properties.variables}" key="variables" />
      </extendedInfos>
    </event>
    <event name="afterWorkflowTaskEnded">
      <extendedInfos>
        <extendedInfo expression="${message.properties.user}" key="user" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.taskName}" key="taskName" />
        <extendedInfo expression="${message.properties.data}" key="data" />
        <extendedInfo expression="${message.properties.status}" key="status" />
        <extendedInfo expression="${message.properties.nodeVariables}" key="nodeVariables" />
        <extendedInfo expression="${message.properties.workflowVariables}" key="workflowVariables" />
      </extendedInfos>
    </event>
    <event name="afterWorkflowTaskCreated">
      <extendedInfos>
        <extendedInfo expression="${principal.properties.user}" key="user" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.modelId}" key="modelId" />
        <extendedInfo expression="${message.properties.taskName}" key="taskName" />
        <extendedInfo expression="${message.properties.actors}" key="actors" />
        <extendedInfo expression="${message.properties.nodeVariables}" key="nodeVariables" />
        <extendedInfo expression="${message.properties.workflowVariables}" key="workflowVariables" />
      </extendedInfos>
    </event>
    <event name="afterWorkflowTaskReassigned">
      <extendedInfos>
        <extendedInfo expression="${principal.properties.user}" key="user" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.modelId}" key="modelId" />
        <extendedInfo expression="${message.properties.taskName}" key="taskName" />
        <extendedInfo expression="${message.properties.actors}" key="actors" />
        <extendedInfo expression="${message.properties.comment}" key="comment" />
      </extendedInfos>
    </event>
    <event name="afterWorkflowTaskDelegated">
      <extendedInfos>
        <extendedInfo expression="${principal.properties.user}" key="user" />
        <extendedInfo expression="${message.properties.modelName}" key="modelName" />
        <extendedInfo expression="${message.properties.modelId}" key="modelId" />
        <extendedInfo expression="${message.properties.taskName}" key="taskName" />
        <extendedInfo expression="${message.properties.delegatedActors}" key="delegatedActors" />
        <extendedInfo expression="${message.properties.comment}" key="comment" />
      </extendedInfos>
    </event>
  </extension>

</component>
