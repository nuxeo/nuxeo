<?xml version="1.0"?>
<component name="org.nuxeo.ecm.webengine.default.webapp">

  <documentation>
    @author Bogdan Stefanescu (bs@nuxeo.com)
    Default Objects
  </documentation>

  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent" point="rendering-extension">
    <rendering-extension name="script" class="org.nuxeo.ecm.webengine.rendering.ScriptMethod"/>
    <rendering-extension name="render" class="org.nuxeo.ecm.webengine.rendering.RenderDirective"/>
    <rendering-extension name="wiki" class="org.nuxeo.ecm.platform.rendering.wiki.WikiTransformer"/>
    <rendering-extension name="API" class="org.nuxeo.ecm.webengine.rendering.APIHelper"/>
  </extension>

  <extension target="org.nuxeo.ecm.webengine.rendering.wiki" point="rendering-extension">
    <rendering-extension name="wiki" serializer="org.nuxeo.ecm.platform.rendering.wiki.WikiSerializer">
      <filter pattern="[A-Z]+[a-z]+[A-Z][A-Za-z]*" replacement="&lt;a href='./$0'&gt;$0&lt;/a&gt;"/>
      <filter pattern="NXP-[0-9]+" replacement="&lt;a href='http://jira.nuxeo.org/browse/$0'&gt;$0&lt;/a&gt;"/>
    </rendering-extension>
  </extension>


  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent"
    point="binding">
    <binding type="Document" objectId="WebObject" />
  </extension>

  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent"
    point="webObject">
    <object id="WebObject">
      <actions>
        <action id="view" enabled="true">
          <permission  expression="Read"/>
        </action>
        <action id="content_page" enabled="true">
          <permission  expression="Read"/>
          <category>TABVIEW</category>
        </action>
        <action id="versions_page" enabled="true">
          <permission expression="Read"/>
          <category>TABVIEW</category>
        </action>
        <action id="edit_page" enabled="true">
          <permission expression="Write" />
          <category>TABVIEW</category>
        </action>
        <action id="permissions_page" enabled="true">
          <permission expression="Write" />
          <category>TABVIEW</category>
        </action>
        <action id="print" enabled="true">
          <permission expression="Read" />
          <category>TOOLBOX</category>
        </action>
        <action id="delete" enabled="true" handler="org.nuxeo.ecm.webengine.actions.DeleteActionHandler">
          <permission expression="Write" />
          <category>TOOLBOX</category>
        </action>
        <action id="create_page" enabled="true">
          <permission expression="Write AND facet=Folderish" />
          <category>TOOLBOX</category>
        </action>
        <action id="create" enabled="true" handler="org.nuxeo.ecm.webengine.actions.CreateActionHandler">
          <permission expression="Write" />
        </action>
        <action id="update" enabled="true" handler="org.nuxeo.ecm.webengine.actions.UpateActionHandler">
          <permission expression="Write" />
        </action>
        <action id="getfile" enabled="true" handler="org.nuxeo.ecm.webengine.actions.GetFileActionHandler">
          <permission expression="Read" />
        </action>
        <action id="addfile" enabled="true" handler="org.nuxeo.ecm.webengine.actions.AddFileActionHandler">
          <permission expression="Write" />
        </action>
        <action id="deletefile" enabled="true" handler="org.nuxeo.ecm.webengine.actions.DeleteFileActionHandler">
          <permission expression="Write" />
        </action>
        <action id="addpermission" enabled="true" script="/Document/addpermission.groovy">
          <permission expression="Write" />
        </action>
        <action id="remove_permission" enabled="true" script="/Document/remove_permission.groovy">
          <permission expression="Write" />
        </action>
        <action id="search" enabled="true" script="/common/search.ftl">
          <permission expression="Browse" />
        </action>
      </actions>
    </object>

  </extension>

  <!--  web applications -->
  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent"
    point="application-mapping">
    <mapping path="/" webapp="default" />
    <mapping path="/repository" webapp="default" document="/default-domain" default="true" />
  </extension>


  <extension target="org.nuxeo.ecm.webengine.WebEngineComponent"
    point="application">
    <webapp id="default">
      <repository>default</repository>
      <errorPage>error.groovy</errorPage>
      <roots>
        <root priority="0">default</root>
      </roots>
      <mappings>
        <mapping pattern="/search">
          <script>/common/search.ftl</script>
        </mapping>
        <mapping pattern="/login">
          <script>/common/login.groovy</script>
        </mapping>
        <mapping pattern="/logout">
          <script>/common/logout.groovy</script>
        </mapping>
      </mappings>
    </webapp>

  </extension>


</component>
