<div xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
  xmlns:nxdir="http://nuxeo.org/nxdirectory"
  xmlns:nxu="http://nuxeo.org/nxweb/util">

<h3><h:outputText value="#{messages['label.search.form.simple']}" /></h3>

<h:outputText value="#{messages['label.search.form.desc']}" class="infoMessage" />

<h:inputHidden value="#{searchActions.searchTypeId}">
  <f:attribute name="value" value="FORM" />
</h:inputHidden>

<br />

<script language="javascript">
  function popupSearch(createFormId, url) {
    popup = window.open(url, '_blank', 'toolbar=0, scrollbars=1, location=0, statusbar=0, menubar=0, resizable=1, dependent=1, width=712, height=480');
    if(!popup.opener) {
      popup.opener = window;
    }
    return false;
  }
</script>

<c:set var="doc" value="#{searchDocumentModel}" />

<h:panelGrid columns="2" styleClass="dataInput"
  columnClasses="labelColumn, labelColumn, fieldColumn">

  <h:outputText value="#{messages['label.search.all_words']}" />
  <h:inputText value="#{doc.advanced_search.fulltext_all}"
    styleClass="dataInputText" />

  <h:outputText value="#{messages['lable.search.exact_text']}" />
  <h:inputText value="#{doc.advanced_search.fulltext_phrase}"
    styleClass="dataInputText" />

  <h:outputText value="#{messages['label.search.one_word']}" />
  <h:inputText value="#{doc.advanced_search.fulltext_one_of}"
    styleClass="dataInputText" />

  <h:outputText value="#{messages['label.search.no_word']}" />
  <h:inputText value="#{doc.advanced_search.fulltext_none}"
    styleClass="dataInputText" />
</h:panelGrid>

<br />

<table class="dataInput">
  <tbody>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.title']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.title}"
            styleClass="dataInputText" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.description']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.description}"
          styleClass="dataInputText" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.rights']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.rights}"
          styleClass="dataInputText" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.source']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.source}"
          styleClass="dataInputText" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.coverage']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <nxdir:chainSelect size="2" multiSelect="true" multiParentSelect="true"
          allowBranchSelection="false" value="#{doc.advanced_search.coverage}"
          id="coverage">
          <nxdir:chainSelectListbox id="continent" index="0" size="4"
            directoryName="continent" localize="true">
            <a4j:support event="onchange" reRender="country,coverageSelection" />
          </nxdir:chainSelectListbox>

          <nxdir:chainSelectListbox id="country" size="4" directoryName="country"
            index="1" localize="true">
          </nxdir:chainSelectListbox>

          <a4j:commandButton value="#{messages['command.add']}" styleClass="button"
            immediate="true" actionListener="#{chainSelectActions.add}"
            reRender="coverageSelection" />

          <br />
          <nxdir:chainSelectStatus id="coverageSelection" display="value"
            entryCssStyle="background-color: #DDEEFF"
            label="#{messages['label.chainSelect.selection']}">
            <f:facet name="removeButton">
              <a4j:commandButton actionListener="#{chainSelectActions.delete}"
                immediate="true" reRender="coverageSelection"
                image="/img/toggle_minus.png" />
            </f:facet>
          </nxdir:chainSelectStatus>
        </nxdir:chainSelect>
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.creationDate']}" />
        <h:outputText value=" #{messages['label.search.between']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.created_min}"
          showsTime="true" format="#{nxu:basicDateFormater()}" />
      </td>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.search.and']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.created_max}"
          showsTime="true" format="#{nxu:basicDateFormater()}" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.modificationDate']}" />
        <h:outputText value=" #{messages['label.search.between']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.modified_min}"
          format="#{nxu:basicDateFormater()}" />
      </td>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.search.and']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.modified_max}"
          format="#{nxu:basicDateFormater()}" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.issueDate']}" />
        <h:outputText value=" #{messages['label.search.between']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.issued_min}"
          format="#{nxu:basicDateFormater()}" />
      </td>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.search.and']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.issued_max}"
          format="#{nxu:basicDateFormater()}" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.validationDate']}" />
        <h:outputText value=" #{messages['label.search.between']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.valid_min}"
          format="#{nxu:basicDateFormater()}" />
      </td>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.search.and']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.valid_max}"
          format="#{nxu:basicDateFormater()}" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.expirationDate']}" />
        <h:outputText value=" #{messages['label.search.between']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.expired_min}"
          format="#{nxu:basicDateFormater()}" />
      </td>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.search.and']}" />
      </td>
      <td class="fieldColumn">
        <nxu:inputDateTime value="#{doc.advanced_search.expired_max}"
          format="#{nxu:basicDateFormater()}" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.format']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.format}"
          styleClass="dataInputText" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.advanced_search.searchpath']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.searchpath}"
          styleClass="dataInputText" id="searchscope" />
        <!-- XXX: the /nuxeo/ prefix should be dynamically looked up -->
        <nxu:methodResult name="url"
          value="#{restHelper.addCurrentConversationParameters('/nuxeo/search/choose_searchscope_popup.faces')}">
          <input type="button" value="#{messages['command.advancedsearch.browse']}"
            class="button" onclick="javascript:popupSearch(this.form.id, '#{url}');" />
        </nxu:methodResult>
        <f:subview rendered="false">
          Example of how to put local search tree in an existing form
          <ui:include src="/search/search_path_tree_explorer.xhtml" />
        </f:subview>
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:outputText value="#{messages['label.dublincore.language']}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:inputText value="#{doc.advanced_search.language}"
          styleClass="dataInputText" />
      </td>
    </tr>
    <tr>
      <td class="labelColumn">
        <h:selectBooleanCheckbox value="#{deleteActions.searchDeletedDocuments}"
          rendered="#{deleteActions.trashManagementEnabled}" />
      </td>
      <td class="fieldColumn" colspan="3">
        <h:outputText value="#{messages['label.search.deleted.documents']}" />
      </td>
    </tr>
  </tbody>
</table>

</div>