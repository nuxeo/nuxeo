<div xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:t="http://myfaces.apache.org/tomahawk"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:c="http://java.sun.com/jstl/core" id="a1"
  xmlns:nxh="http://nuxeo.org/nxweb/html"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxd="http://nuxeo.org/nxweb/document"
  xmlns:s="http://jboss.com/products/seam/taglib">
  <c:if test="#{clipboardActions.initialized}">


<h:form rendered="#{!currentUser.anonymous}">

  <s:cache key="#{clipboardActions.cacheKey}" enabled="#{clipboardActions.cacheEnabled}">

  <h:panelGroup id="ClipboardListView">
    <!-- Top of the rounded box -->

    <div class="userClipboard">
          <div class="userClipboardTabs">

          <t:dataList var="docList" layout="unorderedList"
        value="#{clipboardActions.descriptorsForAvailableLists}"
        itemStyleClass="#{nxu:test(clipboardActions.currentSelectedListName == docList.name, 'selected', '')}">
          <h:commandLink value=""
            action="#{clipboardActions.selectList}"
            reRender="ClipboardListView,ClipboardDroppable">
            <f:param name="listIdToSelect" value="#{docList.name}" />
            <nxu:graphicImage value="#{docList.imageURL}" title="#{messages[docList.title]}" />
          </h:commandLink>
        </t:dataList>

     </div>

     <div style="clear:both;"></div>

     <div class="userClipboardContent">
      <h4><h:outputText
        value="#{messages[clipboardActions.currentSelectedListTitle]}" /></h4>

      <div id="clipboardCopy">

      <t:dataList var="copiedDocument"
        value="#{clipboardActions.currentSelectedList}">
        <div id="docRef:#{copiedDocument.ref}" class="cell">
          <span class="clipboardRemoveItem">
           <h:commandLink
              actionListener="#{clipboardActions.removeWorkListItem(copiedDocument.ref)}"
              >
              <t:graphicImage value="/icons/action_delete_mini.gif" />
            </h:commandLink>
          </span>
          <t:graphicImage
          value="#{nxd:iconPath(copiedDocument)}" styleClass="iconImage" />
          <nxd:restDocumentLink document="#{copiedDocument}">
          <h:outputText
          value="#{nxd:titleOrId(copiedDocument)}" />
          </nxd:restDocumentLink></div>
        <script type="text/javascript">
              <h:outputText value="new Draggable('docRef:#{copiedDocument.ref}', {revert:true});"/>
        </script>
      </t:dataList>

      <div class="clipboardEmptyMessage">
        <h:outputText
        value="#{messages['label.clipboard.empty']}"
        rendered="#{clipboardActions.workListEmpty}" />
      </div>

      </div>
      <div class="clipboardFunctions">
      <t:dataList var="cb_action" value="#{clipboardActions.actionsForCurrentList}" >
        <div class="clipboardFunction">
         <nxh:commandLink action="#{cb_action.getLink()}">
            <t:graphicImage value="#{cb_action.icon}"/>
            <h:outputText value=" #{messages[cb_action.label]}" />
          </nxh:commandLink>
        </div>
      </t:dataList>
      </div>

      </div>

      <!-- Bottom of the rounded box -->

      <p class="nobottomgap"></p>

      </div>

      <div class="bottom-left"></div>
      <div class="bottom-right"></div>



  </h:panelGroup>
  </s:cache>
</h:form>

  <h:panelGroup id="ClipboardDroppable">
    <script type="text/javascript">
    <h:outputText value="Droppables.add('clipboardCopy', {accept:'cell', onDrop:function(element){copyElement(element)}, hoverclass:'dropIntoClipboardCopy'});"/>
  </script>
    </h:panelGroup>


</c:if></div>