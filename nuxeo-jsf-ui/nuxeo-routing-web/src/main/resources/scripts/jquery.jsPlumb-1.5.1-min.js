(function(){if(typeof Math.sgn=="undefined"){Math.sgn=function(z){return z==0?0:z>0?1:-1}}var k={subtract:function(A,z){return{x:A.x-z.x,y:A.y-z.y}},dotProduct:function(A,z){return(A.x*z.x)+(A.y*z.y)},square:function(z){return Math.sqrt((z.x*z.x)+(z.y*z.y))},scale:function(z,A){return{x:z.x*A,y:z.y*A}}},w=64,r=Math.pow(2,-w-1);var o=function(I,A){var F=[],H=f(I,A),C=A.length-1,z=(2*C)-1,E=p(H,z,F,0),J=k.subtract(I,A[0]),G=k.square(J),K=0;for(var D=0;D<E;D++){J=k.subtract(I,v(A,C,F[D],null,null));var B=k.square(J);if(B<G){G=B;K=F[D]}}J=k.subtract(I,A[C]);B=k.square(J);if(B<G){G=B;K=1}return{location:K,distance:G}};var b=function(z,A){var B=o(z,A);return{point:v(A,A.length-1,B.location,null,null),location:B.location}};var f=function(P,F){var I=F.length-1,B=(2*I)-1,N=[],L=[],D=[],O=[],M=[[1,0.6,0.3,0.1],[0.4,0.6,0.6,0.4],[0.1,0.3,0.6,1]];for(var K=0;K<=I;K++){N[K]=k.subtract(F[K],P)}for(var K=0;K<=I-1;K++){L[K]=k.subtract(F[K+1],F[K]);L[K]=k.scale(L[K],3)}for(var Q=0;Q<=I-1;Q++){for(var H=0;H<=I;H++){if(!D[Q]){D[Q]=[]}D[Q][H]=k.dotProduct(L[Q],N[H])}}for(K=0;K<=B;K++){if(!O[K]){O[K]=[]}O[K].y=0;O[K].x=parseFloat(K)/B}var E=I,G=I-1;for(var J=0;J<=E+G;J++){var C=Math.max(0,J-G),A=Math.min(J,E);for(K=C;K<=A;K++){j=J-K;O[K+j].y+=D[j][K]*M[j][K]}}return O};var p=function(G,B,J,D){var A=[],I=[],E,F,H=[],z=[];switch(c(G,B)){case 0:return 0;case 1:if(D>=w){J[0]=(G[0].x+G[B].x)/2;return 1}if(d(G,B)){J[0]=h(G,B);return 1}break}v(G,B,0.5,A,I);E=p(A,B,H,D+1);F=p(I,B,z,D+1);for(var C=0;C<E;C++){J[C]=H[C]}for(var C=0;C<F;C++){J[C+E]=z[C]}return(E+F)};var c=function(E,D){var C=0,A,z;A=z=Math.sgn(E[0].y);for(var B=1;B<=D;B++){A=Math.sgn(E[B].y);if(A!=z){C++}z=A}return C};var d=function(H,B){var N,A,z,J,G,R,Q,P,D,C,T,F,K,S,E,I;R=H[0].y-H[B].y;Q=H[B].x-H[0].x;P=H[0].x*H[B].y-H[B].x*H[0].y;var M=max_distance_below=0;for(var O=1;O<B;O++){var L=R*H[O].x+Q*H[O].y+P;if(L>M){M=L}else{if(L<max_distance_below){max_distance_below=L}}}T=0;F=1;K=0;S=R;E=Q;I=P-M;D=T*E-S*F;C=1/D;A=(F*I-E*K)*C;S=R;E=Q;I=P-max_distance_below;D=T*E-S*F;C=1/D;z=(F*I-E*K)*C;J=Math.min(A,z);G=Math.max(A,z);N=G-J;return(N<r)?1:0};var h=function(B,C){var F=1,H=0,I=B[C].x-B[0].x,J=B[C].y-B[0].y,z=B[0].x-0,D=B[0].y-0,G=I*H-J*F,A=1/G,E=(I*D-J*z)*A;return 0+F*E};var v=function(G,F,D,E,C){var z=[[]];for(var A=0;A<=F;A++){z[0][A]=G[A]}for(var B=1;B<=F;B++){for(var A=0;A<=F-B;A++){if(!z[B]){z[B]=[]}if(!z[B][A]){z[B][A]={}}z[B][A].x=(1-D)*z[B-1][A].x+D*z[B-1][A+1].x;z[B][A].y=(1-D)*z[B-1][A].y+D*z[B-1][A+1].y}}if(E!=null){for(A=0;A<=F;A++){E[A]=z[A][0]}}if(C!=null){for(A=0;A<=F;A++){C[A]=z[F-A][A]}}return(z[F][0])};var t={};var g=function(C){var J=t[C];if(!J){J=[];var D=function(){return function(K){return Math.pow(K,C)}},B=function(){return function(K){return Math.pow((1-K),C)}},H=function(K){return function(L){return K}},I=function(){return function(K){return K}},z=function(){return function(K){return 1-K}},A=function(K){return function(M){var N=1;for(var L=0;L<K.length;L++){N=N*K[L](M)}return N}};J.push(new D());for(var G=1;G<C;G++){var F=[new H(C)];for(var E=0;E<(C-G);E++){F.push(new I())}for(var E=0;E<G;E++){F.push(new z())}J.push(new A(F))}J.push(new B());t[C]=J}return J};var m=function(D,z){var E=g(D.length-1),B=0,A=0;for(var C=0;C<D.length;C++){B=B+(D[C].x*E[C](z));A=A+(D[C].y*E[C](z))}return{x:B,y:A}};var e=function(A,z){return Math.sqrt(Math.pow(A.x-z.x,2)+Math.pow(A.y-z.y,2))};var u=function(z){return z[0].x==z[1].x&&z[0].y==z[1].y};var l=function(F,A,G){if(u(F)){return{point:F[0],location:A}}var C=m(F,A),z=0,B=A,D=G>0?1:-1,E=null;while(z<Math.abs(G)){B+=(0.005*D);E=m(F,B);z+=e(E,C);C=E}return{point:E,location:B}};var q=function(E){if(u(E)){return 0}var B=m(E,0),z=0,A=0,C=1,D=null;while(A<1){A+=(0.005*C);D=m(E,A);z+=e(D,B);B=D}return z};var y=function(A,z,B){return l(A,z,B).point};var a=function(A,z,B){return l(A,z,B).location};var n=function(E,A){var D=m(E,A),C=m(E.slice(0,E.length-1),A),z=C.y-D.y,B=C.x-D.x;return z==0?Infinity:Math.atan(z/B)};var s=function(B,z,C){var A=l(B,z,C);if(A.location>1){A.location=1}if(A.location<0){A.location=0}return n(B,A.location)};var x=function(C,G,B,z){z=z==null?0:z;var A=l(C,G,z),D=n(C,A.location),H=Math.atan(-1/D),E=B/2*Math.sin(H),F=B/2*Math.cos(H);return[{x:A.point.x+F,y:A.point.y+E},{x:A.point.x-F,y:A.point.y-E}]};var i=window.jsBezier={distanceFromCurve:o,gradientAtPoint:n,gradientAtPointAlongCurveFrom:s,nearestPointOnCurve:b,pointOnCurve:m,pointAlongCurveFrom:y,perpendicularToCurveAt:x,locationAlongCurveFrom:a,getLength:q}})();(function(){var k=function(l){return Object.prototype.toString.call(l)==="[object Array]"},e=function(l){return Object.prototype.toString.call(l)==="[object Number]"},a=function(l){return typeof l==="string"},i=function(l){return typeof l==="boolean"},c=function(l){return l==null},d=function(l){return l==null?false:Object.prototype.toString.call(l)==="[object Object]"},h=function(l){return Object.prototype.toString.call(l)==="[object Date]"},f=function(l){return Object.prototype.toString.call(l)==="[object Function]"},g=function(m){for(var l in m){if(m.hasOwnProperty(l)){return false}}return true},b=function(n,m,l){n=k(n)?n:[n.x,n.y];m=k(m)?m:[m.x,m.y];return l(n,m)};jsPlumbUtil={isArray:k,isString:a,isBoolean:i,isNull:c,isObject:d,isDate:h,isFunction:f,isEmpty:g,isNumber:e,clone:function(m){if(a(m)){return""+m}else{if(i(m)){return !!m}else{if(h(m)){return new Date(m.getTime())}else{if(f(m)){return m}else{if(k(m)){var l=[];for(var o=0;o<m.length;o++){l.push(this.clone(m[o]))}return l}else{if(d(m)){var p={};for(var n in m){p[n]=this.clone(m[n])}return p}else{return m}}}}}}},merge:function(m,l){var q=this.clone(m);for(var p in l){if(q[p]==null||a(l[p])||i(l[p])){q[p]=l[p]}else{if(k(l[p])){var n=[];if(k(q[p])){n.push.apply(n,q[p])}n.push.apply(n,l[p]);q[p]=n}else{if(d(l[p])){if(!d(q[p])){q[p]={}}for(var o in l[p]){q[p][o]=l[p][o]}}}}}return q},copyValues:function(m,o,n){for(var l=0;l<m.length;l++){n[m[l]]=o[m[l]]}},functionChain:function(n,q,m){for(var l=0;l<m.length;l++){var p=m[l][0][m[l][1]].apply(m[l][0],m[l][2]);if(p===q){return p}}return n},populate:function(n,m){var l=function(s){var q=s.match(/(\${.*?})/g);if(q!=null){for(var p=0;p<q.length;p++){var r=m[q[p].substring(2,q[p].length-1)];if(r!=null){s=s.replace(q[p],r)}}}return s},o=function(v){if(v!=null){if(a(v)){return l(v)}else{if(k(v)){var u=[];for(var q=0;q<v.length;q++){u.push(o(v[q]))}return u}else{if(d(v)){var t={};for(var p in v){t[p]=o(v[p])}return t}else{return v}}}}};return o(n)},convertStyle:function(m,l){if("transparent"===m){return m}var t=m,r=function(o){return o.length==1?"0"+o:o},n=function(o){return r(Number(o).toString(16))},p=/(rgb[a]?\()(.*)(\))/;if(m.match(p)){var q=m.match(p)[2].split(",");t="#"+n(q[0])+n(q[1])+n(q[2]);if(!l&&q.length==4){t=t+n(q[3])}}return t},gradient:function(m,l){return b(m,l,function(o,n){if(n[0]==o[0]){return n[1]>o[1]?Infinity:-Infinity}else{if(n[1]==o[1]){return n[0]>o[0]?0:-0}else{return(n[1]-o[1])/(n[0]-o[0])}}})},normal:function(m,l){return -1/this.gradient(m,l)},lineLength:function(m,l){return b(m,l,function(o,n){return Math.sqrt(Math.pow(n[1]-o[1],2)+Math.pow(n[0]-o[0],2))})},segment:function(m,l){return b(m,l,function(o,n){if(n[0]>o[0]){return(n[1]>o[1])?2:1}else{if(n[0]==o[0]){return n[1]>o[1]?2:1}else{return(n[1]>o[1])?3:4}}})},theta:function(m,l){return b(m,l,function(p,o){var n=jsPlumbUtil.gradient(p,o),q=Math.atan(n),r=jsPlumbUtil.segment(p,o);if((r==4||r==3)){q+=Math.PI}if(q<0){q+=(2*Math.PI)}return q})},intersects:function(q,p){var n=q.x,l=q.x+q.w,u=q.y,s=q.y+q.h,o=p.x,m=p.x+p.w,t=p.y,r=p.y+p.h;return((n<=o&&o<=l)&&(u<=t&&t<=s))||((n<=m&&m<=l)&&(u<=t&&t<=s))||((n<=o&&o<=l)&&(u<=r&&r<=s))||((n<=m&&o<=l)&&(u<=r&&r<=s))||((o<=n&&n<=m)&&(t<=u&&u<=r))||((o<=l&&l<=m)&&(t<=u&&u<=r))||((o<=n&&n<=m)&&(t<=s&&s<=r))||((o<=l&&n<=m)&&(t<=s&&s<=r))},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(l,q,n){var p=jsPlumbUtil.gradient(l,q),v=jsPlumbUtil.segment(l,q),u=n>0?jsPlumbUtil.segmentMultipliers[v]:jsPlumbUtil.inverseSegmentMultipliers[v],o=Math.atan(p),r=Math.abs(n*Math.sin(o))*u[1],t=Math.abs(n*Math.cos(o))*u[0];return{x:l.x+t,y:l.y+r}},perpendicularLineTo:function(o,p,q){var n=jsPlumbUtil.gradient(o,p),r=Math.atan(-1/n),s=q/2*Math.sin(r),l=q/2*Math.cos(r);return[{x:p.x+l,y:p.y+s},{x:p.x-l,y:p.y-s}]},findWithFunction:function(l,n){if(l){for(var m=0;m<l.length;m++){if(n(l[m])){return m}}}return -1},clampToGrid:function(l,q,n,p,o){var m=function(v,r){var u=v%r,s=Math.floor(v/r),t=u>=(r/2)?1:0;return(s+t)*r};return[p||n==null?l:m(l,n[0]),o||n==null?q:m(q,n[1])]},indexOf:function(m,n){return jsPlumbUtil.findWithFunction(m,function(l){return l==n})},removeWithFunction:function(m,n){var l=jsPlumbUtil.findWithFunction(m,n);if(l>-1){m.splice(l,1)}return l!=-1},remove:function(n,o){var m=jsPlumbUtil.indexOf(n,o);if(m>-1){n.splice(m,1)}return m!=-1},addWithFunction:function(n,m,l){if(jsPlumbUtil.findWithFunction(n,l)==-1){n.push(m)}},addToList:function(q,n,p,o){var m=q[n];if(m==null){m=[];q[n]=m}m[o?"unshift":"push"](p);return m},extend:function(s,q,p,r){p=p||{};r=r||{};q=k(q)?q:[q];for(var o=0;o<q.length;o++){for(var n in q[o].prototype){if(q[o].prototype.hasOwnProperty(n)){s.prototype[n]=q[o].prototype[n]}}}var m=function(t){return function(){for(var u=0;u<q.length;u++){if(q[u].prototype[t]){q[u].prototype[t].apply(this,arguments)}}return p[t].apply(this,arguments)}};for(var l in p){s.prototype[l]=m(l)}return s},uuid:function(){return("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var m=Math.random()*16|0,l=n=="x"?m:(m&3|8);return l.toString(16)}))},logEnabled:true,log:function(){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){try{var m=arguments[arguments.length-1];console.log(m)}catch(l){}}},group:function(l){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.group(l)}},groupEnd:function(l){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.groupEnd(l)}},time:function(l){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.time(l)}},timeEnd:function(l){if(jsPlumbUtil.logEnabled&&typeof console!="undefined"){console.timeEnd(l)}},removeElement:function(l){if(l!=null&&l.parentNode!=null){l.parentNode.removeChild(l)}},removeElements:function(m){for(var l=0;l<m.length;l++){jsPlumbUtil.removeElement(m[l])}},sizeElement:function(o,l,p,m,n){if(o){o.style.height=n+"px";o.height=n;o.style.width=m+"px";o.width=m;o.style.left=l+"px";o.style.top=p+"px"}},wrap:function(n,l,m){n=n||function(){};l=l||function(){};return function(){var o=null;try{o=l.apply(this,arguments)}catch(p){jsPlumbUtil.log("jsPlumb function failed : "+p)}if(m==null||(o!==m)){try{o=n.apply(this,arguments)}catch(p){jsPlumbUtil.log("wrapped function failed : "+p)}}return o}}};jsPlumbUtil.EventGenerator=function(){var m={},n=false;var l=["ready"];this.bind=function(p,q,o){jsPlumbUtil.addToList(m,p,q,true);return this};this.fire=function(t,u,o){if(!n&&m[t]){var q=m[t].length,s=0,p=false,r=null;if(!this.shouldFireEvent||this.shouldFireEvent(t,u,o)){while(!p&&s<q&&r!==false){if(jsPlumbUtil.findWithFunction(l,function(w){return w===t})!=-1){m[t][s](u,o)}else{try{r=m[t][s](u,o)}catch(v){jsPlumbUtil.log("jsPlumb: fire failed for event "+t+" : "+v)}}s++;if(m==null||m[t]==null){p=true}}}}return this};this.unbind=function(o){if(o){delete m[o]}else{m={}}return this};this.getListener=function(o){return m[o]};this.setSuspendEvents=function(o){n=o};this.isSuspendEvents=function(){return n};this.cleanupListeners=function(){for(var o in m){m[o].splice(0);delete m[o]}}};jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}};if(!Function.prototype.bind){Function.prototype.bind=function(l){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var p=Array.prototype.slice.call(arguments,1),o=this,m=function(){},n=function(){return o.apply(this instanceof m&&l?this:l,p.concat(Array.prototype.slice.call(arguments)))};m.prototype=this.prototype;n.prototype=new m();return n}}})();(function(){var b=!!document.createElement("canvas").getContext,a=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),d=function(){if(d.vml===undefined){var f=document.body.appendChild(document.createElement("div"));f.innerHTML='<v:shape id="vml_flag1" adj="1" />';var e=f.firstChild;if(e!=null&&e.style!=null){e.style.behavior="url(#default#VML)";d.vml=e?typeof e.adj=="object":true}else{d.vml=false}f.parentNode.removeChild(f)}return d.vml};var c=function(k){var i={},h=[],f={},e={},g={};this.register=function(n){var m=jsPlumb.CurrentLibrary,q=m.getElementObject(n),p=k.getId(n),l=m.getOffset(q);if(!i[p]){i[p]=n;h.push(n);f[p]={}}var o=function(v,r){if(v){for(var s=0;s<v.childNodes.length;s++){if(v.childNodes[s].nodeType!=3&&v.childNodes[s].nodeType!=8){var u=m.getElementObject(v.childNodes[s]),w=k.getId(v.childNodes[s],null,true);if(w&&e[w]&&e[w]>0){var t=m.getOffset(u);f[p][w]={id:w,offset:{left:t.left-l.left,top:t.top-l.top}};g[w]=p}o(v.childNodes[s])}}}};o(n)};this.updateOffsets=function(q){var t=jsPlumb.CurrentLibrary,n=t.getElementObject(q),p=t.getDOMElement(n),m=k.getId(p),o=f[m],l=t.getOffset(n);if(o){for(var s in o){var u=t.getElementObject(s),r=t.getOffset(u);f[m][s]={id:s,offset:{left:r.left-l.left,top:r.top-l.top}};g[s]=m}}};this.endpointAdded=function(n){var s=jsPlumb.CurrentLibrary,v=document.body,l=k.getId(n),u=s.getElementObject(n),w=jsPlumb.CurrentLibrary.getOffset(u),m=n.parentNode,q=m==v;e[l]=e[l]?e[l]+1:1;while(m!=null&&m!=v){var r=k.getId(m,null,true);if(r&&i[r]){var x=-1,t=s.getElementObject(m),o=s.getOffset(t);if(f[r][l]==null){f[r][l]={id:l,offset:{left:w.left-o.left,top:w.top-o.top}};g[l]=r}break}m=m.parentNode}};this.endpointDeleted=function(m){if(e[m.elementId]){e[m.elementId]--;if(e[m.elementId]<=0){for(var l in f){if(f[l]){delete f[l][m.elementId];delete g[m.elementId]}}}}};this.changeId=function(m,l){f[l]=f[m];f[m]={};g[l]=g[m];g[m]=null};this.getElementsForDraggable=function(l){return f[l]};this.elementRemoved=function(l){var m=g[l];if(m){delete f[m][l];delete g[l]}};this.reset=function(){i={};h=[];f={};e={}}};if(!window.console){window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}}window.jsPlumbAdapter={headless:false,getAttribute:function(e,f){return e.getAttribute(f)},setAttribute:function(g,e,f){g.setAttribute(e,f)},appendToRoot:function(e){document.body.appendChild(e)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(e){return{canvas:b,svg:a,vml:d()}[e]},getDragManager:function(e){return new c(e)},setRenderMode:function(i){var h;if(i){i=i.toLowerCase();var f=this.isRenderModeAvailable("canvas"),e=this.isRenderModeAvailable("svg"),g=this.isRenderModeAvailable("vml");if(i==="svg"){if(e){h="svg"}else{if(f){h="canvas"}else{if(g){h="vml"}}}}else{if(i==="canvas"&&f){h="canvas"}else{if(g){h="vml"}}}}return h}}})();(function(){var f=jsPlumbUtil,u=function(C,B){l.CurrentLibrary.addClass(h(C),B)},i=function(C,B){return l.CurrentLibrary.hasClass(h(C),B)},k=function(C,B){l.CurrentLibrary.removeClass(h(C),B)},h=function(B){return l.CurrentLibrary.getElementObject(B)},A=function(B){return l.CurrentLibrary.getDOMElement(B)},s=function(C,B){var E=l.CurrentLibrary.getOffset(h(C));if(B!=null){var D=B.getZoom();return{left:E.left/D,top:E.top/D}}else{return E}},a=function(B){return l.CurrentLibrary.getSize(h(B))},n=function(){return""+(new Date()).getTime()},y=function(B){if(B._jsPlumb.paintStyle&&B._jsPlumb.hoverPaintStyle){var C={};l.extend(C,B._jsPlumb.paintStyle);l.extend(C,B._jsPlumb.hoverPaintStyle);delete B._jsPlumb.hoverPaintStyle;if(C.gradient&&B._jsPlumb.paintStyle.fillStyle){delete C.gradient}B._jsPlumb.hoverPaintStyle=C}},e=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],r={mouseout:"mouseexit"},z=function(D,H,G,C){var F=D.getAttachedElements();if(F){for(var E=0,B=F.length;E<B;E++){if(!C||C!=F[E]){F[E].setHover(H,true,G)}}}},m=function(B){return B==null?null:B.split(" ")},o=function(C,G,E){if(C.getDefaultType){var H=C.getTypeDescriptor();var F=f.merge({},C.getDefaultType());for(var D=0,B=C._jsPlumb.types.length;D<B;D++){F=f.merge(F,C._jsPlumb.instance.getType(C._jsPlumb.types[D],H))}if(G){F=f.populate(F,G)}C.applyType(F,E);if(!E){C.repaint()}}},v=window.jsPlumbUIComponent=function(G){jsPlumbUtil.EventGenerator.apply(this,arguments);var M=this,L=arguments,C=M.idPrefix,F=C+(new Date()).getTime(),J=l.CurrentLibrary;this._jsPlumb={instance:G._jsPlumb,parameters:G.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:false,beforeDetach:G.beforeDetach,beforeDrop:G.beforeDrop,overlayPlacements:[],hoverClass:G.hoverClass||G._jsPlumb.Defaults.HoverClass||l.Defaults.HoverClass,types:[]};this.getId=function(){return F};if(G.events){for(var I in G.events){M.bind(I,G.events[I])}}this.clone=function(){var N={};this.constructor.apply(N,L);return N}.bind(this);this.isDetachAllowed=function(N){var O=true;if(this._jsPlumb.beforeDetach){try{O=this._jsPlumb.beforeDetach(N)}catch(P){f.log("jsPlumb: beforeDetach callback failed",P)}}return O};this.isDropAllowed=function(S,P,Q,N,O){var R=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:S,targetId:P,scope:Q,connection:N,dropEndpoint:O});if(this._jsPlumb.beforeDrop){try{R=this._jsPlumb.beforeDrop({sourceId:S,targetId:P,scope:Q,connection:N,dropEndpoint:O})}catch(T){f.log("jsPlumb: beforeDrop callback failed",T)}}return R};var H=[],K=function(P,O,N){H.push([P,O,N]);P.bind(O,N)},D=[],E=function(Q,R,O){var N=r[O]||O,P=function(S){R.fire(N,R,S)};D.push([Q,O,P]);J.bind(Q,O,P)},B=function(Q,O,P){var N=r[O]||O;J.unbind(Q,O,P)};this.bindListeners=function(P,N,O){K(P,"click",function(Q,R){N.fire("click",N,R)});K(P,"dblclick",function(Q,R){N.fire("dblclick",N,R)});K(P,"contextmenu",function(Q,R){N.fire("contextmenu",N,R)});K(P,"mouseenter",function(Q,R){if(!N.isHover()){O(true);N.fire("mouseenter",N,R)}});K(P,"mouseexit",function(Q,R){if(N.isHover()){O(false);N.fire("mouseexit",N,R)}});K(P,"mousedown",function(Q,R){N.fire("mousedown",N,R)});K(P,"mouseup",function(Q,R){N.fire("mouseup",N,R)})};this.unbindListeners=function(){for(var N=0;N<H.length;N++){var O=H[N];O[0].unbind(O[1],O[2])}H=null};this.attachListeners=function(P,Q){for(var O=0,N=e.length;O<N;O++){E(P,Q,e[O])}};this.detachListeners=function(){for(var N=0;N<D.length;N++){B(D[N][0],D[N][1],D[N][2])}D=null};this.reattachListenersForElement=function(P){if(arguments.length>1){for(var O=0,N=e.length;O<N;O++){B(P,e[O])}for(O=1,N=arguments.length;O<N;O++){this.attachListeners(P,arguments[O])}}}};jsPlumbUtil.extend(v,jsPlumbUtil.EventGenerator,{getParameter:function(B){return this._jsPlumb.parameters[B]},setParameter:function(B,C){this._jsPlumb.parameters[B]=C},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(B){this._jsPlumb.parameters=B},addClass:function(B){if(this.canvas!=null){u(this.canvas,B)}},removeClass:function(B){if(this.canvas!=null){k(this.canvas,B)}},setType:function(B,D,C){this._jsPlumb.types=m(B)||[];o(this,D,C)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(C,B){o(this,C,B)},hasType:function(B){return jsPlumbUtil.indexOf(this._jsPlumb.types,B)!=-1},addType:function(E,H,F){var D=m(E),G=false;if(D!=null){for(var C=0,B=D.length;C<B;C++){if(!this.hasType(D[C])){this._jsPlumb.types.push(D[C]);G=true}}if(G){o(this,H,F)}}},removeType:function(F,G){var D=m(F),H=false,E=function(J){var I=f.indexOf(this._jsPlumb.types,J);if(I!=-1){this._jsPlumb.types.splice(I,1);return true}return false}.bind(this);if(D!=null){for(var C=0,B=D.length;C<B;C++){H=E(D[C])||H}if(H){o(this,null,G)}}},toggleType:function(F,H,G){var E=m(F);if(E!=null){for(var D=0,C=E.length;D<C;D++){var B=jsPlumbUtil.indexOf(this._jsPlumb.types,E[D]);if(B!=-1){this._jsPlumb.types.splice(B,1)}else{this._jsPlumb.types.push(E[D])}}o(this,H,G)}},applyType:function(C,D){this.setPaintStyle(C.paintStyle,D);this.setHoverPaintStyle(C.hoverPaintStyle,D);if(C.parameters){for(var B in C.parameters){this.setParameter(B,C.parameters[B])}}},setPaintStyle:function(B,C){this._jsPlumb.paintStyle=B;this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle;y(this);if(!C){this.repaint()}},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(B,C){this._jsPlumb.hoverPaintStyle=B;y(this);if(!C){this.repaint()}},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},cleanup:function(){this.unbindListeners();this.detachListeners()},destroy:function(){this.cleanupListeners();this.clone=null;this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(C,E,D){var B=l.CurrentLibrary;if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){this._jsPlumb.hover=C;if(this.canvas!=null){if(this._jsPlumb.instance.hoverClass!=null){B[C?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.hoverClass)}}if(this._jsPlumb.hoverPaintStyle!=null){this._jsPlumb.paintStyleInUse=C?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle;if(!this._jsPlumb.instance.isSuspendDrawing()){D=D||n();this.repaint({timestamp:D,recalc:false})}}if(this.getAttachedElements&&!E){z(this,C,n(),this)}}}});var x="__label",w=function(D,F){var B=-1;for(var E=0,C=D._jsPlumb.overlays.length;E<C;E++){if(F===D._jsPlumb.overlays[E].id){B=E;break}}return B},q=function(C,E){var B={cssClass:E.cssClass,labelStyle:C.labelStyle,id:x,component:C,_jsPlumb:C._jsPlumb.instance},D=l.extend(B,E);return new l.Overlays[C._jsPlumb.instance.getRenderMode()].Label(D)},d=function(B,F){var D=null;if(f.isArray(F)){var C=F[0],E=l.extend({component:B,_jsPlumb:B._jsPlumb.instance},F[1]);if(F.length==3){l.extend(E,F[2])}D=new l.Overlays[B._jsPlumb.instance.getRenderMode()][C](E)}else{if(F.constructor==String){D=new l.Overlays[B._jsPlumb.instance.getRenderMode()][F]({component:B,_jsPlumb:B._jsPlumb.instance})}else{D=F}}B._jsPlumb.overlays.push(D)},c=function(E,H){var B=E.defaultOverlayKeys||[],G=H.overlays,C=function(I){return E._jsPlumb.instance.Defaults[I]||l.Defaults[I]||[]};if(!G){G=[]}for(var F=0,D=B.length;F<D;F++){G.unshift.apply(G,C(B[F]))}return G},p=window.OverlayCapableJsPlumbUIComponent=function(G){v.apply(this,arguments);this._jsPlumb.overlays=[];var E=c(this,G);if(E){for(var D=0,C=E.length;D<C;D++){d(this,E[D])}}if(G.label){var F=G.labelLocation||this.defaultLabelLocation||0.5,B=G.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle||l.Defaults.LabelStyle;this._jsPlumb.overlays.push(q(this,{label:G.label,location:F,labelStyle:B}))}};jsPlumbUtil.extend(p,v,{applyType:function(D,E){this.removeAllOverlays();if(D.overlays){for(var C=0,B=D.overlays.length;C<B;C++){this.addOverlay(D.overlays[C],true)}}},setHover:function(D,F,E){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){for(var C=0,B=this._jsPlumb.overlays.length;C<B;C++){this._jsPlumb.overlays[C][D?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)}}},addOverlay:function(B,C){d(this,B);if(!C){this.repaint()}},getOverlay:function(C){var B=w(this,C);return B>=0?this._jsPlumb.overlays[B]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(C){var B=this.getOverlay(C);if(B){B.hide()}},hideOverlays:function(){for(var C=0,B=this._jsPlumb.overlays.length;C<B;C++){this._jsPlumb.overlays[C].hide()}},showOverlay:function(C){var B=this.getOverlay(C);if(B){B.show()}},showOverlays:function(){for(var C=0,B=this._jsPlumb.overlays.length;C<B;C++){this._jsPlumb.overlays[C].show()}},removeAllOverlays:function(){for(var C=0,B=this._jsPlumb.overlays.length;C<B;C++){if(this._jsPlumb.overlays[C].cleanup){this._jsPlumb.overlays[C].cleanup()}}this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length);this.repaint()},removeOverlay:function(C){var B=w(this,C);if(B!=-1){var D=this._jsPlumb.overlays[B];if(D.cleanup){D.cleanup()}this._jsPlumb.overlays.splice(B,1)}},removeOverlays:function(){for(var C=0,B=arguments.length;C<B;C++){this.removeOverlay(arguments[C])}},getLabel:function(){var B=this.getOverlay(x);return B!=null?B.getLabel():null},getLabelOverlay:function(){return this.getOverlay(x)},setLabel:function(B){var C=this.getOverlay(x);if(!C){var D=B.constructor==String||B.constructor==Function?{label:B}:B;C=q(this,D);this._jsPlumb.overlays.push(C)}else{if(B.constructor==String||B.constructor==Function){C.setLabel(B)}else{if(B.label){C.setLabel(B.label)}if(B.location){C.setLocation(B.location)}}}if(!this._jsPlumb.instance.isSuspendDrawing()){this.repaint()}},cleanup:function(){for(var B=0;B<this._jsPlumb.overlays.length;B++){this._jsPlumb.overlays[B].cleanup();this._jsPlumb.overlays[B].destroy()}this._jsPlumb.overlays.splice(0)}});var g=0,b=function(){var B=g+1;g++;return B};var t=window.jsPlumbInstance=function(C){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:true,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:false,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:false,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:false,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"};if(C){l.extend(this.Defaults,C)}this.logEnabled=this.Defaults.LogEnabled;this._connectionTypes={};this._endpointTypes={};jsPlumbUtil.EventGenerator.apply(this);var aW=this,ar=b(),av=aW.bind,aj={},R=1,V=function(a2){var a3=A(a2);return{el:a3,id:(jsPlumbUtil.isString(a2)&&a3==null)?a2:B(a3)}};this.getInstanceIndex=function(){return ar};this.setZoom=function(a3,a2){R=a3;if(a2){aW.repaintEverything()}};this.getZoom=function(){return R};for(var ai in this.Defaults){aj[ai]=this.Defaults[ai]}this.bind=function(a3,a2){if("ready"===a3&&E){a2()}else{av.apply(aW,[a3,a2])}};aW.importDefaults=function(a3){for(var a2 in a3){aW.Defaults[a2]=a3[a2]}return aW};aW.restoreDefaults=function(){aW.Defaults=l.extend({},aj);return aW};var H=null,aQ=null,E=false,L=[],ay={},aA={},X={},aY={},aR={},aV={},ab=false,U=[],aH=false,aK=null,K=this.Defaults.Scope,P=null,ak=1,Z=function(){return""+ak++},aB=function(a3,a2){if(aW.Defaults.Container){l.CurrentLibrary.appendElement(a3,aW.Defaults.Container)}else{if(!a2){jsPlumbAdapter.appendToRoot(a3)}else{l.CurrentLibrary.appendElement(a3,a2)}}},ap=function(a2){return a2._nodes?a2._nodes:a2},aL=function(a6,a9,a8,a4){if(!jsPlumbAdapter.headless&&!aH){var a2=B(a6),ba=aW.dragManager.getElementsForDraggable(a2);if(a8==null){a8=n()}var a3=O({elId:a2,offset:a9,recalc:false,timestamp:a8});if(ba){for(var a7 in ba){O({elId:ba[a7].id,offset:{left:a3.o.left+ba[a7].offset.left,top:a3.o.top+ba[a7].offset.top},recalc:false,timestamp:a8})}}aW.anchorManager.redraw(a2,a9,a8,null,a4);if(ba){for(var a5 in ba){aW.anchorManager.redraw(ba[a5].id,a9,a8,ba[a5].offset,a4,true)}}}},an=function(a4,a6){var a7=null,a5,a8;if(f.isArray(a4)){a7=[];for(var a3=0,a2=a4.length;a3<a2;a3++){a5=h(a4[a3]);a8=aW.getAttribute(a5,"id");a7.push(a6(a5,a8))}}else{a5=h(a4);a8=aW.getAttribute(a5,"id");a7=a6(a5,a8)}return a7},ad=function(a2){return aA[a2]},aN=function(a7,a2,ba){if(!jsPlumbAdapter.headless){var a3=a2==null?false:a2,a8=l.CurrentLibrary;if(a3){if(a8.isDragSupported(a7)&&!a8.isAlreadyDraggable(a7)){var bc=ba||aW.Defaults.DragOptions||l.Defaults.DragOptions;bc=l.extend({},bc);var a9=a8.dragEvents.drag,a4=a8.dragEvents.stop,a6=a8.dragEvents.start;bc[a6]=f.wrap(bc[a6],function(){aW.setHoverSuspended(true);aW.select({source:a7}).addClass(aW.elementDraggingClass+" "+aW.sourceElementDraggingClass,true);aW.select({target:a7}).addClass(aW.elementDraggingClass+" "+aW.targetElementDraggingClass,true);aW.setConnectionBeingDragged(true)});bc[a9]=f.wrap(bc[a9],function(){var bd=a8.getUIPosition(arguments,aW.getZoom());aL(a7,bd,null,true);u(a7,"jsPlumb_dragged")});bc[a4]=f.wrap(bc[a4],function(){var bd=a8.getUIPosition(arguments,aW.getZoom());aL(a7,bd);k(a7,"jsPlumb_dragged");aW.setHoverSuspended(false);aW.select({source:a7}).removeClass(aW.elementDraggingClass+" "+aW.sourceElementDraggingClass,true);aW.select({target:a7}).removeClass(aW.elementDraggingClass+" "+aW.targetElementDraggingClass,true);aW.setConnectionBeingDragged(false)});var a5=B(a7);aV[a5]=true;var bb=aV[a5];bc.disabled=bb==null?false:!bb;a8.initDraggable(a7,bc,false,aW);aW.dragManager.register(a7)}}}},ah=function(a5,a9){var a2=l.extend({},a5);if(a9){l.extend(a2,a9)}if(a2.source){if(a2.source.endpoint){a2.sourceEndpoint=a2.source}else{a2.source=A(a2.source)}}if(a2.target){if(a2.target.endpoint){a2.targetEndpoint=a2.target}else{a2.target=A(a2.target)}}if(a5.uuids){a2.sourceEndpoint=ad(a5.uuids[0]);a2.targetEndpoint=ad(a5.uuids[1])}if(a2.sourceEndpoint&&a2.sourceEndpoint.isFull()){f.log(aW,"could not add connection; source endpoint is full");return}if(a2.targetEndpoint&&a2.targetEndpoint.isFull()){f.log(aW,"could not add connection; target endpoint is full");return}if(!a2.type&&a2.sourceEndpoint){a2.type=a2.sourceEndpoint.connectionType}if(a2.sourceEndpoint&&a2.sourceEndpoint.connectorOverlays){a2.overlays=a2.overlays||[];for(var a8=0,a7=a2.sourceEndpoint.connectorOverlays.length;a8<a7;a8++){a2.overlays.push(a2.sourceEndpoint.connectorOverlays[a8])}}if(!a2["pointer-events"]&&a2.sourceEndpoint&&a2.sourceEndpoint.connectorPointerEvents){a2["pointer-events"]=a2.sourceEndpoint.connectorPointerEvents}var a6,a3,a4,ba;if(a2.target&&!a2.target.endpoint&&!a2.targetEndpoint&&!a2.newConnection){a6=B(a2.target);a3=aE[a6];a4=ao[a6];if(a3){if(!Y[a6]){return}ba=a4!=null?a4:aW.addEndpoint(a2.target,a3);if(aS[a6]){ao[a6]=ba}a2.targetEndpoint=ba;ba._doNotDeleteOnDetach=false;ba._deleteOnDetach=true}}if(a2.source&&!a2.source.endpoint&&!a2.sourceEndpoint&&!a2.newConnection){a6=B(a2.source);a3=ag[a6];a4=aG[a6];if(a3){if(!S[a6]){return}ba=a4!=null?a4:aW.addEndpoint(a2.source,a3);if(aJ[a6]){aG[a6]=ba}a2.sourceEndpoint=ba;ba._doNotDeleteOnDetach=false;ba._deleteOnDetach=true}}return a2},T=function(a6){var a5=aW.Defaults.ConnectionType||aW.getDefaultConnectionType(),a4=aW.Defaults.EndpointType||l.Endpoint,a3=l.CurrentLibrary.getParent;if(a6.container){a6.parent=a6.container}else{if(a6.sourceEndpoint){a6.parent=a6.sourceEndpoint.parent}else{if(a6.source.constructor==a4){a6.parent=a6.source.parent}else{a6.parent=a3(a6.source)}}}a6._jsPlumb=aW;a6.newConnection=T;a6.newEndpoint=al;a6.endpointsByUUID=aA;a6.endpointsByElement=ay;a6.finaliseConnection=a1;var a2=new a5(a6);a2.id="con_"+Z();a0("click","click",a2);a0("dblclick","dblclick",a2);a0("contextmenu","contextmenu",a2);return a2},a1=function(a5,a6,a2,a4){a6=a6||{};if(!a5.suspendedEndpoint){L.push(a5)}if(a5.suspendedEndpoint==null||a4){aW.anchorManager.newConnection(a5)}aL(a5.source);if(!a6.doNotFireConnectionEvent&&a6.fireEvent!==false){var a3={connection:a5,source:a5.source,target:a5.target,sourceId:a5.sourceId,targetId:a5.targetId,sourceEndpoint:a5.endpoints[0],targetEndpoint:a5.endpoints[1]};aW.fire("connection",a3,a2)}},a0=function(a2,a3,a4){a4.bind(a2,function(a6,a5){aW.fire(a3,a4,a5)})},ae=function(a4){if(a4.container){return a4.container}else{var a2=l.CurrentLibrary.getTagName(a4.source),a3=l.CurrentLibrary.getParent(a4.source);if(a2&&a2.toLowerCase()==="td"){return l.CurrentLibrary.getParent(a3)}else{return a3}}},al=function(a5){var a4=aW.Defaults.EndpointType||l.Endpoint;var a2=l.extend({},a5);a2.parent=ae(a2);a2._jsPlumb=aW;a2.newConnection=T;a2.newEndpoint=al;a2.endpointsByUUID=aA;a2.endpointsByElement=ay;a2.finaliseConnection=a1;a2.fireDetachEvent=aI;a2.floatingConnections=aR;a2.getParentFromParams=ae;a2.elementId=B(a2.source);var a3=new a4(a2);a3.id="ep_"+Z();a0("click","endpointClick",a3);a0("dblclick","endpointDblClick",a3);a0("contextmenu","contextmenu",a3);if(!jsPlumbAdapter.headless){aW.dragManager.endpointAdded(a2.source)}return a3},N=function(a5,a4,a7){var a3=ay[a5];if(a3&&a3.length){for(var a8=0,ba=a3.length;a8<ba;a8++){for(var a6=0,a9=a3[a8].connections.length;a6<a9;a6++){var a2=a4(a3[a8].connections[a6]);if(a2){return}}if(a7){a7(a3[a8])}}}},aU=function(a3,a2){return an(a3,function(a4,a5){aV[a5]=a2;if(l.CurrentLibrary.isDragSupported(a4)){l.CurrentLibrary.setDraggable(a4,a2)}})},aF=function(a4,a5,a2){a5=a5==="block";var a3=null;if(a2){if(a5){a3=function(a7){a7.setVisible(true,true,true)}}else{a3=function(a7){a7.setVisible(false,true,true)}}}var a6=V(a4);N(a6.id,function(a8){if(a5&&a2){var a7=a8.sourceId===a6.id?1:0;if(a8.endpoints[a7].isVisible()){a8.setVisible(true)}}else{a8.setVisible(a5)}},a3)},aT=function(a2){return an(a2,function(a4,a3){var a5=aV[a3]==null?false:aV[a3];a5=!a5;aV[a3]=a5;l.CurrentLibrary.setDraggable(a4,a5);return a5})},aw=function(a2,a4){var a3=null;if(a4){a3=function(a5){var a6=a5.isVisible();a5.setVisible(!a6)}}N(a2,function(a6){var a5=a6.isVisible();a6.setVisible(!a5)},a3)},O=function(a7){var a5=a7.timestamp,a2=a7.recalc,a6=a7.offset,a3=a7.elId,a4;if(aH&&!a5){a5=aK}if(!a2){if(a5&&a5===aY[a3]){return{o:a7.offset||X[a3],s:U[a3]}}}if(a2||!a6){a4=h(a3);if(a4!=null){U[a3]=a(a4);X[a3]=s(a4,aW);aY[a3]=a5}}else{X[a3]=a6;if(U[a3]==null){a4=h(a3);if(a4!=null){U[a3]=a(a4)}}aY[a3]=a5}if(X[a3]&&!X[a3].right){X[a3].right=X[a3].left+U[a3][0];X[a3].bottom=X[a3].top+U[a3][1];X[a3].width=U[a3][0];X[a3].height=U[a3][1];X[a3].centerx=X[a3].left+(X[a3].width/2);X[a3].centery=X[a3].top+(X[a3].height/2)}return{o:X[a3],s:U[a3]}},au=function(a2){var a3=X[a2];if(!a3){return O({elId:a2})}else{return{o:a3,s:U[a2]}}},B=function(a2,a3,a4){if(jsPlumbUtil.isString(a2)){return a2}if(a2==null){return null}var a5=jsPlumbAdapter.getAttribute(a2,"id");if(!a5||a5==="undefined"){if(arguments.length==2&&arguments[1]!==undefined){a5=a3}else{if(arguments.length==1||(arguments.length==3&&!arguments[2])){a5="jsPlumb_"+ar+"_"+Z()}}if(!a4){jsPlumbAdapter.setAttribute(a2,"id",a5)}}return a5};this.setConnectionBeingDragged=function(a2){ab=a2};this.isConnectionBeingDragged=function(){return ab};this.connectorClass="_jsPlumb_connector";this.hoverClass="_jsPlumb_hover";this.endpointClass="_jsPlumb_endpoint";this.endpointConnectedClass="_jsPlumb_endpoint_connected";this.endpointFullClass="_jsPlumb_endpoint_full";this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed";this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden";this.overlayClass="_jsPlumb_overlay";this.draggingClass="_jsPlumb_dragging";this.elementDraggingClass="_jsPlumb_element_dragging";this.sourceElementDraggingClass="_jsPlumb_source_element_dragging";this.targetElementDraggingClass="_jsPlumb_target_element_dragging";this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor";this.hoverSourceClass="_jsPlumb_source_hover";this.hoverTargetClass="_jsPlumb_target_hover";this.dragSelectClass="_jsPlumb_drag_select";this.Anchors={};this.Connectors={canvas:{},svg:{},vml:{}};this.Endpoints={canvas:{},svg:{},vml:{}};this.Overlays={canvas:{},svg:{},vml:{}};this.ConnectorRenderers={};this.SVG="svg";this.CANVAS="canvas";this.VML="vml";this.addEndpoint=function(a5,a6,bg){bg=bg||{};var a4=l.extend({},bg);l.extend(a4,a6);a4.endpoint=a4.endpoint||aW.Defaults.Endpoint||l.Defaults.Endpoint;a4.paintStyle=a4.paintStyle||aW.Defaults.EndpointStyle||l.Defaults.EndpointStyle;a5=ap(a5);var a8=[],bb=(f.isArray(a5)||(a5.length!=null&&!f.isString(a5)))?a5:[a5];for(var a9=0,a7=bb.length;a9<a7;a9++){var be=A(bb[a9]),a3=B(be);a4.source=be;O({elId:a3,timestamp:aK});var bd=al(a4);if(a4.parentAnchor){bd.parentAnchor=a4.parentAnchor}f.addToList(ay,a3,bd);var bc=X[a3],ba=U[a3],bf=bd.anchor.compute({xy:[bc.left,bc.top],wh:ba,element:bd,timestamp:aK}),a2={anchorLoc:bf,timestamp:aK};if(aH){a2.recalc=false}if(!aH){bd.paint(a2)}a8.push(bd);bd._doNotDeleteOnDetach=true}return a8.length==1?a8[0]:a8};this.addEndpoints=function(a7,a3,a2){var a6=[];for(var a5=0,a4=a3.length;a5<a4;a5++){var a8=aW.addEndpoint(a7,a3[a5],a2);if(f.isArray(a8)){Array.prototype.push.apply(a6,a8)}else{a6.push(a8)}}return a6};this.animate=function(a4,a3,a2){a2=a2||{};var a5=h(a4),a8=B(a4),a7=l.CurrentLibrary.dragEvents.step,a6=l.CurrentLibrary.dragEvents.complete;a2[a7]=f.wrap(a2[a7],function(){aW.repaint(a8)});a2[a6]=f.wrap(a2[a6],function(){aW.repaint(a8)});l.CurrentLibrary.animate(a5,a3,a2)};this.checkCondition=function(a5,a7){var a2=aW.getListener(a5),a6=true;if(a2&&a2.length>0){try{for(var a4=0,a3=a2.length;a4<a3;a4++){a6=a6&&a2[a4](a7)}}catch(a8){f.log(aW,"cannot check condition ["+a5+"]"+a8)}}return a6};this.checkASyncCondition=function(a4,a6,a5,a3){var a2=aW.getListener(a4);if(a2&&a2.length>0){try{a2[0](a6,a5,a3)}catch(a7){f.log(aW,"cannot asynchronously check condition ["+a4+"]"+a7)}}};this.connect=function(a5,a3){var a2=ah(a5,a3),a4;if(a2){a4=T(a2);a1(a4,a2)}return a4};this.deleteEndpoint=function(a4,a3){var a2=aW.setSuspendDrawing(true);var a5=(typeof a4=="string")?aA[a4]:a4;if(a5){aW.deleteObject({endpoint:a5})}if(!a2){aW.setSuspendDrawing(false,a3)}return aW};this.deleteEveryEndpoint=function(){var a2=aW.setSuspendDrawing(true);for(var a6 in ay){var a3=ay[a6];if(a3&&a3.length){for(var a5=0,a4=a3.length;a5<a4;a5++){aW.deleteEndpoint(a3[a5],true)}}}ay={};aA={};aW.anchorManager.reset();aW.dragManager.reset();if(!a2){aW.setSuspendDrawing(false)}return aW};var aI=function(a5,a7,a2){var a4=aW.Defaults.ConnectionType||aW.getDefaultConnectionType(),a3=a5.constructor==a4,a6=a3?{connection:a5,source:a5.source,target:a5.target,sourceId:a5.sourceId,targetId:a5.targetId,sourceEndpoint:a5.endpoints[0],targetEndpoint:a5.endpoints[1]}:a5;if(a7){aW.fire("connectionDetached",a6,a2)}aW.anchorManager.connectionDetached(a6)};this.unregisterEndpoint=function(a7){if(a7._jsPlumb.uuid){aA[a7._jsPlumb.uuid]=null}aW.anchorManager.deleteEndpoint(a7);for(var a6 in ay){var a2=ay[a6];if(a2){var a5=[];for(var a4=0,a3=a2.length;a4<a3;a4++){if(a2[a4]!=a7){a5.push(a2[a4])}}ay[a6]=a5}if(ay[a6].length<1){delete ay[a6]}}};this.detach=function(){if(arguments.length===0){return}var a6=aW.Defaults.ConnectionType||aW.getDefaultConnectionType(),a7=arguments[0].constructor==a6,a5=arguments.length==2?a7?(arguments[1]||{}):arguments[0]:arguments[0],ba=(a5.fireEvent!==false),a3=a5.forceDetach,a4=a7?arguments[0]:a5.connection;if(a4){if(a3||jsPlumbUtil.functionChain(true,false,[[a4.endpoints[0],"isDetachAllowed",[a4]],[a4.endpoints[1],"isDetachAllowed",[a4]],[a4,"isDetachAllowed",[a4]],[aW,"checkCondition",["beforeDetach",a4]]])){a4.endpoints[0].detach(a4,false,true,ba)}}else{var a2=l.extend({},a5);if(a2.uuids){ad(a2.uuids[0]).detachFrom(ad(a2.uuids[1]),ba)}else{if(a2.sourceEndpoint&&a2.targetEndpoint){a2.sourceEndpoint.detachFrom(a2.targetEndpoint)}else{var a9=B(A(a2.source)),a8=B(A(a2.target));N(a9,function(bb){if((bb.sourceId==a9&&bb.targetId==a8)||(bb.targetId==a9&&bb.sourceId==a8)){if(aW.checkCondition("beforeDetach",bb)){bb.endpoints[0].detach(bb,false,true,ba)}}})}}}};this.detachAllConnections=function(a5,a6){a6=a6||{};a5=A(a5);var a7=B(a5),a2=ay[a7];if(a2&&a2.length){for(var a4=0,a3=a2.length;a4<a3;a4++){a2[a4].detachAll(a6.fireEvent!==false)}}return aW};this.detachEveryConnection=function(a2){a2=a2||{};aW.doWhileSuspended(function(){for(var a6 in ay){var a3=ay[a6];if(a3&&a3.length){for(var a5=0,a4=a3.length;a5<a4;a5++){a3[a5].detachAll(a2.fireEvent!==false)}}}L.splice(0)});return aW};this.deleteObject=function(a2){var bb={endpoints:{},connections:{},endpointCount:0,connectionCount:0},ba=a2.fireEvent!==false,a9=a2.deleteAttachedObjects!==false;var a7=function(bc){if(bc!=null&&bb.connections[bc.id]==null){bc._jsPlumb&&bc.setHover(false);bb.connections[bc.id]=bc;bb.connectionCount++;if(a9){for(var bd=0;bd<bc.endpoints.length;bd++){if(bc.endpoints[bd]._deleteOnDetach){a5(bc.endpoints[bd])}}}}};var a5=function(bd){if(bd!=null&&bb.endpoints[bd.id]==null){bd._jsPlumb&&bd.setHover(false);bb.endpoints[bd.id]=bd;bb.endpointCount++;if(a9){for(var bc=0;bc<bd.connections.length;bc++){var be=bd.connections[bc];a7(be)}}}};if(a2.connection){a7(a2.connection)}else{a5(a2.endpoint)}for(var a4 in bb.connections){var a8=bb.connections[a4];if(a8.endpoints==null){continue}a8.endpoints[0].detachFromConnection(a8);a8.endpoints[1].detachFromConnection(a8);jsPlumbUtil.removeWithFunction(L,function(bc){return a8.id==bc.id});aI(a8,ba,a2.originalEvent);a8.cleanup();a8.destroy()}for(var a3 in bb.endpoints){var a6=bb.endpoints[a3];aW.unregisterEndpoint(a6);a6.cleanup();a6.destroy()}return bb};this.draggable=function(a5,a3){var a4,a2,a6;if(typeof a5=="object"&&a5.length){for(a4=0,a2=a5.length;a4<a2;a4++){a6=A(a5[a4]);if(a6){aN(a6,true,a3)}}}else{if(a5._nodes){for(a4=0,a2=a5._nodes.length;a4<a2;a4++){a6=A(a5._nodes[a4]);if(a6){aN(a6,true,a3)}}}else{a6=A(a5);if(a6){aN(a6,true,a3)}}}return aW};this.extend=function(a3,a2){return l.CurrentLibrary.extend(a3,a2)};var aX=function(a7,a6,a4,a2){for(var a5=0,a3=a7.length;a5<a3;a5++){a7[a5][a6].apply(a7[a5],a4)}return a2(a7)},M=function(a7,a6,a4){var a3=[];for(var a5=0,a2=a7.length;a5<a2;a5++){a3.push([a7[a5][a6].apply(a7[a5],a4),a7[a5]])}return a3},aa=function(a4,a3,a2){return function(){return aX(a4,a3,arguments,a2)}},af=function(a3,a2){return function(){return M(a3,a2,arguments)}},aZ=function(a2,a6){var a5=[];if(a2){if(typeof a2=="string"){if(a2==="*"){return a2}a5.push(a2)}else{a2=h(a2);if(a6){a5=a2}else{for(var a4=0,a3=a2.length;a4<a3;a4++){a5.push(V(a2[a4]).id)}}}}return a5},am=function(a4,a3,a2){if(a4==="*"){return true}return a4.length>0?jsPlumbUtil.indexOf(a4,a3)!=-1:!a2};this.getConnections=function(bb,a3){if(!bb){bb={}}else{if(bb.constructor==String){bb={scope:bb}}}var ba=bb.scope||aW.getDefaultScope(),a9=aZ(ba,true),a2=aZ(bb.source),a7=aZ(bb.target),a5=(!a3&&a9.length>1)?{}:[],bc=function(be,bf){if(!a3&&a9.length>1){var bd=a5[be];if(bd==null){bd=a5[be]=[]}bd.push(bf)}else{a5.push(bf)}};for(var a4=0,a6=L.length;a4<a6;a4++){var a8=L[a4];if(am(a9,a8.scope)&&am(a2,a8.sourceId)&&am(a7,a8.targetId)){bc(a8.scope,a8)}}return a5};var F=function(a2,a3){return function(a6){for(var a4=0,a5=a2.length;a4<a5;a4++){a6(a2[a4])}return a3(a2)}},I=function(a2){return function(a3){return a2[a3]}};var J=function(a7,a8){var a2={length:a7.length,each:F(a7,a8),get:I(a7)},a6=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],a5=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"],a3,a4;for(a3=0,a4=a6.length;a3<a4;a3++){a2[a6[a3]]=aa(a7,a6[a3],a8)}for(a3=0,a4=a5.length;a3<a4;a3++){a2[a5[a3]]=af(a7,a5[a3])}return a2};var aq=function(a3){var a2=J(a3,aq);return l.CurrentLibrary.extend(a2,{setDetachable:aa(a3,"setDetachable",aq),setReattach:aa(a3,"setReattach",aq),setConnector:aa(a3,"setConnector",aq),detach:function(){for(var a4=0,a5=a3.length;a4<a5;a4++){aW.detach(a3[a4])}},isDetachable:af(a3,"isDetachable"),isReattach:af(a3,"isReattach")})};var aM=function(a3){var a2=J(a3,aM);return l.CurrentLibrary.extend(a2,{setEnabled:aa(a3,"setEnabled",aM),setAnchor:aa(a3,"setAnchor",aM),isEnabled:af(a3,"isEnabled"),detachAll:function(){for(var a4=0,a5=a3.length;a4<a5;a4++){a3[a4].detachAll()}},remove:function(){for(var a4=0,a5=a3.length;a4<a5;a4++){aW.deleteObject({endpoint:a3[a4]})}}})};this.select=function(a2){a2=a2||{};a2.scope=a2.scope||"*";return aq(a2.connections||aW.getConnections(a2,true))};this.selectEndpoints=function(bd){bd=bd||{};bd.scope=bd.scope||"*";var a5=!bd.element&&!bd.source&&!bd.target,a8=a5?"*":aZ(bd.element),a2=a5?"*":aZ(bd.source),bh=a5?"*":aZ(bd.target),ba=aZ(bd.scope,true);var bj=[];for(var a3 in ay){var be=am(a8,a3,true),bb=am(a2,a3,true),bg=a2!="*",bi=am(bh,a3,true),a7=bh!="*";if(be||bb||bi){inner:for(var bc=0,a6=ay[a3].length;bc<a6;bc++){var a9=ay[a3][bc];if(am(ba,a9.scope,true)){var bf=(bg&&a2.length>0&&!a9.isSource),a4=(a7&&bh.length>0&&!a9.isTarget);if(bf||a4){continue inner}bj.push(a9)}}}}return aM(bj)};this.getAllConnections=function(){return L};this.getDefaultScope=function(){return K};this.getEndpoint=ad;this.getEndpoints=function(a2){return ay[V(a2).id]};this.getDefaultEndpointType=function(){return l.Endpoint};this.getDefaultConnectionType=function(){return l.Connection};this.getId=B;this.getOffset=function(a3){var a2=X[a3];return O({elId:a3})};this.getSelector=function(){return l.CurrentLibrary.getSelector.apply(null,arguments)};this.getSize=function(a3){var a2=U[a3];if(!a2){O({elId:a3})}return U[a3]};this.appendElement=aB;var ax=false;this.isHoverSuspended=function(){return ax};this.setHoverSuspended=function(a2){ax=a2};var aC=function(a2){return function(){return jsPlumbAdapter.isRenderModeAvailable(a2)}};this.isCanvasAvailable=aC("canvas");this.isSVGAvailable=aC("svg");this.isVMLAvailable=aC("vml");this.hide=function(a2,a3){aF(a2,"none",a3);return aW};this.idstamp=Z;this.connectorsInitialized=false;var aO=[],aD=["canvas","svg","vml"];this.registerConnectorType=function(a2,a3){aO.push([a2,a3])};this.init=function(){var a4=function(a7,a5,a6){l.Connectors[a7][a5]=function(){a6.apply(this,arguments);l.ConnectorRenderers[a7].apply(this,arguments)};jsPlumbUtil.extend(l.Connectors[a7][a5],[a6,l.ConnectorRenderers[a7]])};if(!l.connectorsInitialized){for(var a3=0;a3<aO.length;a3++){for(var a2=0;a2<aD.length;a2++){a4(aD[a2],aO[a3][1],aO[a3][0])}}l.connectorsInitialized=true}if(!E){aW.anchorManager=new l.AnchorManager({jsPlumbInstance:aW});aW.setRenderMode(aW.Defaults.RenderMode);E=true;aW.fire("ready",aW)}}.bind(this);this.log=H;this.jsPlumbUIComponent=v;this.makeAnchor=function(){var a6=function(a9,ba){if(l.Anchors[a9]){return new l.Anchors[a9](ba)}if(!aW.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown anchor type '"+a9+"'"}}};if(arguments.length===0){return null}var a8=arguments[0],a4=arguments[1],a3=arguments[2],a5=null;if(a8.compute&&a8.getOrientation){return a8}else{if(typeof a8=="string"){a5=a6(arguments[0],{elementId:a4,jsPlumbInstance:aW})}else{if(f.isArray(a8)){if(f.isArray(a8[0])||f.isString(a8[0])){if(a8.length==2&&f.isString(a8[0])&&f.isObject(a8[1])){var a2=l.extend({elementId:a4,jsPlumbInstance:aW},a8[1]);a5=a6(a8[0],a2)}else{a5=new l.DynamicAnchor({anchors:a8,selector:null,elementId:a4,jsPlumbInstance:a3})}}else{var a7={x:a8[0],y:a8[1],orientation:(a8.length>=4)?[a8[2],a8[3]]:[0,0],offsets:(a8.length>=6)?[a8[4],a8[5]]:[0,0],elementId:a4,jsPlumbInstance:a3,cssClass:a8.length==7?a8[6]:null};a5=new l.Anchor(a7);a5.clone=function(){return new l.Anchor(a7)}}}}}if(!a5.id){a5.id="anchor_"+Z()}return a5};this.makeAnchors=function(a5,a3,a2){var a7=[];for(var a4=0,a6=a5.length;a4<a6;a4++){if(typeof a5[a4]=="string"){a7.push(l.Anchors[a5[a4]]({elementId:a3,jsPlumbInstance:a2}))}else{if(f.isArray(a5[a4])){a7.push(aW.makeAnchor(a5[a4],a3,a2))}}}return a7};this.makeDynamicAnchor=function(a2,a3){return new l.DynamicAnchor({anchors:a2,selector:a3,elementId:null,jsPlumbInstance:aW})};var aE={},ao={},aS={},ac={},Q=function(a2,a3){a2.paintStyle=a2.paintStyle||aW.Defaults.EndpointStyles[a3]||aW.Defaults.EndpointStyle||l.Defaults.EndpointStyles[a3]||l.Defaults.EndpointStyle;a2.hoverPaintStyle=a2.hoverPaintStyle||aW.Defaults.EndpointHoverStyles[a3]||aW.Defaults.EndpointHoverStyle||l.Defaults.EndpointHoverStyles[a3]||l.Defaults.EndpointHoverStyle;a2.anchor=a2.anchor||aW.Defaults.Anchors[a3]||aW.Defaults.Anchor||l.Defaults.Anchors[a3]||l.Defaults.Anchor;a2.endpoint=a2.endpoint||aW.Defaults.Endpoints[a3]||aW.Defaults.Endpoint||l.Defaults.Endpoints[a3]||l.Defaults.Endpoint},ag={},aG={},aJ={},S={},D={},G={},Y={},az=function(a3,a8,a2){var a6=a3.target||a3.srcElement,a5=false,a7=aW.getSelector(a8,a2);for(var a4=0;a4<a7.length;a4++){if(a7[a4]==a6){a5=true;break}}return a5};this.makeTarget=function(a5,a6,bd){var a3=l.extend({_jsPlumb:aW},bd);l.extend(a3,a6);Q(a3,1);var ba=l.CurrentLibrary,bb=a3.scope||aW.Defaults.Scope,a7=!(a3.deleteEndpointsOnDetach===false),a4=a3.maxConnections||-1,a2=a3.onMaxConnections;_doOne=function(bk){var bi=V(bk),bh=bi.id,bg=new v(a3),bf=l.extend({},a3.dropOptions||{});aE[bh]=a3;aS[bh]=a3.uniqueEndpoint;ac[bh]=a4;Y[bh]=true;var be=function(){aW.currentlyDragging=false;var bn=l.CurrentLibrary.getDropEvent(arguments),bp=aW.select({target:bh}).length,bA=h(ba.getDragObject(arguments)),bo=aW.getAttribute(bA,"dragId"),by=aW.getAttribute(bA,"originalScope"),bt=aR[bo],bv=bt.endpoints[0].isFloating()?0:1,bm=bt.endpoints[0],bl=a3.endpoint?l.extend({},a3.endpoint):{};if(!Y[bh]||ac[bh]>0&&bp>=ac[bh]){if(a2){a2({element:bi.el,connection:bt},bn)}return false}bm.anchor.locked=false;if(by){ba.setDragScope(bA,by)}var bs=bg.isDropAllowed(bv===0?bh:bt.sourceId,bv===0?bt.targetId:bh,bt.scope,bt,null);if(bt.suspendedEndpoint){bt[bv?"targetId":"sourceId"]=bt.suspendedEndpoint.elementId;bt[bv?"target":"source"]=bt.suspendedEndpoint.element;bt.endpoints[bv]=bt.suspendedEndpoint}if(bs){var bu=ba.getElementObject(bi.el),bz=ao[bh]||aW.addEndpoint(bu,a3);if(a3.uniqueEndpoint){ao[bh]=bz}bz._doNotDeleteOnDetach=false;bz._deleteOnDetach=true;if(bz.anchor.positionFinder!=null){var bw=ba.getUIPosition(arguments,aW.getZoom()),br=s(bu,aW),bx=a(bu),bq=bz.anchor.positionFinder(bw,br,bx,bz.anchor.constructorParams);bz.anchor.x=bq[0];bz.anchor.y=bq[1]}bt[bv?"target":"source"]=bz.element;bt[bv?"targetId":"sourceId"]=bz.elementId;bt.endpoints[bv].detachFromConnection(bt);if(bt.endpoints[bv]._deleteOnDetach){bt.endpoints[bv].deleteAfterDragStop=true}bz.addConnection(bt);bt.endpoints[bv]=bz;bt.deleteEndpointsOnDetach=a7;if(bv==1){aW.anchorManager.updateOtherEndpoint(bt.sourceId,bt.suspendedElementId,bt.targetId,bt)}else{aW.anchorManager.sourceChanged(bt.suspendedEndpoint.elementId,bt.sourceId,bt)}a1(bt,null,bn)}else{if(bt.suspendedEndpoint){if(bt.isReattach()){bt.setHover(false);bt.floatingAnchorIndex=null;bt.suspendedEndpoint.addConnection(bt);aW.repaint(bm.elementId)}else{bm.detach(bt,false,true,true,bn)}}}};var bj=ba.dragEvents.drop;bf.scope=bf.scope||bb;bf[bj]=f.wrap(bf[bj],be);ba.initDroppable(h(bi.el),bf,true)};a5=ap(a5);var a9=a5.length&&a5.constructor!=String?a5:[a5];for(var a8=0,bc=a9.length;a8<bc;a8++){_doOne(a9[a8])}return aW};this.unmakeTarget=function(a2,a4){var a3=V(a2);l.CurrentLibrary.destroyDroppable(a3.el);if(!a4){delete aE[a3.id];delete aS[a3.id];delete ac[a3.id];delete Y[a3.id]}return aW};this.makeSource=function(a6,a7,bc){var a4=l.extend({},bc);l.extend(a4,a7);Q(a4,0);var ba=l.CurrentLibrary,a5=a4.maxConnections||-1,a3=a4.onMaxConnections,a2=function(be){var bf=be.id,bl=h(be.el),bn=function(){return a4.parent==null?null:a4.parent==="parent"?be.el.parentNode:A(a4.parent)},bd=a4.parent!=null?aW.getId(bn()):bf;ag[bd]=a4;aJ[bd]=a4.uniqueEndpoint;S[bd]=true;var bg=ba.dragEvents.stop,bk=ba.dragEvents.drag,bm=l.extend({},a4.dragOptions||{}),bi=bm.drag,bo=bm.stop,bp=null,bj=false;G[bd]=a5;bm.scope=bm.scope||a4.scope;bm[bk]=f.wrap(bm[bk],function(){if(bi){bi.apply(this,arguments)}bj=false});bm[bg]=f.wrap(bm[bg],function(){if(bo){bo.apply(this,arguments)}aW.currentlyDragging=false;if(bp._jsPlumb!=null){ba.unbind(bp.canvas,"mousedown");var br=a4.anchor||aW.Defaults.Anchor,bs=bp.anchor,bu=bp.connections[0];bp.setAnchor(aW.makeAnchor(br,bf,aW),true);if(a4.parent){var bt=bn();if(bt){var bq=bp.elementId,bv=a4.container||aW.Defaults.Container||l.Defaults.Container;bp.setElement(bt,bv);bp.endpointWillMoveAfterConnection=false;bu.previousConnection=null;jsPlumbUtil.removeWithFunction(L,function(bw){return bw.id===bu.id});aW.anchorManager.connectionDetached({sourceId:bu.sourceId,targetId:bu.targetId,connection:bu});a1(bu)}}bp.repaint();aW.repaint(bp.elementId);aW.repaint(bu.targetId)}});var bh=function(bu){if(!S[bd]){return}if(a4.filter){var bB=ba.getOriginalEvent(bu),bq=jsPlumbUtil.isString(a4.filter)?az(bB,bl,a4.filter):a4.filter(bB,bl);if(bq===false){return}}var bs=aW.select({source:bd}).length;if(G[bd]>=0&&bs>=G[bd]){if(a3){a3({element:bl,maxConnections:a5},bu)}return false}var bz=O({elId:bf}).o,bw=aW.getZoom(),by=(((bu.pageX||bu.page.x)/bw)-bz.left)/bz.width,bx=(((bu.pageY||bu.page.y)/bw)-bz.top)/bz.height,bE=by,bD=bx;if(a4.parent){var bv=bn(),bt=B(bv);bz=O({elId:bt}).o;bE=((bu.pageX||bu.page.x)-bz.left)/bz.width;bD=((bu.pageY||bu.page.y)-bz.top)/bz.height}var bC={};l.extend(bC,a4);bC.isSource=true;bC.anchor=[by,bx,0,0];bC.parentAnchor=[bE,bD,0,0];bC.dragOptions=bm;if(a4.parent){var br=bC.container||aW.Defaults.Container||l.Defaults.Container;if(br){bC.container=br}else{bC.container=l.CurrentLibrary.getParent(bn())}}bp=aW.addEndpoint(bf,bC);bj=true;bp.endpointWillMoveAfterConnection=a4.parent!=null;bp.endpointWillMoveTo=a4.parent?bn():null;bp._doNotDeleteOnDetach=false;bp._deleteOnDetach=true;var bA=function(){if(bj){bj=false;aW.deleteEndpoint(bp)}};aW.registerListener(bp.canvas,"mouseup",bA);aW.registerListener(bl,"mouseup",bA);ba.trigger(bp.canvas,"mousedown",bu)};aW.registerListener(bl,"mousedown",bh);D[bf]=bh;if(a4.filter&&jsPlumbUtil.isString(a4.filter)){ba.setDragFilter(bl,a4.filter)}};a6=ap(a6);var a9=a6.length&&a6.constructor!=String?a6:[a6];for(var a8=0,bb=a9.length;a8<bb;a8++){a2(V(a9[a8]))}return aW};this.unmakeSource=function(a3,a5){var a4=V(a3),a2=D[a4.id];if(a2){aW.unregisterListener(a4.el,"mousedown",a2)}if(!a5){delete ag[a4.id];delete aJ[a4.id];delete S[a4.id];delete D[a4.id];delete G[a4.id]}return aW};this.unmakeEverySource=function(){for(var a2 in S){aW.unmakeSource(a2,true)}ag={};aJ={};S={};D={}};this.unmakeEveryTarget=function(){for(var a2 in Y){aW.unmakeTarget(a2,true)}aE={};aS={};ac={};Y={};return aW};var at=function(a7,a6,a8,a2){var a3=a7=="source"?S:Y;a6=ap(a6);if(f.isString(a6)){a3[a6]=a2?!a3[a6]:a8}else{if(a6.length){for(var a4=0,a5=a6.length;a4<a5;a4++){var a9=V(a6[a4]);a3[a9.id]=a2?!a3[a9.id]:a8}}}return aW};this.toggleSourceEnabled=function(a2){at("source",a2,null,true);return aW.isSourceEnabled(a2)};this.setSourceEnabled=function(a2,a3){return at("source",a2,a3)};this.isSource=function(a2){return S[V(a2).id]!=null};this.isSourceEnabled=function(a2){return S[V(a2).id]===true};this.toggleTargetEnabled=function(a2){at("target",a2,null,true);return aW.isTargetEnabled(a2)};this.isTarget=function(a2){return Y[V(a2).id]!=null};this.isTargetEnabled=function(a2){return Y[V(a2).id]===true};this.setTargetEnabled=function(a2,a3){return at("target",a2,a3)};this.ready=function(a2){aW.bind("ready",a2)};this.repaint=function(a4,a6,a5){if(typeof a4=="object"&&a4.length){for(var a2=0,a3=a4.length;a2<a3;a2++){aL(a4[a2],a6,a5)}}else{aL(a4,a6,a5)}return aW};this.repaintEverything=function(){var a3=n();for(var a2 in ay){aL(a2,null,a3)}return aW};this.removeAllEndpoints=function(a3,a4){var a2=function(a9){var a7=V(a9),a8=ay[a7.id],a5,a6;if(a8){for(a5=0,a6=a8.length;a5<a6;a5++){aW.deleteEndpoint(a8[a5])}}delete ay[a7.id];if(a4){if(a7.el&&a7.el.nodeType!=3&&a7.el.nodeType!=8){for(a5=0,a6=a7.el.childNodes.length;a5<a6;a5++){a2(a7.el.childNodes[a5])}}}};a2(a3);return aW};this.remove=function(a2,a4){var a3=V(a2);aW.doWhileSuspended(function(){aW.removeAllEndpoints(a3.id,true);aW.dragManager.elementRemoved(a3.id);delete aR[a3.id];aW.anchorManager.clearFor(a3.id);aW.anchorManager.removeFloatingConnection(a3.id)},a4===false);if(a3.el){l.CurrentLibrary.removeElement(a3.el)}};var W={},aP=function(){for(var a3 in W){for(var a2=0,a4=W[a3].length;a2<a4;a2++){var a5=W[a3][a2];l.CurrentLibrary.unbind(a5.el,a5.event,a5.listener)}}W={}};this.registerListener=function(a3,a2,a4){l.CurrentLibrary.bind(a3,a2,a4);jsPlumbUtil.addToList(W,a2,{el:a3,event:a2,listener:a4})};this.unregisterListener=function(a3,a2,a4){l.CurrentLibrary.unbind(a3,a2,a4);jsPlumbUtil.removeWithFunction(W,function(a5){return a5.type==a2&&a5.listener==a4})};this.reset=function(){aW.deleteEveryEndpoint();aW.unbind();aE={};ao={};aS={};ac={};ag={};aG={};aJ={};G={};L.splice(0);aP();aW.anchorManager.reset();if(!jsPlumbAdapter.headless){aW.dragManager.reset()}};this.setDefaultScope=function(a2){K=a2;return aW};this.setDraggable=aU;this.setId=function(a4,a5,a9){var a2;if(jsPlumbUtil.isString(a4)){a2=a4}else{a4=A(a4);a2=aW.getId(a4)}var a3=aW.getConnections({source:a2,scope:"*"},true),a7=aW.getConnections({target:a2,scope:"*"},true);a5=""+a5;if(!a9){a4=A(a2);jsPlumbAdapter.setAttribute(a4,"id",a5)}else{a4=A(a5)}ay[a5]=ay[a2]||[];for(var a8=0,ba=ay[a5].length;a8<ba;a8++){ay[a5][a8].setElementId(a5);ay[a5][a8].setReferenceElement(a4)}delete ay[a2];aW.anchorManager.changeId(a2,a5);if(!jsPlumbAdapter.headless){aW.dragManager.changeId(a2,a5)}var a6=function(bf,bb,be){for(var bc=0,bd=bf.length;bc<bd;bc++){bf[bc].endpoints[bb].setElementId(a5);bf[bc].endpoints[bb].setReferenceElement(a4);bf[bc][be+"Id"]=a5;bf[bc][be]=a4}};a6(a3,0,"source");a6(a7,1,"target");aW.repaint(a5)};this.setDebugLog=function(a2){H=a2};this.setSuspendDrawing=function(a4,a2){var a3=aH;aH=a4;if(a4){aK=new Date().getTime()}else{aK=null}if(a2){aW.repaintEverything()}return a3};this.isSuspendDrawing=function(){return aH};this.getSuspendedAt=function(){return aK};this.doWhileSuspended=function(a3,a2){var a5=aW.isSuspendDrawing();if(!a5){aW.setSuspendDrawing(true)}try{a3()}catch(a4){f.log("Function run while suspended failed",a4)}if(!a5){aW.setSuspendDrawing(false,!a2)}};this.updateOffset=O;this.getOffset=function(a2){return X[a2]};this.getSize=function(a2){return U[a2]};this.getCachedData=au;this.timestamp=n;this.setRenderMode=function(a5){P=jsPlumbAdapter.setRenderMode(a5);var a2,a4;if(P==l.CANVAS){var a3=function(a6){l.CurrentLibrary.bind(document,a6,function(ba){if(!aW.currentlyDragging&&P==l.CANVAS){for(a2=0,a4=L.length;a2<a4;a2++){var a8=L[a2].getConnector()[a6](ba);if(a8){return}}for(var a9 in ay){var a7=ay[a9];for(a2=0,a4=a7.length;a2<a4;a2++){if(a7[a2].endpoint[a6]&&a7[a2].endpoint[a6](ba)){return}}}}})};a3("click");a3("dblclick");a3("mousemove");a3("mousedown");a3("mouseup");a3("contextmenu")}return P};this.getRenderMode=function(){return P};this.show=function(a2,a3){aF(a2,"block",a3);return aW};this.getTestHarness=function(){return{endpointsByElement:ay,endpointCount:function(a2){var a3=ay[a2];return a3?a3.length:0},connectionCount:function(a2){a2=a2||K;var a3=aW.getConnections({scope:a2});return a3?a3.length:0},getId:B,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}};this.toggleVisible=aw;this.toggleDraggable=aT;this.addListener=this.bind;this.adjustForParentOffsetAndScroll=function(a7,a4){var a5=null,a2=a7;if(a4.tagName.toLowerCase()==="svg"&&a4.parentNode){a5=a4.parentNode}else{if(a4.offsetParent){a5=a4.offsetParent}}if(a5!=null){var a3=a5.tagName.toLowerCase()==="body"?{left:0,top:0}:s(a5,aW),a6=a5.tagName.toLowerCase()==="body"?{left:0,top:0}:{left:a5.scrollLeft,top:a5.scrollTop};a2[0]=a7[0]-a3.left+a6.left;a2[1]=a7[1]-a3.top+a6.top}return a2};if(!jsPlumbAdapter.headless){aW.dragManager=jsPlumbAdapter.getDragManager(aW);aW.recalculateOffsets=aW.dragManager.updateOffsets}};jsPlumbUtil.extend(t,jsPlumbUtil.EventGenerator,{setAttribute:function(D,B,C){jsPlumbAdapter.setAttribute(D,B,C)},getAttribute:function(C,B){return jsPlumbAdapter.getAttribute(l.CurrentLibrary.getDOMElement(C),B)},registerConnectionType:function(C,B){this._connectionTypes[C]=l.extend({},B)},registerConnectionTypes:function(C){for(var B in C){this._connectionTypes[B]=l.extend({},C[B])}},registerEndpointType:function(C,B){this._endpointTypes[C]=l.extend({},B)},registerEndpointTypes:function(C){for(var B in C){this._endpointTypes[B]=l.extend({},C[B])}},getType:function(C,B){return B==="connection"?this._connectionTypes[C]:this._endpointTypes[C]},setIdChanged:function(C,B){this.setId(C,B,true)}});var l=new t();if(typeof window!="undefined"){window.jsPlumb=l}l.getInstance=function(C){var B=new t(C);B.init();return B};if(typeof define==="function"){define("jsplumb",[],function(){return l});define("jsplumbinstance",[],function(){return l.getInstance()})}if(typeof exports!=="undefined"){exports.jsPlumb=l}})();(function(){var e=function(i,g){var h=false;return{drag:function(){if(h){h=false;return true}var k=jsPlumb.CurrentLibrary.getUIPosition(arguments,g.getZoom());if(i.element){jsPlumb.CurrentLibrary.setOffset(i.element,k);g.repaint(i.element,k)}},stopDrag:function(){h=true}}};var b=function(k,h,g){var m=document.createElement("div");m.style.position="absolute";var i=jsPlumb.CurrentLibrary.getElementObject(m);jsPlumb.CurrentLibrary.appendElement(m,h);var l=g.getId(m);g.updateOffset({elId:l});k.id=l;k.element=m};var f=function(n,m,o,l,i,h,g){var k=new jsPlumb.FloatingAnchor({reference:m,referenceCanvas:l,jsPlumbInstance:h});return g({paintStyle:n,endpoint:o,anchor:k,source:i,scope:"__floating"})};var c=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];var a=function(k,h){var g=0;if(h!=null){for(var l=0;l<k.connections.length;l++){if(k.connections[l].sourceId==h||k.connections[l].targetId==h){g=l;break}}}return k.connections[g]};var d=function(h,g){return jsPlumbUtil.findWithFunction(g.connections,function(i){return i.id==h.id})};jsPlumb.Endpoint=function(H){var I=H._jsPlumb,m=jsPlumb.CurrentLibrary,G=jsPlumbAdapter.getAttribute,o=m.getElementObject,J=m.getDOMElement,l=jsPlumbUtil,B=H.newConnection,E=H.newEndpoint,k=H.finaliseConnection,u=H.fireDetachEvent,v=H.floatingConnections;this.idPrefix="_jsplumb_e_";this.defaultLabelLocation=[0.5,0.5];this.defaultOverlayKeys=["Overlays","EndpointOverlays"];this.parent=H.parent;OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:H.connectorStyle,connectorHoverStyle:H.connectorHoverStyle,connectorClass:H.connectorClass,connectorHoverClass:H.connectorHoverClass,connectorOverlays:H.connectorOverlays,connector:H.connector,connectorTooltip:H.connectorTooltip}};this._jsPlumb.enabled=!(H.enabled===false);this._jsPlumb.visible=true;this.element=J(H.source);this._jsPlumb.uuid=H.uuid;this._jsPlumb.floatingEndpoint=null;var p=null;if(this._jsPlumb.uuid){H.endpointsByUUID[this._jsPlumb.uuid]=this}this.elementId=H.elementId;this._jsPlumb.connectionCost=H.connectionCost;this._jsPlumb.connectionsDirected=H.connectionsDirected;this._jsPlumb.currentAnchorClass="";this._jsPlumb.events={};var s=function(){m.removeClass(this.element,I.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this.removeClass(I.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();this.addClass(I.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);m.addClass(this.element,I.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass)}.bind(this);this.setAnchor=function(i,L){this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId);this.anchor=this._jsPlumb.instance.makeAnchor(i,this.elementId,I);s();this.anchor.bind("anchorChanged",function(M){this.fire("anchorChanged",{endpoint:this,anchor:M});s()}.bind(this));if(!L){this._jsPlumb.instance.repaint(this.elementId)}return this};var x=H.anchor?H.anchor:H.anchors?H.anchors:(I.Defaults.Anchor||"Top");this.setAnchor(x,true);var K=function(i){if(this.connections.length>0){this.connections[0].setHover(i,false)}else{this.setHover(i)}}.bind(this);if(!H._transient){this._jsPlumb.instance.anchorManager.add(this,this.elementId)}this.setEndpoint=function(L){if(this.endpoint!=null){this.endpoint.cleanup();this.endpoint.destroy()}var i=function(O,Q){var P=I.getRenderMode();if(jsPlumb.Endpoints[P][O]){return new jsPlumb.Endpoints[P][O](Q)}if(!I.Defaults.DoNotThrowErrors){throw {msg:"jsPlumb: unknown endpoint type '"+O+"'"}}};var M={_jsPlumb:this._jsPlumb.instance,cssClass:H.cssClass,parent:H.parent,container:H.container,tooltip:H.tooltip,connectorTooltip:H.connectorTooltip,endpoint:this};if(l.isString(L)){this.endpoint=i(L,M)}else{if(l.isArray(L)){M=l.merge(L[1],M);this.endpoint=i(L[0],M)}else{this.endpoint=L.clone()}}var N=jsPlumb.extend({},M);this.endpoint.clone=function(){if(l.isString(L)){return i(L,M)}else{if(l.isArray(L)){M=l.merge(L[1],M);return i(L[0],M)}}}.bind(this);this.type=this.endpoint.type;this.bindListeners(this.endpoint,this,K)};this.setEndpoint(H.endpoint||I.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot");this.setPaintStyle(H.paintStyle||H.style||I.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,true);this.setHoverPaintStyle(H.hoverPaintStyle||I.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,true);this._jsPlumb.paintStyleInUse=this.getPaintStyle();l.copyValues(c,H,this);this.isSource=H.isSource||false;this.isTarget=H.isTarget||false;this._jsPlumb.maxConnections=H.maxConnections||I.Defaults.MaxConnections;this.canvas=this.endpoint.canvas;this.addClass(I.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);m.addClass(this.element,I.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this.connections=H.connections||[];this.connectorPointerEvents=H["connector-pointer-events"];this.scope=H.scope||I.getDefaultScope();this.timestamp=null;this.reattachConnections=H.reattach||I.Defaults.ReattachConnections;this.connectionsDetachable=I.Defaults.ConnectionsDetachable;if(H.connectionsDetachable===false||H.detachable===false){this.connectionsDetachable=false}this.dragAllowedWhenFull=H.dragAllowedWhenFull||true;if(H.onMaxConnections){this.bind("maxConnections",H.onMaxConnections)}this.addConnection=function(i){this.connections.push(i);this[(this.connections.length>0?"add":"remove")+"Class"](I.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](I.endpointFullClass)};this.detachFromConnection=function(L,i){i=i==null?d(L,this):i;if(i>=0){this.connections.splice(i,1);this[(this.connections.length>0?"add":"remove")+"Class"](I.endpointConnectedClass);this[(this.isFull()?"add":"remove")+"Class"](I.endpointFullClass)}};this.detach=function(M,P,N,S,i,L,O){var R=O==null?d(M,this):O,Q=false;S=(S!==false);if(R>=0){if(N||M._forceDetach||(M.isDetachable()&&M.isDetachAllowed(M)&&this.isDetachAllowed(M))){I.deleteObject({connection:M,fireEvent:(!P&&S),originalEvent:i});Q=true}}return Q};this.detachAll=function(L,i){while(this.connections.length>0){this.detach(this.connections[0],false,true,L!==false,i,this,0)}return this};this.detachFrom=function(P,O,L){var Q=[];for(var N=0;N<this.connections.length;N++){if(this.connections[N].endpoints[1]==P||this.connections[N].endpoints[0]==P){Q.push(this.connections[N])}}for(var M=0;M<Q.length;M++){this.detach(Q[M],false,true,O,L)}return this};this.getElement=function(){return this.element};this.setElement=function(i){var M=this._jsPlumb.instance.getId(i),L=this.elementId;l.removeWithFunction(H.endpointsByElement[this.elementId],function(N){return N.id==this.id}.bind(this));this.element=J(i);this.elementId=I.getId(this.element);I.anchorManager.rehomeEndpoint(this,L,this.element);I.dragManager.endpointAdded(this.element);l.addToList(H.endpointsByElement,M,this);return this};this.makeInPlaceCopy=function(){var N=this.anchor.getCurrentLocation({element:this}),M=this.anchor.getOrientation(this),L=this.anchor.getCssClass(),i={bind:function(){},compute:function(){return[N[0],N[1]]},getCurrentLocation:function(){return[N[0],N[1]]},getOrientation:function(){return M},getCssClass:function(){return L}};return E({anchor:i,source:this.element,paintStyle:this.getPaintStyle(),endpoint:H.hideOnDrag?"Blank":this.endpoint,_transient:true,scope:this.scope})};this.isFloating=function(){return this.anchor!=null&&this.anchor.isFloating};this.connectorSelector=function(){var i=this.connections[0];if(this.isTarget&&i){return i}else{return(this.connections.length<this._jsPlumb.maxConnections)||this._jsPlumb.maxConnections==-1?null:i}};this.setStyle=this.setPaintStyle;this.paint=function(P){P=P||{};var V=P.timestamp,U=!(P.recalc===false);if(!V||this.timestamp!==V){var O=I.updateOffset({elId:this.elementId,timestamp:V});var ab=P.offset?P.offset.o:O.o;if(ab!=null){var S=P.anchorPoint,Q=P.connectorPaintStyle;if(S==null){var L=P.dimensions||O.s,N={xy:[ab.left,ab.top],wh:L,element:this,timestamp:V};if(U&&this.anchor.isDynamic&&this.connections.length>0){var X=a(this,P.elementWithPrecedence),aa=X.endpoints[0]==this?1:0,R=aa===0?X.sourceId:X.targetId,Z=I.getCachedData(R),W=Z.o,Y=Z.s;N.txy=[W.left,W.top];N.twh=Y;N.tElement=X.endpoints[aa]}S=this.anchor.compute(N)}this.endpoint.compute(S,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,Q||this.paintStyleInUse);this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor);this.timestamp=V;for(var T=0;T<this._jsPlumb.overlays.length;T++){var M=this._jsPlumb.overlays[T];if(M.isVisible()){this._jsPlumb.overlayPlacements[T]=M.draw(this.endpoint,this._jsPlumb.paintStyleInUse);M.paint(this._jsPlumb.overlayPlacements[T])}}}}};this.repaint=this.paint;if(m.isDragSupported(this.element)&&(this.isSource||this.isTarget)){var A={id:null,element:null},z=null,h=false,n=null,g=e(A,I);var q=function(){z=this.connectorSelector();var P=true;if(!this.isEnabled()){P=false}if(z==null&&!this.isSource){P=false}if(this.isSource&&this.isFull()&&!this.dragAllowedWhenFull){P=false}if(z!=null&&!z.isDetachable()){P=false}if(P===false){if(m.stopDrag){m.stopDrag()}g.stopDrag();return false}for(var O=0;O<this.connections.length;O++){this.connections[O].setHover(false)}this.addClass("endpointDrag");I.setConnectionBeingDragged(true);if(z&&!this.isFull()&&this.isSource){z=null}I.updateOffset({elId:this.elementId});p=this.makeInPlaceCopy();p.referenceEndpoint=this;p.paint();b(A,this.parent,I);var T=o(p.canvas),R=jsPlumb.CurrentLibrary.getOffset(T,I),N=I.adjustForParentOffsetAndScroll([R.left,R.top],p.canvas),S=o(this.canvas);m.setOffset(A.element,{left:N[0],top:N[1]});if(this.parentAnchor){this.anchor=I.makeAnchor(this.parentAnchor,this.elementId,I)}I.setAttribute(this.canvas,"dragId",A.id);I.setAttribute(this.canvas,"elId",this.elementId);this._jsPlumb.floatingEndpoint=f(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,A.element,I,E);this.canvas.style.visibility="hidden";if(z==null){this.anchor.locked=true;this.setHover(false,false);z=B({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:A.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:H.connectorStyle,hoverPaintStyle:H.connectorHoverStyle,connector:H.connector,overlays:H.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass});z.addClass(I.draggingClass);this._jsPlumb.floatingEndpoint.addClass(I.draggingClass);I.fire("connectionDrag",z)}else{h=true;z.setHover(false);r(T,false,true);var M=z.endpoints[0].id==this.id?0:1;z.floatingAnchorIndex=M;this.detachFromConnection(z);var Q=jsPlumb.CurrentLibrary.getDragScope(S);I.setAttribute(this.canvas,"originalScope",Q);var L=m.getDropScope(S);m.setDragScope(S,L);I.fire("connectionDrag",z);if(M===0){n=[z.source,z.sourceId,S,Q];z.source=A.element;z.sourceId=A.id}else{n=[z.target,z.targetId,S,Q];z.target=A.element;z.targetId=A.id}z.endpoints[M===0?1:0].anchor.locked=true;z.suspendedEndpoint=z.endpoints[M];z.suspendedElement=z.endpoints[M].getElement();z.suspendedElementId=z.endpoints[M].elementId;z.suspendedElementType=M===0?"source":"target";z.suspendedEndpoint.setHover(false);this._jsPlumb.floatingEndpoint.referenceEndpoint=z.suspendedEndpoint;z.endpoints[M]=this._jsPlumb.floatingEndpoint;z.addClass(I.draggingClass);this._jsPlumb.floatingEndpoint.addClass(I.draggingClass)}v[A.id]=z;I.anchorManager.addFloatingConnection(A.id,z);l.addToList(H.endpointsByElement,A.id,this._jsPlumb.floatingEndpoint);I.currentlyDragging=true}.bind(this);var C=H.dragOptions||{},w=jsPlumb.extend({},m.defaultDragOptions),y=m.dragEvents.start,F=m.dragEvents.stop,t=m.dragEvents.drag;C=jsPlumb.extend(w,C);C.scope=C.scope||this.scope;C[y]=l.wrap(C[y],q,false);C[t]=l.wrap(C[t],g.drag);C[F]=l.wrap(C[F],function(){I.setConnectionBeingDragged(false);var L=m.getDropEvent(arguments);var i=z.floatingAnchorIndex==null?1:z.floatingAnchorIndex;z.endpoints[i===0?1:0].anchor.locked=false;z.removeClass(I.draggingClass);if(z.endpoints[i]==this._jsPlumb.floatingEndpoint){if(h&&z.suspendedEndpoint){if(i===0){z.source=n[0];z.sourceId=n[1]}else{z.target=n[0];z.targetId=n[1]}m.setDragScope(n[2],n[3]);z.endpoints[i]=z.suspendedEndpoint;if(z.isReattach()||z._forceReattach||z._forceDetach||!z.endpoints[i===0?1:0].detach(z,false,false,true,L)){z.setHover(false);z.floatingAnchorIndex=null;z._forceDetach=null;z._forceReattach=null;this._jsPlumb.floatingEndpoint.detachFromConnection(z);z.suspendedEndpoint.addConnection(z);I.repaint(n[1])}}}I.remove(A.element,false);I.remove(p.canvas,false);if(this.deleteAfterDragStop){I.deleteObject({endpoint:this})}else{if(this._jsPlumb){this._jsPlumb.floatingEndpoint=null;this.canvas.style.visibility="visible";this.anchor.locked=false;this.paint({recalc:false})}}I.fire("connectionDragStop",z);I.currentlyDragging=false;z=null}.bind(this));var D=o(this.canvas);m.initDraggable(D,C,true,I)}var r=function(M,R,P,S){if((this.isTarget||R)&&m.isDropSupported(this.element)){var N=H.dropOptions||I.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;N=jsPlumb.extend({},N);N.scope=N.scope||this.scope;var L=m.dragEvents.drop,Q=m.dragEvents.over,i=m.dragEvents.out,O=function(){this.removeClass(I.endpointDropAllowedClass);this.removeClass(I.endpointDropForbiddenClass);var T=m.getDropEvent(arguments),ag=o(m.getDragObject(arguments)),V=I.getAttribute(ag,"dragId"),X=I.getAttribute(ag,"elId"),af=I.getAttribute(ag,"originalScope"),aa=v[V];var Y=aa.suspendedEndpoint&&(aa.suspendedEndpoint.id==this.id||this.referenceEndpoint&&aa.suspendedEndpoint.id==this.referenceEndpoint.id);if(Y){aa._forceReattach=true;return}if(aa!=null){var ac=aa.floatingAnchorIndex==null?1:aa.floatingAnchorIndex,ad=ac===0?1:0;if(af){jsPlumb.CurrentLibrary.setDragScope(ag,af)}var ae=S!=null?S.isEnabled():true;if(this.isFull()){this.fire("maxConnections",{endpoint:this,connection:aa,maxConnections:this._jsPlumb.maxConnections},T)}if(!this.isFull()&&!(ac===0&&!this.isSource)&&!(ac==1&&!this.isTarget)&&ae){var Z=true;if(aa.suspendedEndpoint&&aa.suspendedEndpoint.id!=this.id){if(ac===0){aa.source=aa.suspendedEndpoint.element;aa.sourceId=aa.suspendedEndpoint.elementId}else{aa.target=aa.suspendedEndpoint.element;aa.targetId=aa.suspendedEndpoint.elementId}if(!aa.isDetachAllowed(aa)||!aa.endpoints[ac].isDetachAllowed(aa)||!aa.suspendedEndpoint.isDetachAllowed(aa)||!I.checkCondition("beforeDetach",aa)){Z=false}}if(ac===0){aa.source=this.element;aa.sourceId=this.elementId}else{aa.target=this.element;aa.targetId=this.elementId}var ab=function(){aa.floatingAnchorIndex=null};var U=function(){aa.endpoints[ac].detachFromConnection(aa);if(aa.suspendedEndpoint){aa.suspendedEndpoint.detachFromConnection(aa)}aa.endpoints[ac]=this;this.addConnection(aa);var ak=this.getParameters();for(var ai in ak){aa.setParameter(ai,ak[ai])}if(!aa.suspendedEndpoint){if(ak.draggable){jsPlumb.CurrentLibrary.initDraggable(this.element,C,true,I)}}else{var aj=aa.suspendedEndpoint.getElement(),ah=aa.suspendedEndpoint.elementId;u({source:ac===0?aj:aa.source,target:ac==1?aj:aa.target,sourceId:ac===0?ah:aa.sourceId,targetId:ac==1?ah:aa.targetId,sourceEndpoint:ac===0?aa.suspendedEndpoint:aa.endpoints[0],targetEndpoint:ac==1?aa.suspendedEndpoint:aa.endpoints[1],connection:aa},true,T)}if(ac==1){I.anchorManager.updateOtherEndpoint(aa.sourceId,aa.suspendedElementId,aa.targetId,aa)}else{I.anchorManager.sourceChanged(aa.suspendedEndpoint.elementId,aa.sourceId,aa)}k(aa,null,T,true);ab()}.bind(this);var W=function(){if(aa.suspendedEndpoint){aa.endpoints[ac]=aa.suspendedEndpoint;aa.setHover(false);aa._forceDetach=true;if(ac===0){aa.source=aa.suspendedEndpoint.element;aa.sourceId=aa.suspendedEndpoint.elementId}else{aa.target=aa.suspendedEndpoint.element;aa.targetId=aa.suspendedEndpoint.elementId}aa.suspendedEndpoint.addConnection(aa);aa.endpoints[0].repaint();aa.repaint();I.repaint(aa.sourceId);aa._forceDetach=false}ab()};Z=Z&&this.isDropAllowed(aa.sourceId,aa.targetId,aa.scope,aa,this);if(Z){U()}else{W()}}I.currentlyDragging=false}}.bind(this);N[L]=l.wrap(N[L],O);N[Q]=l.wrap(N[Q],function(){var U=m.getDragObject(arguments),Y=I.getAttribute(U,"dragId"),X=v[Y];if(X!=null){var T=X.floatingAnchorIndex==null?1:X.floatingAnchorIndex;var W=(this.isTarget&&X.floatingAnchorIndex!==0)||(X.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==X.suspendedEndpoint.id);if(W){var V=I.checkCondition("checkDropAllowed",{sourceEndpoint:X.endpoints[T],targetEndpoint:this,connection:X});this[(V?"add":"remove")+"Class"](I.endpointDropAllowedClass);this[(V?"remove":"add")+"Class"](I.endpointDropForbiddenClass);X.endpoints[T].anchor.over(this.anchor,this)}}}.bind(this));N[i]=l.wrap(N[i],function(){var U=m.getDragObject(arguments),X=I.getAttribute(U,"dragId"),W=v[X];if(W!=null){var T=W.floatingAnchorIndex==null?1:W.floatingAnchorIndex;var V=(this.isTarget&&W.floatingAnchorIndex!==0)||(W.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==W.suspendedEndpoint.id);if(V){this.removeClass(I.endpointDropAllowedClass);this.removeClass(I.endpointDropForbiddenClass);W.endpoints[T].anchor.out()}}}.bind(this));m.initDroppable(M,N,true,P)}}.bind(this);r(o(this.canvas),true,!(H._transient||this.anchor.isFloating),this);if(H.type){this.addType(H.type,H.data,I.isSuspendDrawing())}return this};jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(h,m,g){this._jsPlumb.visible=h;if(this.canvas){this.canvas.style.display=h?"block":"none"}this[h?"showOverlays":"hideOverlays"]();if(!m){for(var l=0;l<this.connections.length;l++){this.connections[l].setVisible(h);if(!g){var k=this===this.connections[l].endpoints[0]?1:0;if(this.connections[l].endpoints[k].connections.length==1){this.connections[l].endpoints[k].setVisible(h,true,true)}}}}},getAttachedElements:function(){return this.connections},applyType:function(g,h){if(g.maxConnections!=null){this._jsPlumb.maxConnections=g.maxConnections}if(g.scope){this.scope=g.scope}jsPlumbUtil.copyValues(c,g,this)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(g){this._jsPlumb.enabled=g},cleanup:function(){jsPlumb.CurrentLibrary.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass);this.anchor=null;this.endpoint.cleanup();this.endpoint.destroy();this.endpoint=null;var g=jsPlumb.CurrentLibrary.getElementObject(this.canvas);jsPlumb.CurrentLibrary.destroyDraggable(g);jsPlumb.CurrentLibrary.destroyDroppable(g)},setHover:function(g){if(this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.endpoint.setHover(g)}},isFull:function(){return !(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(g){this._jsPlumb.connectionCost=g},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(g){this._jsPlumb.connectionsDirected=g},setElementId:function(g){this.elementId=g;this.anchor.elementId=g},setReferenceElement:function(g){this.element=jsPlumb.CurrentLibrary.getDOMElement(g)},setDragAllowedWhenFull:function(g){this.dragAllowedWhenFull=g},equals:function(g){return this.anchor.equals(g.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(g){return this.anchor.compute(g)}})})();(function(){var c=function(d,e,g,f){if(!d.Defaults.DoNotThrowErrors&&jsPlumb.Connectors[e][g]==null){throw {msg:"jsPlumb: unknown connector type '"+g+"'"}}return new jsPlumb.Connectors[e][g](f)},a=function(f,e,d){return(f)?d.makeAnchor(f,e,d):null},b=function(s,f,g,d,n,i,k,l,h,m){var o;if(d){g.endpoints[n]=d;d.addConnection(g)}else{if(!i.endpoints){i.endpoints=[null,null]}var v=i.endpoints[n]||i.endpoint||s.Defaults.Endpoints[n]||jsPlumb.Defaults.Endpoints[n]||s.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;if(!i.endpointStyles){i.endpointStyles=[null,null]}if(!i.endpointHoverStyles){i.endpointHoverStyles=[null,null]}var r=i.endpointStyles[n]||i.endpointStyle||s.Defaults.EndpointStyles[n]||jsPlumb.Defaults.EndpointStyles[n]||s.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;if(r.fillStyle==null&&h!=null){r.fillStyle=h.strokeStyle}if(r.outlineColor==null&&h!=null){r.outlineColor=h.outlineColor}if(r.outlineWidth==null&&h!=null){r.outlineWidth=h.outlineWidth}var q=i.endpointHoverStyles[n]||i.endpointHoverStyle||s.Defaults.EndpointHoverStyles[n]||jsPlumb.Defaults.EndpointHoverStyles[n]||s.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;if(m!=null){if(q==null){q={}}if(q.fillStyle==null){q.fillStyle=m.strokeStyle}}var p=i.anchors?i.anchors[n]:i.anchor?i.anchor:a(s.Defaults.Anchors[n],l,s)||a(jsPlumb.Defaults.Anchors[n],l,s)||a(s.Defaults.Anchor,l,s)||a(jsPlumb.Defaults.Anchor,l,s),t=i.uuids?i.uuids[n]:null;o=f({paintStyle:r,hoverPaintStyle:q,endpoint:v,connections:[g],uuid:t,anchor:p,source:k,scope:i.scope,container:i.container,reattach:i.reattach||s.Defaults.ReattachConnections,detachable:i.detachable||s.Defaults.ConnectionsDetachable});g.endpoints[n]=o;if(i.drawEndpoints===false){o.setVisible(false,true,true)}}return o};jsPlumb.Connection=function(x){var s=x.newConnection,t=x.newEndpoint,g=jsPlumb.CurrentLibrary,v=g.getAttribute,i=g.getElementObject,z=g.getDOMElement,f=jsPlumbUtil,o=g.getOffset;this.connector=null;this.idPrefix="_jsplumb_c_";this.defaultLabelLocation=0.5;this.defaultOverlayKeys=["Overlays","ConnectionOverlays"];this.parent=x.parent;this.previousConnection=x.previousConnection;this.source=z(x.source);this.target=z(x.target);if(x.sourceEndpoint){this.source=x.sourceEndpoint.endpointWillMoveTo||x.sourceEndpoint.getElement()}if(x.targetEndpoint){this.target=x.targetEndpoint.getElement()}OverlayCapableJsPlumbUIComponent.apply(this,arguments);this.sourceId=this._jsPlumb.instance.getId(this.source);this.targetId=this._jsPlumb.instance.getId(this.target);this.scope=x.scope;this.endpoints=[];this.endpointStyles=[];var y=this._jsPlumb.instance;this._jsPlumb.visible=true;this._jsPlumb.editable=x.editable===true;this._jsPlumb.params={parent:x.parent,cssClass:x.cssClass,container:x.container,"pointer-events":x["pointer-events"],editorParams:x.editorParams};this._jsPlumb.lastPaintedAt=null;this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}};var q=b(y,t,this,x.sourceEndpoint,0,x,this.source,this.sourceId,x.paintStyle,x.hoverPaintStyle);if(q){f.addToList(x.endpointsByElement,this.sourceId,q)}var p=b(y,t,this,x.targetEndpoint,1,x,this.target,this.targetId,x.paintStyle,x.hoverPaintStyle);if(p){f.addToList(x.endpointsByElement,this.targetId,p)}if(!this.scope){this.scope=this.endpoints[0].scope}if(x.deleteEndpointsOnDetach!=null){this.endpoints[0]._deleteOnDetach=x.deleteEndpointsOnDetach;this.endpoints[1]._deleteOnDetach=x.deleteEndpointsOnDetach}else{if(!this.endpoints[0]._doNotDeleteOnDetach){this.endpoints[0]._deleteOnDetach=true}if(!this.endpoints[1]._doNotDeleteOnDetach){this.endpoints[1]._deleteOnDetach=true}}this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||x.connector||y.Defaults.Connector||jsPlumb.Defaults.Connector,true);if(x.path){this.connector.setPath(x.path)}this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||x.paintStyle||y.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,true);this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||x.hoverPaintStyle||y.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,true);this._jsPlumb.paintStyleInUse=this.getPaintStyle();var h=y.getSuspendedAt();y.updateOffset({elId:this.sourceId,timestamp:h});y.updateOffset({elId:this.targetId,timestamp:h});if(!y.isSuspendDrawing()){var e=y.getCachedData(this.sourceId),l=e.o,k=e.s,w=y.getCachedData(this.targetId),d=w.o,m=w.s,n=h||y.timestamp(),r=this.endpoints[0].anchor.compute({xy:[l.left,l.top],wh:k,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[d.left,d.top],twh:m,tElement:this.endpoints[1],timestamp:n});this.endpoints[0].paint({anchorLoc:r,timestamp:n});r=this.endpoints[1].anchor.compute({xy:[d.left,d.top],wh:m,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[l.left,l.top],twh:k,tElement:this.endpoints[0],timestamp:n});this.endpoints[1].paint({anchorLoc:r,timestamp:n})}this._jsPlumb.detachable=y.Defaults.ConnectionsDetachable;if(x.detachable===false){this._jsPlumb.detachable=false}if(this.endpoints[0].connectionsDetachable===false){this._jsPlumb.detachable=false}if(this.endpoints[1].connectionsDetachable===false){this._jsPlumb.detachable=false}this._jsPlumb.reattach=x.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||y.Defaults.ReattachConnections;this._jsPlumb.cost=x.cost||this.endpoints[0].getConnectionCost();this._jsPlumb.directed=x.directed;if(x.directed==null){this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected()}var A=jsPlumb.extend({},this.endpoints[0].getParameters());jsPlumb.extend(A,this.endpoints[1].getParameters());jsPlumb.extend(A,this.getParameters());this.setParameters(A);var u=x.type||this.endpoints[0].connectionType||this.endpoints[1].connectionType;if(u){this.addType(u,x.data,y.isSuspendDrawing())}};jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(d,e){if(d.detachable!=null){this.setDetachable(d.detachable)}if(d.reattach!=null){this.setReattach(d.reattach)}if(d.scope){this.scope=d.scope}this.setConnector(d.connector,e)},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(e,d){if(d){this.endpoints[0].addClass(e);this.endpoints[1].addClass(e);if(this.suspendedEndpoint){this.suspendedEndpoint.addClass(e)}}if(this.connector){this.connector.addClass(e)}},removeClass:function(e,d){if(d){this.endpoints[0].removeClass(e);this.endpoints[1].removeClass(e);if(this.suspendedEndpoint){this.suspendedEndpoint.removeClass(e)}}if(this.connector){this.connector.removeClass(e)}},isVisible:function(){return this._jsPlumb.visible},setVisible:function(d){this._jsPlumb.visible=d;this[d?"showOverlays":"hideOverlays"]();if(this.connector&&this.connector.canvas){this.connector.canvas.style.display=d?"block":"none"}this.repaint()},setEditable:function(d){if(this.connector&&this.connector.isEditable()){this._jsPlumb.editable=d}return this._jsPlumb.editable},isEditable:function(){return this._jsPlumb.editable},editStarted:function(){this.setSuspendEvents(true);this.fire("editStarted",{path:this.connector.getPath()});this._jsPlumb.instance.setHoverSuspended(true)},editCompleted:function(){this.fire("editCompleted",{path:this.connector.getPath()});this.setSuspendEvents(false);this.setHover(false);this._jsPlumb.instance.setHoverSuspended(false)},editCanceled:function(){this.fire("editCanceled",{path:this.connector.getPath()});this.setHover(false);this._jsPlumb.instance.setHoverSuspended(false)},cleanup:function(){this.endpoints=null;this.source=null;this.target=null;if(this.connector!=null){this.connector.cleanup();this.connector.destroy()}this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===true},setDetachable:function(d){this._jsPlumb.detachable=d===true},isReattach:function(){return this._jsPlumb.reattach===true},setReattach:function(d){this._jsPlumb.reattach=d===true},setHover:function(d){if(this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()){this.connector.setHover(d);jsPlumb.CurrentLibrary[d?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass);jsPlumb.CurrentLibrary[d?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass)}},getCost:function(){return this._jsPlumb.cost},setCost:function(d){this._jsPlumb.cost=d},isDirected:function(){return this._jsPlumb.directed===true},moveParent:function(g){var f=jsPlumb.CurrentLibrary,e=f.getParent(this.connector.canvas);if(this.connector.bgCanvas){f.removeElement(this.connector.bgCanvas);f.appendElement(this.connector.bgCanvas,g)}f.removeElement(this.connector.canvas);f.appendElement(this.connector.canvas,g);for(var d=0;d<this._jsPlumb.overlays.length;d++){if(this._jsPlumb.overlays[d].isAppendedAtTopLevel){f.removeElement(this._jsPlumb.overlays[d].canvas);f.appendElement(this._jsPlumb.overlays[d].canvas,g);if(this._jsPlumb.overlays[d].reattachListeners){this._jsPlumb.overlays[d].reattachListeners(this.connector)}}}if(this.connector.reattachListeners){this.connector.reattachListeners()}},getConnector:function(){return this.connector},setConnector:function(g,e){var d=jsPlumbUtil;if(this.connector!=null){this.connector.cleanup();this.connector.destroy()}var h={_jsPlumb:this._jsPlumb.instance,parent:this._jsPlumb.params.parent,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},f=this._jsPlumb.instance.getRenderMode();if(d.isString(g)){this.connector=c(this._jsPlumb.instance,f,g,h)}else{if(d.isArray(g)){if(g.length==1){this.connector=c(this._jsPlumb.instance,f,g[0],h)}else{this.connector=c(this._jsPlumb.instance,f,g[0],d.merge(g[1],h))}}}this.bindListeners(this.connector,this,function(i){this.setHover(i,false)}.bind(this));this.canvas=this.connector.canvas;if(this._jsPlumb.editable&&jsPlumb.ConnectorEditors!=null&&jsPlumb.ConnectorEditors[this.connector.type]&&this.connector.isEditable()){new jsPlumb.ConnectorEditors[this.connector.type]({connector:this.connector,connection:this,params:this._jsPlumb.params.editorParams||{}})}else{editable=false}if(!e){this.repaint()}},paint:function(B){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){B=B||{};var q=B.elId,r=B.ui,l=B.recalc,f=B.timestamp,s=false,A=s?this.sourceId:this.targetId,k=s?this.targetId:this.sourceId,g=s?0:1,D=s?1:0;if(f==null||f!=this._jsPlumb.lastPaintedAt){var E=this._jsPlumb.instance.updateOffset({elId:k,offset:r,recalc:l,timestamp:f}).o,m=this._jsPlumb.instance.updateOffset({elId:A,timestamp:f}).o,v=this.endpoints[D],e=this.endpoints[g];if(B.clearEdits){v.anchor.clearUserDefinedLocation();e.anchor.clearUserDefinedLocation();this.connector.setEdited(false)}var h=v.anchor.getCurrentLocation({xy:[E.left,E.top],wh:[E.width,E.height],element:v,timestamp:f}),z=e.anchor.getCurrentLocation({xy:[m.left,m.top],wh:[m.width,m.height],element:e,timestamp:f});this.connector.resetBounds();this.connector.compute({sourcePos:h,targetPos:z,sourceEndpoint:this.endpoints[D],targetEndpoint:this.endpoints[g],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:E,targetInfo:m,clearEdits:B.clearEdits===true});var n={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity};for(var y=0;y<this._jsPlumb.overlays.length;y++){var u=this._jsPlumb.overlays[y];if(u.isVisible()){this._jsPlumb.overlayPlacements[y]=u.draw(this.connector,this._jsPlumb.paintStyleInUse);n.minX=Math.min(n.minX,this._jsPlumb.overlayPlacements[y].minX);n.maxX=Math.max(n.maxX,this._jsPlumb.overlayPlacements[y].maxX);n.minY=Math.min(n.minY,this._jsPlumb.overlayPlacements[y].minY);n.maxY=Math.max(n.maxY,this._jsPlumb.overlayPlacements[y].maxY)}}var d=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,C=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),x={xmin:Math.min(this.connector.bounds.minX-(d+C),n.minX),ymin:Math.min(this.connector.bounds.minY-(d+C),n.minY),xmax:Math.max(this.connector.bounds.maxX+(d+C),n.maxX),ymax:Math.max(this.connector.bounds.maxY+(d+C),n.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,x);for(var w=0;w<this._jsPlumb.overlays.length;w++){var t=this._jsPlumb.overlays[w];if(t.isVisible()){t.paint(this._jsPlumb.overlayPlacements[w],x)}}}this._jsPlumb.lastPaintedAt=f}},repaint:function(d){d=d||{};this.paint({elId:this.sourceId,recalc:!(d.recalc===false),timestamp:d.timestamp,clearEdits:d.clearEdits})}})})();(function(){jsPlumb.AnchorManager=function(x){var f={},s={},v={},n={},z={},w={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},h={},p=this,i={},q=x.jsPlumbInstance,g=jsPlumb.CurrentLibrary,o={},l=function(L,M,H,D,I,B){if(L===M){return{orientation:w.IDENTITY,a:["top","top"]}}var C=Math.atan2((D.centery-H.centery),(D.centerx-H.centerx)),G=Math.atan2((H.centery-D.centery),(H.centerx-D.centerx)),F=((H.left<=D.left&&H.right>=D.left)||(H.left<=D.right&&H.right>=D.right)||(H.left<=D.left&&H.right>=D.right)||(D.left<=H.left&&D.right>=H.right)),K=((H.top<=D.top&&H.bottom>=D.top)||(H.top<=D.bottom&&H.bottom>=D.bottom)||(H.top<=D.top&&H.bottom>=D.bottom)||(D.top<=H.top&&D.bottom>=H.bottom)),J=function(N){return[I.isContinuous?I.verifyEdge(N[0]):N[0],B.isContinuous?B.verifyEdge(N[1]):N[1]]},E={orientation:w.DIAGONAL,theta:C,theta2:G};if(!(F||K)){if(D.left>H.left&&D.top>H.top){E.a=["right","top"]}else{if(D.left>H.left&&H.top>D.top){E.a=["top","left"]}else{if(D.left<H.left&&D.top<H.top){E.a=["top","right"]}else{if(D.left<H.left&&D.top>H.top){E.a=["left","top"]}}}}}else{if(F){E.orientation=w.HORIZONTAL;E.a=H.top<D.top?["bottom","top"]:["top","bottom"]}else{E.orientation=w.VERTICAL;E.a=H.left<D.left?["right","left"]:["left","right"]}}E.a=J(E.a);return E},A=function(P,L,J,K,Q,M,D){var R=[],C=L[Q?0:1]/(K.length+1);for(var N=0;N<K.length;N++){var S=(N+1)*C,B=M*L[Q?1:0];if(D){S=L[Q?0:1]-S}var I=(Q?S:B),F=J[0]+I,H=I/L[0],G=(Q?B:S),E=J[1]+G,O=G/L[1];R.push([F,E,H,O,K[N][1],K[N][2]])}return R},y=function(B){return function(D,C){var E=true;if(B){E=D[0][0]<C[0][0]}else{E=D[0][0]>C[0][0]}return E===false?-1:1}},d=function(C,B){var E=C[0][0]<0?-Math.PI-C[0][0]:Math.PI-C[0][0],D=B[0][0]<0?-Math.PI-B[0][0]:Math.PI-B[0][0];if(E>D){return 1}else{return C[0][1]>B[0][1]?1:-1}},t={top:function(C,B){return C[0]>B[0]?1:-1},right:y(true),bottom:y(true),left:d},r=function(B,C){return B.sort(C)},k=function(C,B){var G=q.getCachedData(C),E=G.s,F=G.o,D=function(N,U,J,M,S,R,I){if(M.length>0){var Q=r(M,t[N]),O=N==="right"||N==="top",H=A(N,U,J,Q,S,R,O);var V=function(Y,X){var W=q.adjustForParentOffsetAndScroll([X[0],X[1]],Y.canvas);v[Y.id]=[W[0],W[1],X[2],X[3]];z[Y.id]=I};for(var K=0;K<H.length;K++){var P=H[K][4],T=P.endpoints[0].elementId===C,L=P.endpoints[1].elementId===C;if(T){V(P.endpoints[0],H[K])}else{if(L){V(P.endpoints[1],H[K])}}}}};D("bottom",E,[F.left,F.top],B.bottom,true,1,[0,1]);D("top",E,[F.left,F.top],B.top,true,0,[0,-1]);D("left",E,[F.left,F.top],B.left,false,0,[-1,0]);D("right",E,[F.left,F.top],B.right,false,1,[1,0])};this.reset=function(){f={};h={};i={}};this.addFloatingConnection=function(B,C){o[B]=C};this.removeFloatingConnection=function(B){delete o[B]};this.newConnection=function(E){var G=E.sourceId,D=E.targetId,B=E.endpoints,F=true,C=function(H,I,K,J,L){if((G==D)&&K.isContinuous){g.removeElement(B[1].canvas);F=false}jsPlumbUtil.addToList(h,J,[L,I,K.constructor==jsPlumb.DynamicAnchor])};C(0,B[0],B[0].anchor,D,E);if(F){C(1,B[1],B[1].anchor,G,E)}};var e=function(B){(function(E,C){if(E){var D=function(F){return F[4]==C};jsPlumbUtil.removeWithFunction(E.top,D);jsPlumbUtil.removeWithFunction(E.left,D);jsPlumbUtil.removeWithFunction(E.bottom,D);jsPlumbUtil.removeWithFunction(E.right,D)}})(i[B.elementId],B.id)};this.connectionDetached=function(G){var C=G.connection||G,F=G.sourceId,D=G.targetId,B=C.endpoints,E=function(H,I,K,J,L){if(K!=null&&K.constructor==jsPlumb.FloatingAnchor){}else{jsPlumbUtil.removeWithFunction(h[J],function(M){return M[0].id==L.id})}};E(1,B[1],B[1].anchor,F,C);E(0,B[0],B[0].anchor,D,C);e(C.endpoints[0]);e(C.endpoints[1]);p.redraw(C.sourceId);p.redraw(C.targetId)};this.add=function(C,B){jsPlumbUtil.addToList(f,B,C)};this.changeId=function(C,B){h[B]=h[C];f[B]=f[C];delete h[C];delete f[C]};this.getConnectionsFor=function(B){return h[B]||[]};this.getEndpointsFor=function(B){return f[B]||[]};this.deleteEndpoint=function(B){jsPlumbUtil.removeWithFunction(f[B.elementId],function(C){return C.id==B.id});e(B)};this.clearFor=function(B){delete f[B];f[B]=[]};var m=function(V,I,Q,F,L,M,O,K,X,N,E,U){var S=-1,D=-1,G=F.endpoints[O],P=G.id,J=[1,0][O],B=[[I,Q],F,L,M,P],C=V[X],W=G._continuousAnchorEdge?V[G._continuousAnchorEdge]:null;if(W){var T=jsPlumbUtil.findWithFunction(W,function(Y){return Y[4]==P});if(T!=-1){W.splice(T,1);for(var R=0;R<W.length;R++){jsPlumbUtil.addWithFunction(E,W[R][1],function(Y){return Y.id==W[R][1].id});jsPlumbUtil.addWithFunction(U,W[R][1].endpoints[O],function(Y){return Y.id==W[R][1].endpoints[O].id});jsPlumbUtil.addWithFunction(U,W[R][1].endpoints[J],function(Y){return Y.id==W[R][1].endpoints[J].id})}}}for(R=0;R<C.length;R++){if(x.idx==1&&C[R][3]===M&&D==-1){D=R}jsPlumbUtil.addWithFunction(E,C[R][1],function(Y){return Y.id==C[R][1].id});jsPlumbUtil.addWithFunction(U,C[R][1].endpoints[O],function(Y){return Y.id==C[R][1].endpoints[O].id});jsPlumbUtil.addWithFunction(U,C[R][1].endpoints[J],function(Y){return Y.id==C[R][1].endpoints[J].id})}if(S!=-1){C[S]=B}else{var H=K?D!=-1?D:0:C.length;C.splice(H,0,B)}G._continuousAnchorEdge=X};this.updateOtherEndpoint=function(C,F,G,B){var E=jsPlumbUtil.findWithFunction(h[C],function(H){return H[0].id===B.id}),D=jsPlumbUtil.findWithFunction(h[F],function(H){return H[0].id===B.id});if(E!=-1){h[C][E][0]=B;h[C][E][1]=B.endpoints[1];h[C][E][2]=B.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor}if(D>-1){h[F].splice(D,1);jsPlumbUtil.addToList(h,G,[B,B.endpoints[0],B.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor])}};this.sourceChanged=function(C,E,D){jsPlumbUtil.removeWithFunction(h[C],function(F){return F[0].id===D.id});var B=jsPlumbUtil.findWithFunction(h[D.targetId],function(F){return F[0].id===D.id});if(B>-1){h[D.targetId][B][0]=D;h[D.targetId][B][1]=D.endpoints[0];h[D.targetId][B][2]=D.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor}jsPlumbUtil.addToList(h,E,[D,D.endpoints[1],D.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])};this.rehomeEndpoint=function(E,C,H){var D=f[C]||[],F=q.getId(H);if(F!==C){var B=jsPlumbUtil.indexOf(D,E);if(B>-1){var I=D.splice(B,1)[0];p.add(I,F)}}for(var G=0;G<E.connections.length;G++){if(E.connections[G].sourceId==C){E.connections[G].sourceId=E.elementId;E.connections[G].source=E.element;p.sourceChanged(C,E.elementId,E.connections[G])}else{if(E.connections[G].targetId==C){E.connections[G].targetId=E.elementId;E.connections[G].target=E.element;p.updateOtherEndpoint(E.connections[G].sourceId,C,E.elementId,E.connections[G])}}}};this.redraw=function(P,T,D,G,Y,R){if(!q.isSuspendDrawing()){var ad=f[P]||[],ac=h[P]||[],C=[],ab=[],E=[];D=D||q.timestamp();G=G||{left:0,top:0};if(T){T={left:T.left+G.left,top:T.top+G.top}}var K=q.updateOffset({elId:P,offset:T,recalc:false,timestamp:D}),M={};for(var Z=0;Z<ac.length;Z++){var H=ac[Z][0],J=H.sourceId,F=H.targetId,I=H.endpoints[0].anchor.isContinuous,O=H.endpoints[1].anchor.isContinuous;if(I||O){var aa=J+"_"+F,W=F+"_"+J,V=M[aa],N=H.sourceId==P?1:0;if(I&&!i[J]){i[J]={top:[],right:[],bottom:[],left:[]}}if(O&&!i[F]){i[F]={top:[],right:[],bottom:[],left:[]}}if(P!=F){q.updateOffset({elId:F,timestamp:D})}if(P!=J){q.updateOffset({elId:J,timestamp:D})}var L=q.getCachedData(F),B=q.getCachedData(J);if(F==J&&(I||O)){m(i[J],-Math.PI/2,0,H,false,F,0,false,"top",J,C,ab)}else{if(!V){V=l(J,F,B.o,L.o,H.endpoints[0].anchor,H.endpoints[1].anchor);M[aa]=V}if(I){m(i[J],V.theta,0,H,false,F,0,false,V.a[0],J,C,ab)}if(O){m(i[F],V.theta2,-1,H,true,J,1,true,V.a[1],F,C,ab)}}if(I){jsPlumbUtil.addWithFunction(E,J,function(ae){return ae===J})}if(O){jsPlumbUtil.addWithFunction(E,F,function(ae){return ae===F})}jsPlumbUtil.addWithFunction(C,H,function(ae){return ae.id==H.id});if((I&&N===0)||(O&&N===1)){jsPlumbUtil.addWithFunction(ab,H.endpoints[N],function(ae){return ae.id==H.endpoints[N].id})}}}for(Z=0;Z<ad.length;Z++){if(ad[Z].connections.length===0&&ad[Z].anchor.isContinuous){if(!i[P]){i[P]={top:[],right:[],bottom:[],left:[]}}m(i[P],-Math.PI/2,0,{endpoints:[ad[Z],ad[Z]],paint:function(){}},false,P,0,false,"top",P,C,ab);jsPlumbUtil.addWithFunction(E,P,function(ae){return ae===P})}}for(Z=0;Z<E.length;Z++){k(E[Z],i[E[Z]])}for(Z=0;Z<ad.length;Z++){ad[Z].paint({timestamp:D,offset:K,dimensions:K.s,recalc:R!==true})}for(Z=0;Z<ab.length;Z++){var S=q.getCachedData(ab[Z].elementId);ab[Z].paint({timestamp:D,offset:S,dimensions:S.s})}for(Z=0;Z<ac.length;Z++){var Q=ac[Z][1];if(Q.anchor.constructor==jsPlumb.DynamicAnchor){Q.paint({elementWithPrecedence:P,timestamp:D});jsPlumbUtil.addWithFunction(C,ac[Z][0],function(ae){return ae.id==ac[Z][0].id});for(var X=0;X<Q.connections.length;X++){if(Q.connections[X]!==ac[Z][0]){jsPlumbUtil.addWithFunction(C,Q.connections[X],function(ae){return ae.id==Q.connections[X].id})}}}else{if(Q.anchor.constructor==jsPlumb.Anchor){jsPlumbUtil.addWithFunction(C,ac[Z][0],function(ae){return ae.id==ac[Z][0].id})}}}var U=o[P];if(U){U.paint({timestamp:D,recalc:false,elId:P})}for(Z=0;Z<C.length;Z++){C[Z].paint({elId:P,timestamp:D,recalc:false,clearEdits:Y})}}};var u=function(D){jsPlumbUtil.EventGenerator.apply(this);this.type="Continuous";this.isDynamic=true;this.isContinuous=true;var G=D.faces||["top","right","bottom","left"],C=!(D.clockwise===false),L={},J={top:"bottom",right:"left",left:"right",bottom:"top"},F={top:"right",right:"bottom",left:"top",bottom:"left"},H={top:"left",right:"top",left:"bottom",bottom:"right"},E=C?F:H,B=C?H:F,K=D.cssClass||"";for(var I=0;I<G.length;I++){L[G[I]]=true}this.verifyEdge=function(M){if(L[M]){return M}else{if(L[J[M]]){return J[M]}else{if(L[E[M]]){return E[M]}else{if(L[B[M]]){return B[M]}}}}return M};this.compute=function(M){return n[M.element.id]||v[M.element.id]||[0,0]};this.getCurrentLocation=function(M){return n[M.element.id]||v[M.element.id]||[0,0]};this.getOrientation=function(M){return z[M.id]||[0,0]};this.clearUserDefinedLocation=function(){delete n[D.elementId]};this.setUserDefinedLocation=function(M){n[D.elementId]=M};this.getCssClass=function(){return K};this.setCssClass=function(M){K=M}};q.continuousAnchorFactory={get:function(C){var B=s[C.elementId];if(!B){B=new u(C);s[C.elementId]=B}return B},clear:function(B){delete s[B]}}};jsPlumb.Anchor=function(e){this.x=e.x||0;this.y=e.y||0;this.elementId=e.elementId;this.cssClass=e.cssClass||"";this.userDefinedLocation=null;this.orientation=e.orientation||[0,0];jsPlumbUtil.EventGenerator.apply(this);var d=e.jsPlumbInstance;this.lastReturnValue=null;this.offsets=e.offsets||[0,0];this.timestamp=null;this.compute=function(k){var i=k.xy,f=k.wh,g=k.element,h=k.timestamp;if(k.clearUserDefinedLocation){this.userDefinedLocation=null}if(h&&h===self.timestamp){return this.lastReturnValue}if(this.userDefinedLocation!=null){this.lastReturnValue=this.userDefinedLocation}else{this.lastReturnValue=[i[0]+(this.x*f[0])+this.offsets[0],i[1]+(this.y*f[1])+this.offsets[1]];this.lastReturnValue=d.adjustForParentOffsetAndScroll(this.lastReturnValue,g.canvas)}this.timestamp=h;return this.lastReturnValue};this.getCurrentLocation=function(f){return(this.lastReturnValue==null||(f.timestamp!=null&&this.timestamp!=f.timestamp))?this.compute(f):this.lastReturnValue}};jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(d){if(!d){return false}var e=d.getOrientation(),f=this.getOrientation();return this.x==d.x&&this.y==d.y&&this.offsets[0]==d.offsets[0]&&this.offsets[1]==d.offsets[1]&&f[0]==e[0]&&f[1]==e[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(d){this.userDefinedLocation=d},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(d){return this.orientation},getCssClass:function(){return this.cssClass}});jsPlumb.FloatingAnchor=function(f){jsPlumb.Anchor.apply(this,arguments);var e=f.reference,g=jsPlumb.CurrentLibrary,i=f.jsPlumbInstance,k=f.referenceCanvas,m=g.getSize(g.getElementObject(k)),n=0,h=0,d=null,l=null;this.orientation=null;this.x=0;this.y=0;this.isFloating=true;this.compute=function(r){var q=r.xy,p=r.element,o=[q[0]+(m[0]/2),q[1]+(m[1]/2)];o=i.adjustForParentOffsetAndScroll(o,p.canvas);l=o;return o};this.getOrientation=function(q){if(d){return d}else{var p=e.getOrientation(q);return[Math.abs(p[0])*n*-1,Math.abs(p[1])*h*-1]}};this.over=function(o,p){d=o.getOrientation(p)};this.out=function(){d=null};this.getCurrentLocation=function(o){return l==null?this.compute(o):l}};jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);var c=function(f,e,d){return f.constructor==jsPlumb.Anchor?f:e.makeAnchor(f,d,e)};jsPlumb.DynamicAnchor=function(l){jsPlumb.Anchor.apply(this,arguments);this.isSelective=true;this.isDynamic=true;this.anchors=[];this.elementId=l.elementId;this.jsPlumbInstance=l.jsPlumbInstance;for(var g=0;g<l.anchors.length;g++){this.anchors[g]=c(l.anchors[g],this.jsPlumbInstance,this.elementId)}this.addAnchor=function(i){this.anchors.push(c(i,this.jsPlumbInstance,this.elementId))};this.getAnchors=function(){return this.anchors};this.locked=false;var f=this.anchors.length>0?this.anchors[0]:null,h=this.anchors.length>0?0:-1,k=f,e=this,d=function(s,p,o,t,n){var i=t[0]+(s.x*n[0]),u=t[1]+(s.y*n[1]),r=t[0]+(n[0]/2),q=t[1]+(n[1]/2);return(Math.sqrt(Math.pow(p-i,2)+Math.pow(o-u,2))+Math.sqrt(Math.pow(r-i,2)+Math.pow(q-u,2)))},m=l.selector||function(x,o,p,q,n){var s=p[0]+(q[0]/2),r=p[1]+(q[1]/2);var u=-1,w=Infinity;for(var t=0;t<n.length;t++){var v=d(n[t],s,r,x,o);if(v<w){u=t+0;w=v}}return n[u]};this.compute=function(r){var q=r.xy,i=r.wh,o=r.timestamp,n=r.txy,s=r.twh;if(r.clearUserDefinedLocation){userDefinedLocation=null}this.timestamp=o;var p=e.getUserDefinedLocation();if(p!=null){return p}if(this.locked||n==null||s==null){return f.compute(r)}else{r.timestamp=null}f=m(q,i,n,s,this.anchors);this.x=f.x;this.y=f.y;if(f!=k){this.fire("anchorChanged",f)}k=f;return f.compute(r)};this.getCurrentLocation=function(i){return this.getUserDefinedLocation()||(f!=null?f.getCurrentLocation(i):null)};this.getOrientation=function(i){return f!=null?f.getOrientation(i):[0,0]};this.over=function(i,n){if(f!=null){f.over(i,n)}};this.out=function(){if(f!=null){f.out()}};this.getCssClass=function(){return(f&&f.getCssClass())||""}};jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);var b=function(d,i,f,e,h,g){jsPlumb.Anchors[h]=function(l){var k=l.jsPlumbInstance.makeAnchor([d,i,f,e,0,0],l.elementId,l.jsPlumbInstance);k.type=h;if(g){g(k,l)}return k}};b(0.5,0,0,-1,"TopCenter");b(0.5,1,0,1,"BottomCenter");b(0,0.5,-1,0,"LeftMiddle");b(1,0.5,1,0,"RightMiddle");b(0.5,0,0,-1,"Top");b(0.5,1,0,1,"Bottom");b(0,0.5,-1,0,"Left");b(1,0.5,1,0,"Right");b(0.5,0.5,0,0,"Center");b(1,0,0,-1,"TopRight");b(1,1,0,1,"BottomRight");b(0,0,0,-1,"TopLeft");b(0,1,0,1,"BottomLeft");jsPlumb.Defaults.DynamicAnchors=function(d){return d.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],d.elementId,d.jsPlumbInstance)};jsPlumb.Anchors.AutoDefault=function(e){var d=e.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(e));d.type="AutoDefault";return d};var a=function(e,d){jsPlumb.Anchors[e]=function(g){var f=g.jsPlumbInstance.makeAnchor(["Continuous",{faces:d}],g.elementId,g.jsPlumbInstance);f.type=e;return f}};jsPlumb.Anchors.Continuous=function(d){return d.jsPlumbInstance.continuousAnchorFactory.get(d)};a("ContinuousLeft",["left"]);a("ContinuousTop",["top"]);a("ContinuousBottom",["bottom"]);a("ContinuousRight",["right"]);jsPlumb.Anchors.Assign=b(0,0,0,0,"Assign",function(e,f){var d=f.position||"Fixed";e.positionFinder=d.constructor==String?f.jsPlumbInstance.AnchorPositionFinders[d]:d;e.constructorParams=f});jsPlumb.AnchorPositionFinders={Fixed:function(g,d,f,e){return[(g.left-d.left)/f[0],(g.top-d.top)/f[1]]},Grid:function(d,n,h,e){var m=d.left-n.left,l=d.top-n.top,k=h[0]/(e.grid[0]),i=h[1]/(e.grid[1]),g=Math.floor(m/k),f=Math.floor(l/i);return[((g*k)+(k/2))/h[0],((f*i)+(i/2))/h[1]]}};jsPlumb.Anchors.Perimeter=function(d){d=d||{};var e=d.anchorCount||60,h=d.shape;if(!h){throw new Error("no shape supplied to Perimeter Anchor type")}var f=function(){var u=0.5,t=Math.PI*2/e,v=0,q=[];for(var s=0;s<e;s++){var p=u+(u*Math.sin(v)),w=u+(u*Math.cos(v));q.push([p,w,0,0]);v+=t}return q},i=function(r){var t=e/r.length,p=[],q=function(x,A,w,z,B){t=e*B;var v=(w-x)/t,u=(z-A)/t;for(var y=0;y<t;y++){p.push([x+(v*y),A+(u*y),0,0])}};for(var s=0;s<r.length;s++){q.apply(null,r[s])}return p},m=function(p){var r=[];for(var q=0;q<p.length;q++){r.push([p[q][0],p[q][1],p[q][2],p[q][3],1/p.length])}return i(r)},k=function(){return m([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])};var g={Circle:f,Ellipse:f,Diamond:function(){return m([[0.5,0,1,0.5],[1,0.5,0.5,1],[0.5,1,0,0.5],[0,0.5,0.5,0]])},Rectangle:k,Square:k,Triangle:function(){return m([[0.5,0,1,1],[1,1,0,1],[0,1,0.5,0]])},Path:function(w){var u=w.points,v=[],r=0;for(var t=0;t<u.length-1;t++){var q=Math.sqrt(Math.pow(u[t][2]-u[t][0])+Math.pow(u[t][3]-u[t][1]));r+=q;v.push([u[t][0],u[t][1],u[t+1][0],u[t+1][1],q])}for(var s=0;s<v.length;s++){v[s][4]=v[s][4]/r}return i(v)}},n=function(u,t){var v=[],s=t/180*Math.PI;for(var r=0;r<u.length;r++){var q=u[r][0]-0.5,p=u[r][1]-0.5;v.push([0.5+((q*Math.cos(s))-(p*Math.sin(s))),0.5+((q*Math.sin(s))+(p*Math.cos(s))),u[r][2],u[r][3]])}return v};if(!g[h]){throw new Error("Shape ["+h+"] is unknown by Perimeter Anchor type")}var o=g[h](d);if(d.rotation){o=n(o,d.rotation)}var l=d.jsPlumbInstance.makeDynamicAnchor(o);l.type="Perimeter";return l}})();(function(){jsPlumb.DOMElementComponent=jsPlumbUtil.extend(jsPlumb.jsPlumbUIComponent,function(h){this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(i){}});jsPlumb.Segments={AbstractSegment:function(h){this.params=h;this.findClosestPointOnPath=function(i,k){return{d:Infinity,x:null,y:null,l:null}};this.getBounds=function(){return{minX:Math.min(h.x1,h.x2),minY:Math.min(h.y1,h.y2),maxX:Math.max(h.x1,h.x2),maxY:Math.max(h.y1,h.y2)}}},Straight:function(o){var r=jsPlumb.Segments.AbstractSegment.apply(this,arguments),l,n,s,k,i,q,p,h=function(){l=Math.sqrt(Math.pow(i-k,2)+Math.pow(p-q,2));n=jsPlumbUtil.gradient({x:k,y:q},{x:i,y:p});s=-1/n};this.type="Straight";this.getLength=function(){return l};this.getGradient=function(){return n};this.getCoordinates=function(){return{x1:k,y1:q,x2:i,y2:p}};this.setCoordinates=function(m){k=m.x1;q=m.y1;i=m.x2;p=m.y2;h()};this.setCoordinates({x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2});this.getBounds=function(){return{minX:Math.min(k,i),minY:Math.min(q,p),maxX:Math.max(k,i),maxY:Math.max(q,p)}};this.pointOnPath=function(t,u){if(t===0&&!u){return{x:k,y:q}}else{if(t==1&&!u){return{x:i,y:p}}else{var m=u?t>0?t:l+t:t*l;return jsPlumbUtil.pointOnLine({x:k,y:q},{x:i,y:p},m)}}};this.gradientAtPoint=function(m){return n};this.pointAlongPathFrom=function(m,w,v){var u=this.pointOnPath(m,v),t=w<=0?{x:k,y:q}:{x:i,y:p};if(w<=0&&Math.abs(w)>1){w*=-1}return jsPlumbUtil.pointOnLine(u,t,w)};this.findClosestPointOnPath=function(t,B){if(n===0){return{x:t,y:q,d:Math.abs(B-q)}}else{if(n==Infinity||n==-Infinity){return{x:k,y:B,d:Math.abs(t-1)}}else{var m=q-(n*k),u=B-(s*t),v=(u-m)/(n-s),A=(n*v)+m,z=jsPlumbUtil.lineLength([t,B],[v,A]),w=jsPlumbUtil.lineLength([v,A],[k,q]);return{d:z,x:v,y:A,l:w/l}}}}},Arc:function(m){var s=jsPlumb.Segments.AbstractSegment.apply(this,arguments),o=function(u,t){return jsPlumbUtil.theta([m.cx,m.cy],[u,t])},h=function(y,u){if(y.anticlockwise){var t=y.startAngle<y.endAngle?y.startAngle+l:y.startAngle,x=Math.abs(t-y.endAngle);return t-(x*u)}else{var w=y.endAngle<y.startAngle?y.endAngle+l:y.endAngle,v=Math.abs(w-y.startAngle);return y.startAngle+(v*u)}},l=2*Math.PI;this.radius=m.r;this.anticlockwise=m.ac;this.type="Arc";if(m.startAngle&&m.endAngle){this.startAngle=m.startAngle;this.endAngle=m.endAngle;this.x1=m.cx+(this.radius*Math.cos(m.startAngle));this.y1=m.cy+(this.radius*Math.sin(m.startAngle));this.x2=m.cx+(this.radius*Math.cos(m.endAngle));this.y2=m.cy+(this.radius*Math.sin(m.endAngle))}else{this.startAngle=o(m.x1,m.y1);this.endAngle=o(m.x2,m.y2);this.x1=m.x1;this.y1=m.y1;this.x2=m.x2;this.y2=m.y2}if(this.endAngle<0){this.endAngle+=l}if(this.startAngle<0){this.startAngle+=l}this.segment=jsPlumbUtil.segment([this.x1,this.y1],[this.x2,this.y2]);var p=this.endAngle<this.startAngle?this.endAngle+l:this.endAngle;this.sweep=Math.abs(p-this.startAngle);if(this.anticlockwise){this.sweep=l-this.sweep}var r=2*Math.PI*this.radius,i=this.sweep/l,k=r*i;this.getLength=function(){return k};this.getBounds=function(){return{minX:m.cx-m.r,maxX:m.cx+m.r,minY:m.cy-m.r,maxY:m.cy+m.r}};var n=1e-10,q=function(v){var u=Math.floor(v),t=Math.ceil(v);if(v-u<n){return u}else{if(t-v<n){return t}}return v};this.pointOnPath=function(t,x){if(t===0){return{x:this.x1,y:this.y1,theta:this.startAngle}}else{if(t==1){return{x:this.x2,y:this.y2,theta:this.endAngle}}}if(x){t=t/k}var w=h(this,t),v=m.cx+(m.r*Math.cos(w)),u=m.cy+(m.r*Math.sin(w));return{x:q(v),y:q(u),theta:w}};this.gradientAtPoint=function(u,w){var v=this.pointOnPath(u,w);var t=jsPlumbUtil.normal([m.cx,m.cy],[v.x,v.y]);if(!this.anticlockwise&&(t==Infinity||t==-Infinity)){t*=-1}return t};this.pointAlongPathFrom=function(B,t,A){var v=this.pointOnPath(B,A),u=t/r*2*Math.PI,w=this.anticlockwise?-1:1,z=v.theta+(w*u),y=m.cx+(this.radius*Math.cos(z)),x=m.cy+(this.radius*Math.sin(z));return{x:y,y:x}}},Bezier:function(m){var i=jsPlumb.Segments.AbstractSegment.apply(this,arguments),l=[{x:m.x1,y:m.y1},{x:m.cp1x,y:m.cp1y},{x:m.cp2x,y:m.cp2y},{x:m.x2,y:m.y2}],h={minX:Math.min(m.x1,m.x2,m.cp1x,m.cp2x),minY:Math.min(m.y1,m.y2,m.cp1y,m.cp2y),maxX:Math.max(m.x1,m.x2,m.cp1x,m.cp2x),maxY:Math.max(m.y1,m.y2,m.cp1y,m.cp2y)};this.type="Bezier";var k=function(o,n,p){if(p){n=jsBezier.locationAlongCurveFrom(o,n>0?0:1,n)}return n};this.pointOnPath=function(n,o){n=k(l,n,o);return jsBezier.pointOnCurve(l,n)};this.gradientAtPoint=function(n,o){n=k(l,n,o);return jsBezier.gradientAtPoint(l,n)};this.pointAlongPathFrom=function(n,p,o){n=k(l,n,o);return jsBezier.pointAlongCurveFrom(l,n,p)};this.getLength=function(){return jsBezier.getLength(l)};this.getBounds=function(){return h}}};var g=function(){this.resetBounds=function(){this.bounds={minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}};this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(B){g.apply(this,arguments);var z=[],i=false,s=0,k=[],v=[],h=B.stub||0,o=jsPlumbUtil.isArray(h)?h[0]:h,u=jsPlumbUtil.isArray(h)?h[1]:h,x=B.gap||0,p=jsPlumbUtil.isArray(x)?x[0]:x,r=jsPlumbUtil.isArray(x)?x[1]:x,q=null,l=false,n=null;this.isEditable=function(){return false};this.setEdited=function(D){l=D};this.getPath=function(){};this.setPath=function(D){};this.findSegmentForPoint=function(D,H){var E={d:Infinity,s:null,x:null,y:null,l:null};for(var F=0;F<z.length;F++){var G=z[F].findClosestPointOnPath(D,H);if(G.d<E.d){E.d=G.d;E.l=G.l;E.x=G.x;E.y=G.y;E.s=z[F]}}return E};var A=function(){var F=0;for(var E=0;E<z.length;E++){var D=z[E].getLength();v[E]=D/s;k[E]=[F,(F+=(D/s))]}},m=function(F,H){if(H){F=F>0?F/s:(s+F)/s}var D=k.length-1,E=1;for(var G=0;G<k.length;G++){if(k[G][1]>=F){D=G;E=F==1?1:F===0?0:(F-k[G][0])/v[G];break}}return{segment:z[D],proportion:E,index:D}},y=function(F,E,G){if(G.x1==G.x2&&G.y1==G.y2){return}var D=new jsPlumb.Segments[E](G);z.push(D);s+=D.getLength();F.updateBounds(D)},C=function(){s=0;z.splice(0,z.length);k.splice(0,k.length);v.splice(0,v.length)};this.setSegments=function(E){q=[];s=0;for(var D=0;D<E.length;D++){q.push(E[D]);s+=E[D].getLength()}};var t=function(T){this.lineWidth=T.lineWidth;var D=jsPlumbUtil.segment(T.sourcePos,T.targetPos),P=T.targetPos[0]<T.sourcePos[0],N=T.targetPos[1]<T.sourcePos[1],G=T.lineWidth||1,S=T.sourceEndpoint.anchor.orientation||T.sourceEndpoint.anchor.getOrientation(T.sourceEndpoint),E=T.targetEndpoint.anchor.orientation||T.targetEndpoint.anchor.getOrientation(T.targetEndpoint),J=P?T.targetPos[0]:T.sourcePos[0],I=N?T.targetPos[1]:T.sourcePos[1],L=Math.abs(T.targetPos[0]-T.sourcePos[0]),R=Math.abs(T.targetPos[1]-T.sourcePos[1]);if(S[0]===0&&S[1]===0||E[0]===0&&E[1]===0){var H=L>R?0:1,F=[1,0][H];S=[];E=[];S[H]=T.sourcePos[H]>T.targetPos[H]?-1:1;E[H]=T.sourcePos[H]>T.targetPos[H]?1:-1;S[F]=0;E[F]=0}var O=P?L+(p*S[0]):p*S[0],M=N?R+(p*S[1]):p*S[1],V=P?r*E[0]:L+(r*E[0]),U=N?r*E[1]:R+(r*E[1]),Q=((S[0]*E[0])+(S[1]*E[1]));var K={sx:O,sy:M,tx:V,ty:U,lw:G,xSpan:Math.abs(V-O),ySpan:Math.abs(U-M),mx:(O+V)/2,my:(M+U)/2,so:S,to:E,x:J,y:I,w:L,h:R,segment:D,startStubX:O+(S[0]*o),startStubY:M+(S[1]*o),endStubX:V+(E[0]*u),endStubY:U+(E[1]*u),isXGreaterThanStubTimes2:Math.abs(O-V)>(o+u),isYGreaterThanStubTimes2:Math.abs(M-U)>(o+u),opposite:Q==-1,perpendicular:Q===0,orthogonal:Q==1,sourceAxis:S[0]===0?"y":"x",points:[J,I,L,R,O,M,V,U]};K.anchorOrientation=K.opposite?"opposite":K.orthogonal?"orthogonal":"perpendicular";return K};this.getSegments=function(){return z};this.updateBounds=function(E){var D=E.getBounds();this.bounds.minX=Math.min(this.bounds.minX,D.minX);this.bounds.maxX=Math.max(this.bounds.maxX,D.maxX);this.bounds.minY=Math.min(this.bounds.minY,D.minY);this.bounds.maxY=Math.max(this.bounds.maxY,D.maxY)};var w=function(){console.log("SEGMENTS:");for(var D=0;D<z.length;D++){console.log(z[D].type,z[D].getLength(),k[D])}};this.pointOnPath=function(E,F){var D=m(E,F);return D.segment&&D.segment.pointOnPath(D.proportion,F)||[0,0]};this.gradientAtPoint=function(E){var D=m(E,absolute);return D.segment&&D.segment.gradientAtPoint(D.proportion,absolute)||0};this.pointAlongPathFrom=function(E,G,F){var D=m(E,F);return D.segment&&D.segment.pointAlongPathFrom(D.proportion,G,false)||[0,0]};this.compute=function(D){if(!l){n=t(D)}C();this._compute(n,D);this.x=n.points[0];this.y=n.points[1];this.w=n.points[2];this.h=n.points[3];this.segment=n.segment;A()};return{addSegment:y,prepareCompute:t,sourceStub:o,targetStub:u,maxStub:Math.max(o,u),sourceGap:p,targetGap:r,maxGap:Math.max(p,r)}};jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,g);var d=function(){this.type="Straight";var h=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(k,i){h.addSegment(this,"Straight",{x1:k.sx,y1:k.sy,x2:k.startStubX,y2:k.startStubY});h.addSegment(this,"Straight",{x1:k.startStubX,y1:k.startStubY,x2:k.endStubX,y2:k.endStubY});h.addSegment(this,"Straight",{x1:k.endStubX,y1:k.endStubY,x2:k.tx,y2:k.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(d,"Straight");var a=function(m){m=m||{};var k=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),l=m.stub||50,h=m.curviness||150,i=10;this.type="Bezier";this.getCurviness=function(){return h};this._findControlPoint=function(w,n,t,o,r){var u=o.anchor.getOrientation(o),v=r.anchor.getOrientation(r),s=u[0]!=v[0]||u[1]==v[1],q=[];if(!s){if(u[0]===0){q.push(n[0]<t[0]?w[0]+i:w[0]-i)}else{q.push(w[0]-(h*u[0]))}if(u[1]===0){q.push(n[1]<t[1]?w[1]+i:w[1]-i)}else{q.push(w[1]+(h*v[1]))}}else{if(v[0]===0){q.push(t[0]<n[0]?w[0]+i:w[0]-i)}else{q.push(w[0]+(h*v[0]))}if(v[1]===0){q.push(t[1]<n[1]?w[1]+i:w[1]-i)}else{q.push(w[1]+(h*u[1]))}}return q};this._compute=function(s,q){var r=q.sourcePos,x=q.targetPos,y=Math.abs(r[0]-x[0]),u=Math.abs(r[1]-x[1]),v=r[0]<x[0]?y:0,t=r[1]<x[1]?u:0,o=r[0]<x[0]?0:y,n=r[1]<x[1]?0:u,z=this._findControlPoint([v,t],r,x,q.sourceEndpoint,q.targetEndpoint),w=this._findControlPoint([o,n],x,r,q.targetEndpoint,q.sourceEndpoint);k.addSegment(this,"Bezier",{x1:v,y1:t,x2:o,y2:n,cp1x:z[0],cp1y:z[1],cp2x:w[0],cp2y:w[1]})}};jsPlumbUtil.extend(a,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(a,"Bezier");jsPlumb.Endpoints.AbstractEndpoint=function(i){g.apply(this,arguments);var h=this.compute=function(n,k,o,m){var l=this._compute.apply(this,arguments);this.x=l[0];this.y=l[1];this.w=l[2];this.h=l[3];this.bounds.minX=this.x;this.bounds.minY=this.y;this.bounds.maxX=this.x+this.w;this.bounds.maxY=this.y+this.h;return l};return{compute:h,cssClass:i.cssClass}};jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,g);jsPlumb.Endpoints.Dot=function(i){this.type="Dot";var h=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);i=i||{};this.radius=i.radius||10;this.defaultOffset=0.5*this.radius;this.defaultInnerRadius=this.radius/3;this._compute=function(r,k,l,n){this.radius=l.radius||this.radius;var q=r[0]-this.radius,p=r[1]-this.radius,s=this.radius*2,o=this.radius*2;if(l.strokeStyle){var m=l.lineWidth||1;q-=m;p-=m;s+=(m*2);o+=(m*2)}return[q,p,s,o,this.radius]}};jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint);jsPlumb.Endpoints.Rectangle=function(i){this.type="Rectangle";var h=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);i=i||{};this.width=i.width||20;this.height=i.height||20;this._compute=function(p,m,r,o){var n=r.width||this.width,l=r.height||this.height,k=p[0]-(n/2),q=p[1]-(l/2);return[k,q,n,l]}};jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);var c=function(h){jsPlumb.DOMElementComponent.apply(this,arguments);this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(c,jsPlumb.DOMElementComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(h){this._jsPlumb.displayElements.push(h)}});jsPlumb.Endpoints.Image=function(m){this.type="Image";c.apply(this,arguments);jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var h=m.onload,l=m.src||m.url,k=m.parent,i=m.cssClass?" "+m.cssClass:"";this._jsPlumb.img=new Image();this._jsPlumb.ready=false;this._jsPlumb.initialized=false;this._jsPlumb.deleted=false;this._jsPlumb.widthToUse=m.width;this._jsPlumb.heightToUse=m.height;this._jsPlumb.endpoint=m.endpoint;this._jsPlumb.img.onload=function(){if(this._jsPlumb!=null){this._jsPlumb.ready=true;this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width;this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height;if(h){h(this)}}}.bind(this);this._jsPlumb.endpoint.setImage=function(n,p){var o=n.constructor==String?n:n.src;h=p;this._jsPlumb.img.src=o;if(this.canvas!=null){this.canvas.setAttribute("src",this._jsPlumb.img.src)}}.bind(this);this._jsPlumb.endpoint.setImage(l,h);this._compute=function(p,n,q,o){this.anchorPoint=p;if(this._jsPlumb.ready){return[p[0]-this._jsPlumb.widthToUse/2,p[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]}else{return[0,0,0,0]}};this.canvas=document.createElement("img");this.canvas.style.margin=0;this.canvas.style.padding=0;this.canvas.style.outline=0;this.canvas.style.position="absolute";this.canvas.className=this._jsPlumb.instance.endpointClass+i;if(this._jsPlumb.widthToUse){this.canvas.setAttribute("width",this._jsPlumb.widthToUse)}if(this._jsPlumb.heightToUse){this.canvas.setAttribute("height",this._jsPlumb.heightToUse)}this._jsPlumb.instance.appendElement(this.canvas,k);this.attachListeners(this.canvas,this);this.actuallyPaint=function(q,p,o){if(!this._jsPlumb.deleted){if(!this._jsPlumb.initialized){this.canvas.setAttribute("src",this._jsPlumb.img.src);this.appendDisplayElement(this.canvas);this._jsPlumb.initialized=true}var n=this.anchorPoint[0]-(this._jsPlumb.widthToUse/2),r=this.anchorPoint[1]-(this._jsPlumb.heightToUse/2);jsPlumbUtil.sizeElement(this.canvas,n,r,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}};this.paint=function(o,n){if(this._jsPlumb!=null){if(this._jsPlumb.ready){this.actuallyPaint(o,n)}else{window.setTimeout(function(){this.paint(o,n)}.bind(this),200)}}}};jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[c,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=true;jsPlumbUtil.removeElement(this.canvas);this.canvas=null}});jsPlumb.Endpoints.Blank=function(i){var h=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank";c.apply(this,arguments);this._compute=function(m,k,n,l){return[m[0],m[1],10,0]};this.canvas=document.createElement("div");this.canvas.style.display="block";this.canvas.style.width="1px";this.canvas.style.height="1px";this.canvas.style.background="transparent";this.canvas.style.position="absolute";this.canvas.className=this._jsPlumb.endpointClass;jsPlumb.appendElement(this.canvas,i.parent);this.paint=function(l,k){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}};jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,c],{cleanup:function(){if(this.canvas){this.canvas.parentNode.removeChild(this.canvas)}}});jsPlumb.Endpoints.Triangle=function(i){this.type="Triangle";var h=jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);i=i||{};i.width=i.width||55;i.height=i.height||55;this.width=i.width;this.height=i.height;this._compute=function(p,m,r,o){var n=r.width||self.width,l=r.height||self.height,k=p[0]-(n/2),q=p[1]-(l/2);return[k,q,n,l]}};var f=jsPlumb.Overlays.AbstractOverlay=function(h){this.visible=true;this.isAppendedAtTopLevel=true;this.component=h.component;this.loc=h.location==null?0.5:h.location;this.endpointLoc=h.endpointLocation==null?[0.5,0.5]:h.endpointLocation};f.prototype={cleanup:function(){this.component=null;this.canvas=null;this.endpointLoc=null},setVisible:function(h){this.visible=h;this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},incrementLocation:function(h){this.loc+=h;this.component.repaint()},setLocation:function(h){this.loc=h;this.component.repaint()},getLocation:function(){return this.loc}};jsPlumb.Overlays.Arrow=function(m){this.type="Arrow";f.apply(this,arguments);this.isAppendedAtTopLevel=false;m=m||{};var h=jsPlumbUtil;this.length=m.length||20;this.width=m.width||20;this.id=m.id;var l=(m.direction||1)<0?-1:1,k=m.paintStyle||{lineWidth:1},i=m.foldback||0.623;this.computeMaxSize=function(){return self.width*1.5};this.draw=function(w,B){var s,y,o,t,r;if(w.pointAlongPathFrom){if(h.isString(this.loc)||this.loc>1||this.loc<0){var p=parseInt(this.loc,10);s=w.pointAlongPathFrom(p,l*this.length/2,true);y=w.pointOnPath(p,true);o=h.pointOnLine(s,y,this.length)}else{if(this.loc==1){s=w.pointOnPath(this.loc);y=w.pointAlongPathFrom(this.loc,-(this.length));o=h.pointOnLine(s,y,this.length);if(l==-1){var A=o;o=s;s=A}}else{if(this.loc===0){o=w.pointOnPath(this.loc);y=w.pointAlongPathFrom(this.loc,this.length);s=h.pointOnLine(o,y,this.length);if(l==-1){var x=o;o=s;s=x}}else{s=w.pointAlongPathFrom(this.loc,l*this.length/2);y=w.pointOnPath(this.loc);o=h.pointOnLine(s,y,this.length)}}}t=h.perpendicularLineTo(s,o,this.width);r=h.pointOnLine(s,o,i*this.length);var u={hxy:s,tail:t,cxy:r},v=k.strokeStyle||B.strokeStyle,z=k.fillStyle||B.strokeStyle,q=k.lineWidth||B.lineWidth,n={component:w,d:u,lineWidth:q,strokeStyle:v,fillStyle:z,minX:Math.min(s.x,t[0].x,t[1].x),maxX:Math.max(s.x,t[0].x,t[1].x),minY:Math.min(s.y,t[0].y,t[1].y),maxY:Math.max(s.y,t[0].y,t[1].y)};return n}else{return{component:w,minX:0,maxX:0,minY:0,maxY:0}}}};jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,f);jsPlumb.Overlays.PlainArrow=function(i){i=i||{};var h=jsPlumb.extend(i,{foldback:1});jsPlumb.Overlays.Arrow.call(this,h);this.type="PlainArrow"};jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow);jsPlumb.Overlays.Diamond=function(k){k=k||{};var h=k.length||40,i=jsPlumb.extend(k,{length:h/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,i);this.type="Diamond"};jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);var e=function(h){if(h._jsPlumb.cachedDimensions==null){h._jsPlumb.cachedDimensions=h.getDimensions()}return h._jsPlumb.cachedDimensions};var b=function(i){jsPlumb.DOMElementComponent.apply(this,arguments);f.apply(this,arguments);var h=jsPlumb.CurrentLibrary;this.id=i.id;this._jsPlumb.div=null;this._jsPlumb.initialised=false;this._jsPlumb.component=i.component;this._jsPlumb.cachedDimensions=null;this._jsPlumb.create=i.create;this.getElement=function(){if(this._jsPlumb.div==null){var l=this._jsPlumb.div=h.getDOMElement(this._jsPlumb.create(this._jsPlumb.component));l.style.position="absolute";var k=i._jsPlumb.overlayClass+" "+(this.cssClass?this.cssClass:i.cssClass?i.cssClass:"");l.className=k;this._jsPlumb.instance.appendElement(l,this._jsPlumb.component.parent);this._jsPlumb.instance.getId(l);this.attachListeners(l,this);this.canvas=l}return this._jsPlumb.div};this.draw=function(n,s){var k=e(this);if(k!=null&&k.length==2){var l={x:0,y:0};if(n.pointOnPath){var m=this.loc,o=false;if(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1){m=parseInt(this.loc,10);o=true}l=n.pointOnPath(m,o)}else{var q=this.loc.constructor==Array?this.loc:this.endpointLoc;l={x:q[0]*n.w,y:q[1]*n.h}}var r=l.x-(k[0]/2),p=l.y-(k[1]/2);return{component:n,d:{minx:r,miny:p,td:k,cxy:l},minX:r,maxX:r+k[0],minY:p,maxY:p+k[1]}}else{return{minX:0,maxX:0,minY:0,maxY:0}}}};jsPlumbUtil.extend(b,[jsPlumb.DOMElementComponent,f],{getDimensions:function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(this.getElement()))},setVisible:function(h){this._jsPlumb.div.style.display=h?"block":"none"},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){if(this._jsPlumb.div!=null){jsPlumb.CurrentLibrary.removeElement(this._jsPlumb.div)}},computeMaxSize:function(){var h=e(this);return Math.max(h[0],h[1])},reattachListeners:function(h){if(this._jsPlumb.div){this.reattachListenersForElement(this._jsPlumb.div,this,h)}},paint:function(i,h){if(!this._jsPlumb.initialised){this.getElement();i.component.appendDisplayElement(this._jsPlumb.div);this.attachListeners(this._jsPlumb.div,i.component);this._jsPlumb.initialised=true}this._jsPlumb.div.style.left=(i.component.x+i.d.minx)+"px";this._jsPlumb.div.style.top=(i.component.y+i.d.miny)+"px"}});jsPlumb.Overlays.Custom=function(h){this.type="Custom";b.apply(this,arguments)};jsPlumbUtil.extend(jsPlumb.Overlays.Custom,b);jsPlumb.Overlays.GuideLines=function(){var h=this;h.length=50;h.lineWidth=5;this.type="GuideLines";f.apply(this,arguments);jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.draw=function(k,p){var o=k.pointAlongPathFrom(h.loc,h.length/2),n=k.pointOnPath(h.loc),m=jsPlumbUtil.pointOnLine(o,n,h.length),l=jsPlumbUtil.perpendicularLineTo(o,m,40),i=jsPlumbUtil.perpendicularLineTo(m,o,20);return{connector:k,head:o,tail:m,headLine:i,tailLine:l,minX:Math.min(o.x,m.x,i[0].x,i[1].x),minY:Math.min(o.y,m.y,i[0].y,i[1].y),maxX:Math.max(o.x,m.x,i[0].x,i[1].x),maxY:Math.max(o.y,m.y,i[0].y,i[1].y)}}};jsPlumb.Overlays.Label=function(i){this.labelStyle=i.labelStyle||jsPlumb.Defaults.LabelStyle;this.cssClass=this.labelStyle!=null?this.labelStyle.cssClass:null;var h=jsPlumb.extend({create:function(){return document.createElement("div")}},i);jsPlumb.Overlays.Custom.call(this,h);this.type="Label";this.label=i.label||"";this.labelText=null};jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null;this.label=null;this.labelText=null;this.cssClass=null;this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(h){this.label=h;this.labelText=null;this.clearCachedDimensions();this.update();this.component.repaint()},getDimensions:function(){this.update();return b.prototype.getDimensions.apply(this,arguments)},update:function(){if(typeof this.label=="function"){var h=this.label(this);this.getElement().innerHTML=h.replace(/\r\n/g,"<br/>")}else{if(this.labelText==null){this.labelText=this.label;this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>")}}}})})();(function(){var a=function(u){this.type="Flowchart";u=u||{};u.stub=u.stub==null?30:u.stub;var l=this,t=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),d=u.midpoint==null?0.5:u.midpoint,s=[],q=[],c=u.grid,k=u.alwaysRespectStubs,g=null,p=null,o=null,m,f=u.cornerRadius!=null?u.cornerRadius:0,h=function(v){return v<0?-1:v===0?0:1},i=function(B,D,C,A){if(p==D&&o==C){return}var z=p==null?A.sx:p,w=o==null?A.sy:o,v=z==D?"v":"h",F=h(D-z),E=h(C-w);p=D;o=C;B.push([z,w,D,C,v,F,E])},r=function(v){return Math.sqrt(Math.pow(v[0]-v[2],2)+Math.pow(v[1]-v[3],2))},e=function(v){var w=[];w.push.apply(w,v);return w},b=function(v){l.bounds.minX=Math.min(l.bounds.minX,v[2]);l.bounds.maxX=Math.max(l.bounds.maxX,v[2]);l.bounds.minY=Math.min(l.bounds.minY,v[3]);l.bounds.maxY=Math.max(l.bounds.maxY,v[3])},n=function(w,B,v){var D,A;for(var z=0;z<B.length-1;z++){D=D||e(B[z]);A=e(B[z+1]);if(f>0&&D[4]!=A[4]){var H=Math.min(f,r(D),r(A));D[2]-=D[5]*H;D[3]-=D[6]*H;A[0]+=A[5]*H;A[1]+=A[6]*H;var I=(D[6]==A[5]&&A[5]==1)||((D[6]==A[5]&&A[5]===0)&&D[5]!=A[6])||(D[6]==A[5]&&A[5]==-1),E=A[1]>D[3]?1:-1,F=A[0]>D[2]?1:-1,C=E==F,y=(C&&I||(!C&&!I))?A[0]:D[2],x=(C&&I||(!C&&!I))?D[3]:A[1];t.addSegment(w,"Straight",{x1:D[0],y1:D[1],x2:D[2],y2:D[3]});t.addSegment(w,"Arc",{r:H,x1:D[2],y1:D[3],x2:A[0],y2:A[1],cx:y,cy:x,ac:I})}else{var J=(D[2]==D[0])?0:(D[2]>D[0])?(v.lw/2):-(v.lw/2),G=(D[3]==D[1])?0:(D[3]>D[1])?(v.lw/2):-(v.lw/2);t.addSegment(w,"Straight",{x1:D[0]-J,y1:D[1]-G,x2:D[2]+J,y2:D[3]+G})}D=A}t.addSegment(w,"Straight",{x1:A[0],y1:A[1],x2:A[2],y2:A[3]})};this.setSegments=function(v){g=v};this.isEditable=function(){return true};this.getOriginalSegments=function(){return g||q};this._compute=function(x,L){if(L.clearEdits){g=null}if(g!=null){n(this,g,x);return}q=[];p=null;o=null;m=null;var J=x.startStubX+((x.endStubX-x.startStubX)*d),H=x.startStubY+((x.endStubY-x.startStubY)*d);var F=function(Q,P,N,O){return Q+(P*((1-N)*O)+t.maxStub)},y={x:[0,1],y:[1,0]},B=function(N){return[x.startStubX,x.startStubY,x.endStubX,x.endStubY]},A={perpendicular:B,orthogonal:B,opposite:function(P){var Q=x,O=P=="x"?0:1,N={x:function(){return((Q.so[O]==1&&(((Q.startStubX>Q.endStubX)&&(Q.tx>Q.startStubX))||((Q.sx>Q.endStubX)&&(Q.tx>Q.sx)))))||((Q.so[O]==-1&&(((Q.startStubX<Q.endStubX)&&(Q.tx<Q.startStubX))||((Q.sx<Q.endStubX)&&(Q.tx<Q.sx)))))},y:function(){return((Q.so[O]==1&&(((Q.startStubY>Q.endStubY)&&(Q.ty>Q.startStubY))||((Q.sy>Q.endStubY)&&(Q.ty>Q.sy)))))||((Q.so[O]==-1&&(((Q.startStubY<Q.endStubY)&&(Q.ty<Q.startStubY))||((Q.sy<Q.endStubY)&&(Q.ty<Q.sy)))))}};if(!k&&N[P]()){return{x:[(x.sx+x.tx)/2,x.startStubY,(x.sx+x.tx)/2,x.endStubY],y:[x.startStubX,(x.sy+x.ty)/2,x.endStubX,(x.sy+x.ty)/2]}[P]}else{return[x.startStubX,x.startStubY,x.endStubX,x.endStubY]}}},I={perpendicular:function(P,Z,O,ag,T){var ae=x,af={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},ad={x:[[ae.startStubX,ae.endStubX],null,[ae.endStubX,ae.startStubX]],y:[[ae.startStubY,ae.endStubY],null,[ae.endStubY,ae.startStubY]]},X={x:[[J,ae.startStubY],[J,ae.endStubY]],y:[[ae.startStubX,H],[ae.endStubX,H]]},N={x:[[ae.endStubX,ae.startStubY]],y:[[ae.startStubX,ae.endStubY]]},W={x:[[ae.startStubX,ae.endStubY],[ae.endStubX,ae.endStubY]],y:[[ae.endStubX,ae.startStubY],[ae.endStubX,ae.endStubY]]},ac={x:[[ae.startStubX,H],[ae.endStubX,H],[ae.endStubX,ae.endStubY]],y:[[J,ae.startStubY],[J,ae.endStubY],[ae.endStubX,ae.endStubY]]},ab={x:[ae.startStubY,ae.endStubY],y:[ae.startStubX,ae.endStubX]},V=y[P][0],ah=y[P][1],U=ae.so[V]+1,Y=ae.to[ah]+1,Q=(ae.to[ah]==-1&&(ab[P][1]<ab[P][0]))||(ae.to[ah]==1&&(ab[P][1]>ab[P][0])),S=ad[P][U][0],R=ad[P][U][1],aa=af[P][U][Y];if(ae.segment==aa[3]||(ae.segment==aa[2]&&Q)){return X[P]}else{if(ae.segment==aa[2]&&R<S){return N[P]}else{if((ae.segment==aa[2]&&R>=S)||(ae.segment==aa[1]&&!Q)){return ac[P]}else{if(ae.segment==aa[0]||(ae.segment==aa[1]&&Q)){return W[P]}}}}},orthogonal:function(R,Q,S,O,N){var T=x,P={x:T.so[0]==-1?Math.min(Q,O):Math.max(Q,O),y:T.so[1]==-1?Math.min(Q,O):Math.max(Q,O)}[R];return{x:[[P,S],[P,N],[O,N]],y:[[S,P],[N,P],[N,O]]}[R]},opposite:function(P,W,O,U,V){var S=x,Q={x:"y",y:"x"}[P],T={x:"height",y:"width"}[P],N=S["is"+P.toUpperCase()+"GreaterThanStubTimes2"];if(L.sourceEndpoint.elementId==L.targetEndpoint.elementId){var R=O+((1-L.sourceEndpoint.anchor[Q])*L.sourceInfo[T])+t.maxStub;return{x:[[W,R],[U,R]],y:[[R,W],[R,U]]}[P]}else{if(!N||(S.so[C]==1&&W>U)||(S.so[C]==-1&&W<U)){return{x:[[W,H],[U,H]],y:[[J,W],[J,U]]}[P]}else{if((S.so[C]==1&&W<U)||(S.so[C]==-1&&W>U)){return{x:[[J,S.sy],[J,S.ty]],y:[[S.sx,H],[S.tx,H]]}[P]}}}}};var K=A[x.anchorOrientation](x.sourceAxis),C=x.sourceAxis=="x"?0:1,v=x.sourceAxis=="x"?1:0,E=K[C],w=K[v],M=K[C+2],z=K[v+2];i(q,K[0],K[1],x);var D=I[x.anchorOrientation](x.sourceAxis,E,w,M,z);if(D){for(var G=0;G<D.length;G++){i(q,D[G][0],D[G][1],x)}}i(q,K[2],K[3],x);i(q,x.tx,x.ty,x);n(this,q,x)};this.getPath=function(){var z=null,C=null,B=[],w=g||q;for(var y=0;y<w.length;y++){var v=w[y],A=v[4],x=(A=="v"?3:2);if(z!=null&&C===A){z[x]=v[x]}else{if(v[0]!=v[2]||v[1]!=v[3]){B.push({start:[v[0],v[1]],end:[v[2],v[3]]});z=v;C=v[4]}}}return B};this.setPath=function(F){g=[];for(var A=0;A<F.length;A++){var z=F[A].start[0],w=F[A].start[1],C=F[A].end[0],B=F[A].end[1],v=z==C?"v":"h",E=h(C-z),D=h(B-w);g.push([z,w,C,B,v,E,D])}}};jsPlumbUtil.extend(a,jsPlumb.Connectors.AbstractConnector);jsPlumb.registerConnectorType(a,"Flowchart")})();(function(){var d=function(f,h,e,g){this.m=(g-h)/(e-f);this.b=-1*((this.m*f)-h);this.rectIntersect=function(q,p,s,o){var n=[],k,t;k=(p-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}t=(this.m*(q+s))+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}k=((p+o)-this.b)/this.m;if(k>=q&&k<=(q+s)){n.push([k,(this.m*k)+this.b])}t=(this.m*q)+this.b;if(t>=p&&t<=(p+o)){n.push([(t-this.b)/this.m,t])}if(n.length==2){var m=(n[0][0]+n[1][0])/2,l=(n[0][1]+n[1][1])/2;n.push([m,l]);var i=m<=q+(s/2)?-1:1,r=l<=p+(o/2)?-1:1;n.push([i,r]);return n}return null}},b=function(f,h,e,g){if(f<=e&&g<=h){return 1}else{if(f<=e&&h<=g){return 2}else{if(e<=f&&g>=h){return 3}}}return 4},c=function(h,g,k,f,i,n,m,e,l){if(e<=l){return[h,g]}if(k===1){if(f[3]<=0&&i[3]>=1){return[h+(f[2]<0.5?-1*n:n),g]}else{if(f[2]>=1&&i[2]<=0){return[h,g+(f[3]<0.5?-1*m:m)]}else{return[h+(-1*n),g+(-1*m)]}}}else{if(k===2){if(f[3]>=1&&i[3]<=0){return[h+(f[2]<0.5?-1*n:n),g]}else{if(f[2]>=1&&i[2]<=0){return[h,g+(f[3]<0.5?-1*m:m)]}else{return[h+(1*n),g+(-1*m)]}}}else{if(k===3){if(f[3]>=1&&i[3]<=0){return[h+(f[2]<0.5?-1*n:n),g]}else{if(f[2]<=0&&i[2]>=1){return[h,g+(f[3]<0.5?-1*m:m)]}else{return[h+(-1*n),g+(-1*m)]}}}else{if(k===4){if(f[3]<=0&&i[3]>=1){return[h+(f[2]<0.5?-1*n:n),g]}else{if(f[2]<=0&&i[2]>=1){return[h,g+(f[3]<0.5?-1*m:m)]}else{return[h+(1*n),g+(-1*m)]}}}}}}};var a=function(h){h=h||{};this.type="StateMachine";var n=this,l=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),e=h.curviness||10,i=h.margin||5,k=h.proximityLimit||80,f=h.orientation&&h.orientation==="clockwise",g=h.loopbackRadius||25,m=h.showLoopback!==false;this._compute=function(A,T){var I=Math.abs(T.sourcePos[0]-T.targetPos[0]),Q=Math.abs(T.sourcePos[1]-T.targetPos[1]),G=Math.min(T.sourcePos[0],T.targetPos[0]),E=Math.min(T.sourcePos[1],T.targetPos[1]);if(!m||(T.sourceEndpoint.elementId!==T.targetEndpoint.elementId)){var z=T.sourcePos[0]<T.targetPos[0]?0:I,t=T.sourcePos[1]<T.targetPos[1]?0:Q,L=T.sourcePos[0]<T.targetPos[0]?I:0,J=T.sourcePos[1]<T.targetPos[1]?Q:0;if(T.sourcePos[2]===0){z-=i}if(T.sourcePos[2]===1){z+=i}if(T.sourcePos[3]===0){t-=i}if(T.sourcePos[3]===1){t+=i}if(T.targetPos[2]===0){L-=i}if(T.targetPos[2]===1){L+=i}if(T.targetPos[3]===0){J-=i}if(T.targetPos[3]===1){J+=i}var F=(z+L)/2,C=(t+J)/2,o=(-1*F)/C,M=Math.atan(o),H=(o==Infinity||o==-Infinity)?0:Math.abs(e/2*Math.sin(M)),K=(o==Infinity||o==-Infinity)?0:Math.abs(e/2*Math.cos(M)),p=b(z,t,L,J),B=Math.sqrt(Math.pow(L-z,2)+Math.pow(J-t,2)),D=c(F,C,p,T.sourcePos,T.targetPos,e,e,B,k);l.addSegment(this,"Bezier",{x1:L,y1:J,x2:z,y2:t,cp1x:D[0],cp1y:D[1],cp2x:D[0],cp2y:D[1]})}else{var S=T.sourcePos[0],P=T.sourcePos[0],v=T.sourcePos[1]-i,s=T.sourcePos[1]-i,u=S,r=v-g,R=2*g,q=2*g,O=u-g,N=r-g;A.points[0]=O;A.points[1]=N;A.points[2]=R;A.points[3]=q;l.addSegment(this,"Arc",{x1:(S-O)+4,y1:v-N,startAngle:0,endAngle:2*Math.PI,r:g,ac:!f,x2:(S-O)-4,y2:v-N,cx:u-O,cy:r-N})}}};jsPlumb.registerConnectorType(a,"StateMachine")})();(function(){var a=function(g){g=g||{};var c=this,e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),f=g.stub||50,b=g.curviness||150,d=10;this.type="Bezier";this.getCurviness=function(){return b};this._findControlPoint=function(r,h,n,i,l){var o=i.anchor.getOrientation(i),q=l.anchor.getOrientation(l),m=o[0]!=q[0]||o[1]==q[1],k=[];if(!m){if(o[0]===0){k.push(h[0]<n[0]?r[0]+d:r[0]-d)}else{k.push(r[0]-(b*o[0]))}if(o[1]===0){k.push(h[1]<n[1]?r[1]+d:r[1]-d)}else{k.push(r[1]+(b*q[1]))}}else{if(q[0]===0){k.push(n[0]<h[0]?r[0]+d:r[0]-d)}else{k.push(r[0]+(b*q[0]))}if(q[1]===0){k.push(n[1]<h[1]?r[1]+d:r[1]-d)}else{k.push(r[1]+(b*o[1]))}}return k};this._compute=function(m,k){var l=k.sourcePos,s=k.targetPos,t=Math.abs(l[0]-s[0]),o=Math.abs(l[1]-s[1]),q=l[0]<s[0]?t:0,n=l[1]<s[1]?o:0,i=l[0]<s[0]?0:t,h=l[1]<s[1]?0:o,u=c._findControlPoint([q,n],l,s,k.sourceEndpoint,k.targetEndpoint),r=c._findControlPoint([i,h],s,l,k.targetEndpoint,k.sourceEndpoint);e.addSegment(this,"Bezier",{x1:q,y1:n,x2:i,y2:h,cp1x:u[0],cp1y:u[1],cp2x:r[0],cp2y:r[1]})}};jsPlumb.registerConnectorType(a,"Bezier")})();(function(){var f=null,m=function(s,r){return jsPlumb.CurrentLibrary.hasClass(a(s),r)},a=function(r){return jsPlumb.CurrentLibrary.getElementObject(r)},p=function(r){return jsPlumb.CurrentLibrary.getOffset(a(r))},q=function(r){return jsPlumb.CurrentLibrary.getPageXY(r)},h=function(r){return jsPlumb.CurrentLibrary.getClientXY(r)};var n=window.CanvasMouseAdapter=function(){var t=this;t.overlayPlacements=[];jsPlumb.jsPlumbUIComponent.apply(this,arguments);jsPlumbUtil.EventGenerator.apply(this,arguments);this._over=function(C){var E=p(a(t.canvas)),G=q(C),z=G[0]-E.left,F=G[1]-E.top;if(z>0&&F>0&&z<t.canvas.width&&F<t.canvas.height){for(var A=0;A<t.overlayPlacements.length;A++){var B=t.overlayPlacements[A];if(B&&(B[0]<=z&&B[1]>=z&&B[2]<=F&&B[3]>=F)){return true}}var D=t.canvas.getContext("2d").getImageData(parseInt(z,10),parseInt(F,10),1,1);return D.data[0]!==0||D.data[1]!==0||D.data[2]!==0||D.data[3]!==0}return false};var s=false,r=false,w=null,v=false,u=function(y,x){return y!==null&&m(y,x)};this.mousemove=function(A){var C=q(A),z=h(A),y=document.elementFromPoint(z[0],z[1]),B=u(y,"_jsPlumb_overlay");var x=f===null&&(u(y,"_jsPlumb_endpoint")||u(y,"_jsPlumb_connector"));if(!s&&x&&t._over(A)){s=true;t.fire("mouseenter",t,A);return true}else{if(s&&(!t._over(A)||!x)&&!B){s=false;t.fire("mouseexit",t,A)}}t.fire("mousemove",t,A)};this.click=function(x){if(s&&t._over(x)&&!v){t.fire("click",t,x)}v=false};this.dblclick=function(x){if(s&&t._over(x)&&!v){t.fire("dblclick",t,x)}v=false};this.mousedown=function(x){if(t._over(x)&&!r){r=true;w=p(a(t.canvas));t.fire("mousedown",t,x)}};this.mouseup=function(x){r=false;t.fire("mouseup",t,x)};this.contextmenu=function(x){if(s&&t._over(x)&&!v){t.fire("contextmenu",t,x)}v=false}};jsPlumbUtil.extend(n,[jsPlumb.jsPlumbUIComponent,jsPlumbUtil.EventGenerator]);var e=function(s){var r=document.createElement("canvas");s._jsPlumb.instance.appendElement(r,s.parent);r.style.position="absolute";if(s["class"]){r.className=s["class"]}s._jsPlumb.instance.getId(r,s.uuid);if(s.tooltip){r.setAttribute("title",s.tooltip)}return r};var o=window.CanvasComponent=function(s){n.apply(this,arguments);var r=[];this.getDisplayElements=function(){return r};this.appendDisplayElement=function(t){r.push(t)}};jsPlumbUtil.extend(o,n);var b=[null,[1,-1],[1,1],[-1,1],[-1,-1]];var d=function(r,t,v){if(t.gradient){var u=v();for(var s=0;s<t.gradient.stops.length;s++){u.addColorStop(t.gradient.stops[s][0],t.gradient.stops[s][1])}r.strokeStyle=u}};var l=function(v,s,u,t,r){({Straight:function(x,J,M,D,C){var P=x.params;J.save();d(J,M,function(){return J.createLinearGradient(P.x1,P.y1,P.x2,P.y2)});J.beginPath();J.translate(D,C);if(M.dashstyle&&M.dashstyle.split(" ").length===2){var H=M.dashstyle.split(" ");if(H.length!==2){H=[2,2]}var w=[H[0]*M.lineWidth,H[1]*M.lineWidth],I=(P.x2-P.x1)/(P.y2-P.y1),F=jsPlumbUtil.segment([P.x1,P.y1],[P.x2,P.y2]),N=b[F],B=Math.atan(I),K=Math.sqrt(Math.pow(P.x2-P.x1,2)+Math.pow(P.y2-P.y1,2)),A=Math.floor(K/(w[0]+w[1])),O=[P.x1,P.y1];for(var L=0;L<A;L++){J.moveTo(O[0],O[1]);var G=O[0]+(Math.abs(Math.sin(B)*w[0])*N[0]),E=O[1]+(Math.abs(Math.cos(B)*w[0])*N[1]),z=O[0]+(Math.abs(Math.sin(B)*(w[0]+w[1]))*N[0]),y=O[1]+(Math.abs(Math.cos(B)*(w[0]+w[1]))*N[1]);J.lineTo(G,E);O=[z,y]}J.moveTo(O[0],O[1]);J.lineTo(P.x2,P.y2)}else{J.moveTo(P.x1,P.y1);J.lineTo(P.x2,P.y2)}J.stroke();J.restore()},Bezier:function(A,x,z,y,w){var B=A.params;x.save();d(x,z,function(){return x.createLinearGradient(B.x2+y,B.y2+w,B.x1+y,B.y1+w)});x.beginPath();x.translate(y,w);x.moveTo(B.x1,B.y1);x.bezierCurveTo(B.cp1x,B.cp1y,B.cp2x,B.cp2y,B.x2,B.y2);x.stroke();x.restore()},Arc:function(A,x,z,y,w){var B=A.params;x.save();x.beginPath();x.translate(y,w);x.arc(B.cx,B.cy,B.r,A.startAngle,A.endAngle,B.ac);x.stroke();x.restore()}})[v.type](v,s,u,t,r)};var k=jsPlumb.ConnectorRenderers.canvas=function(t){o.apply(this,arguments);var r=function(y,v,u){this.ctx.save();jsPlumb.extend(this.ctx,y);var w=this.getSegments();for(var x=0;x<w.length;x++){l(w[x],this.ctx,y,v,u)}this.ctx.restore()}.bind(this);var s=this._jsPlumb.instance.connectorClass+" "+(t.cssClass||"");this.canvas=e({"class":s,_jsPlumb:this._jsPlumb,parent:t.parent});this.ctx=this.canvas.getContext("2d");this.appendDisplayElement(this.canvas);this.paint=function(u,x,A){if(u!=null){var D=[this.x,this.y],v=[this.w,this.h],w,E=0,C=0;if(A!=null){if(A.xmin<0){D[0]+=A.xmin;E=-A.xmin}if(A.ymin<0){D[1]+=A.ymin;C=-A.ymin}v[0]=A.xmax+((A.xmin<0)?-A.xmin:0);v[1]=A.ymax+((A.ymin<0)?-A.ymin:0)}this.translateX=E;this.translateY=C;jsPlumbUtil.sizeElement(this.canvas,D[0],D[1],v[0],v[1]);if(u.outlineColor!=null){var z=u.outlineWidth||1,B=u.lineWidth+(2*z),y={strokeStyle:u.outlineColor,lineWidth:B};r(y,E,C)}r(u,E,C)}}};jsPlumbUtil.extend(k,o);var c=function(t){o.apply(this,arguments);var s=this._jsPlumb.instance.endpointClass+" "+(t.cssClass||""),r={"class":s,_jsPlumb:this._jsPlumb,parent:t.parent,tooltip:self.tooltip};this.canvas=e(r);this.ctx=this.canvas.getContext("2d");this.appendDisplayElement(this.canvas);this.paint=function(w,u,z){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h);if(w.outlineColor!=null){var y=w.outlineWidth||1,v=w.lineWidth+(2*y);var x={strokeStyle:w.outlineColor,lineWidth:v}}this._paint.apply(this,arguments)}};jsPlumbUtil.extend(c,o);jsPlumb.Endpoints.canvas.Dot=function(u){jsPlumb.Endpoints.Dot.apply(this,arguments);c.apply(this,arguments);var t=this,s=function(v){try{return parseInt(v,10)}catch(w){if(v.substring(v.length-1)=="%"){return parseInt(v.substring(0,v-1),10)}}},r=function(x){var v=t.defaultOffset,w=t.defaultInnerRadius;if(x.offset){v=s(x.offset)}if(x.innerRadius){w=s(x.innerRadius)}return[v,w]};this._paint=function(z){if(z!=null){var v=t.canvas.getContext("2d"),w=u.endpoint.anchor.getOrientation(u.endpoint);jsPlumb.extend(v,z);if(z.gradient){var C=r(z.gradient),B=w[1]==1?C[0]*-1:C[0],y=w[0]==1?C[0]*-1:C[0],A=v.createRadialGradient(t.radius,t.radius,t.radius,t.radius+y,t.radius+B,C[1]);for(var x=0;x<z.gradient.stops.length;x++){A.addColorStop(z.gradient.stops[x][0],z.gradient.stops[x][1])}v.fillStyle=A}v.beginPath();v.arc(t.radius,t.radius,t.radius,0,Math.PI*2,true);v.closePath();if(z.fillStyle||z.gradient){v.fill()}if(z.strokeStyle){v.stroke()}}}};jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Dot,[jsPlumb.Endpoints.Dot,c]);jsPlumb.Endpoints.canvas.Rectangle=function(s){var r=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments);c.apply(this,arguments);this._paint=function(t){var B=r.canvas.getContext("2d"),w=s.endpoint.anchor.getOrientation(s.endpoint);jsPlumb.extend(B,t);if(t.gradient){var A=w[1]==1?r.h:w[1]===0?r.h/2:0;var z=w[1]==-1?r.h:w[1]===0?r.h/2:0;var v=w[0]==1?r.w:w[0]===0?r.w/2:0;var u=w[0]==-1?r.w:w[0]===0?r.w/2:0;var y=B.createLinearGradient(v,A,u,z);for(var x=0;x<t.gradient.stops.length;x++){y.addColorStop(t.gradient.stops[x][0],t.gradient.stops[x][1])}B.fillStyle=y}B.beginPath();B.rect(0,0,r.w,r.h);B.closePath();if(t.fillStyle||t.gradient){B.fill()}if(t.strokeStyle){B.stroke()}}};jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Rectangle,[jsPlumb.Endpoints.Rectangle,c]);jsPlumb.Endpoints.canvas.Triangle=function(s){var r=this;jsPlumb.Endpoints.Triangle.apply(this,arguments);c.apply(this,arguments);this._paint=function(w){var u=r.canvas.getContext("2d"),t=0,y=0,x=0,v=s.endpoint.anchor.getOrientation(s.endpoint);if(v[0]==1){t=r.width;y=r.height;x=180}if(v[1]==-1){t=r.width;x=90}if(v[1]==1){y=r.height;x=-90}u.fillStyle=w.fillStyle;u.translate(t,y);u.rotate(x*Math.PI/180);u.beginPath();u.moveTo(0,0);u.lineTo(r.width/2,r.height/2);u.lineTo(0,r.height);u.closePath();if(w.fillStyle||w.gradient){u.fill()}if(w.strokeStyle){u.stroke()}}};jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Triangle,[jsPlumb.Endpoints.Triangle,c]);jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var i=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};jsPlumbUtil.extend(i,jsPlumb.jsPlumbUIComponent);var g=function(s,r){s.apply(this,r);i.apply(this,r);this.paint=function(w,u){var t=w.component.ctx,v=w.d;if(v){t.save();t.lineWidth=w.lineWidth;t.beginPath();t.translate(w.component.translateX,w.component.translateY);t.moveTo(v.hxy.x,v.hxy.y);t.lineTo(v.tail[0].x,v.tail[0].y);t.lineTo(v.cxy.x,v.cxy.y);t.lineTo(v.tail[1].x,v.tail[1].y);t.lineTo(v.hxy.x,v.hxy.y);t.closePath();if(w.strokeStyle){t.strokeStyle=w.strokeStyle;t.stroke()}if(w.fillStyle){t.fillStyle=w.fillStyle;t.fill()}t.restore()}}};jsPlumb.Overlays.canvas.Arrow=function(){g.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Arrow,[jsPlumb.Overlays.Arrow,i]);jsPlumb.Overlays.canvas.PlainArrow=function(){g.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.canvas.PlainArrow,[jsPlumb.Overlays.PlainArrow,i]);jsPlumb.Overlays.canvas.Diamond=function(){g.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Diamond,[jsPlumb.Overlays.Diamond,i])})();(function(){var l={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},w="stroke-dasharray",B="dashstyle",e="linearGradient",b="radialGradient",c="fill",a="stop",A="stroke",q="stroke-width",h="style",m="none",t="jsplumb_gradient_",o="lineWidth",D={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},g=function(G,E){for(var F in E){G.setAttribute(F,""+E[F])}},f=function(F,E){var G=document.createElementNS(D.svg,F);E=E||{};E.version="1.1";E.xmlns=D.xhtml;g(G,E);return G},n=function(E){return"position:absolute;left:"+E[0]+"px;top:"+E[1]+"px"},i=function(F){for(var E=0;E<F.childNodes.length;E++){if(F.childNodes[E].tagName==e||F.childNodes[E].tagName==b){F.removeChild(F.childNodes[E])}}},v=function(O,J,G,E,K){var H=t+K._jsPlumb.instance.idstamp();i(O);var M;if(!G.gradient.offset){M=f(e,{id:H,gradientUnits:"userSpaceOnUse"})}else{M=f(b,{id:H})}O.appendChild(M);for(var L=0;L<G.gradient.stops.length;L++){var I=K.segment==1||K.segment==2?L:G.gradient.stops.length-1-L,N=jsPlumbUtil.convertStyle(G.gradient.stops[I][1],true),P=f(a,{offset:Math.floor(G.gradient.stops[L][0]*100)+"%","stop-color":N});M.appendChild(P)}var F=G.strokeStyle?A:c;J.setAttribute(h,F+":url(#"+H+")")},x=function(L,H,F,E,I){if(F.gradient){v(L,H,F,E,I)}else{i(L);H.setAttribute(h,"")}H.setAttribute(c,F.fillStyle?jsPlumbUtil.convertStyle(F.fillStyle,true):m);H.setAttribute(A,F.strokeStyle?jsPlumbUtil.convertStyle(F.strokeStyle,true):m);if(F.lineWidth){H.setAttribute(q,F.lineWidth)}if(F[B]&&F[o]&&!F[w]){var M=F[B].indexOf(",")==-1?" ":",",J=F[B].split(M),G="";J.forEach(function(N){G+=(Math.floor(N*F.lineWidth)+M)});H.setAttribute(w,G)}else{if(F[w]){H.setAttribute(w,F[w])}}for(var K in l){if(F[K]){H.setAttribute(l[K],F[K])}}},C=function(G){var E=/([0-9].)(p[xt])\s(.*)/,F=G.match(E);return{size:F[1]+F[2],font:F[3]}},r=function(J,K,F){var L=F.split(" "),I=J.className,H=I.baseVal.split(" ");for(var G=0;G<L.length;G++){if(K){if(H.indexOf(L[G])==-1){H.push(L[G])}}else{var E=H.indexOf(L[G]);if(E!=-1){H.splice(E,1)}}}J.className.baseVal=H.join(" ")},u=function(F,E){r(F,true,E)},k=function(F,E){r(F,false,E)},z=function(F,G,E){if(F.childNodes.length>E){F.insertBefore(G,F.childNodes[E])}else{F.appendChild(G)}};jsPlumbUtil.svg={addClass:u,removeClass:k,node:f,attr:g,pos:n};var s=function(I){var G=I.pointerEventsSpec||"all",H={};jsPlumb.jsPlumbUIComponent.apply(this,I.originalArgs);this.canvas=null;this.path=null;this.svg=null;var F=I.cssClass+" "+(I.originalArgs[0].cssClass||""),J={style:"",width:0,height:0,"pointer-events":G,position:"absolute"};this.svg=f("svg",J);if(I.useDivWrapper){this.canvas=document.createElement("div");this.canvas.style.position="absolute";jsPlumbUtil.sizeElement(this.canvas,0,0,1,1);this.canvas.className=F}else{g(this.svg,{"class":F});this.canvas=this.svg}I._jsPlumb.appendElement(this.canvas,I.originalArgs[0].parent);if(I.useDivWrapper){this.canvas.appendChild(this.svg)}var E=[this.canvas];this.getDisplayElements=function(){return E};this.appendDisplayElement=function(K){E.push(K)};this.paint=function(M,L,N){if(M!=null){var P=[this.x,this.y],K=[this.w,this.h],O;if(N!=null){if(N.xmin<0){P[0]+=N.xmin}if(N.ymin<0){P[1]+=N.ymin}K[0]=N.xmax+((N.xmin<0)?-N.xmin:0);K[1]=N.ymax+((N.ymin<0)?-N.ymin:0)}if(I.useDivWrapper){jsPlumbUtil.sizeElement(this.canvas,P[0],P[1],K[0],K[1]);P[0]=0;P[1]=0;O=n([0,0])}else{O=n([P[0],P[1]])}H.paint.apply(this,arguments);g(this.svg,{style:O,width:K[0],height:K[1]})}};return{renderer:H}};jsPlumbUtil.extend(s,jsPlumb.jsPlumbUIComponent,{cleanup:function(){jsPlumbUtil.removeElement(this.canvas);this.svg=null;this.canvas=null;this.path=null}});var d=jsPlumb.ConnectorRenderers.svg=function(G){var E=this,F=s.apply(this,[{cssClass:G._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:G._jsPlumb}]);F.renderer.paint=function(H,L,Q){var M=E.getSegments(),I="",J=[0,0];if(Q.xmin<0){J[0]=-Q.xmin}if(Q.ymin<0){J[1]=-Q.ymin}for(var K=0;K<M.length;K++){I+=jsPlumb.Segments.svg.SegmentRenderer.getPath(M[K]);I+=" "}var R={d:I,transform:"translate("+J[0]+","+J[1]+")","pointer-events":G["pointer-events"]||"visibleStroke"},O=null,N=[E.x,E.y,E.w,E.h];if(H.outlineColor){var P=H.outlineWidth||1,S=H.lineWidth+(2*P);O=jsPlumb.CurrentLibrary.extend({},H);O.strokeStyle=jsPlumbUtil.convertStyle(H.outlineColor);O.lineWidth=S;if(E.bgPath==null){E.bgPath=f("path",R);z(E.svg,E.bgPath,0);E.attachListeners(E.bgPath,E)}else{g(E.bgPath,R)}x(E.svg,E.bgPath,O,N,E)}if(E.path==null){E.path=f("path",R);z(E.svg,E.path,H.outlineColor?1:0);E.attachListeners(E.path,E)}else{g(E.path,R)}x(E.svg,E.path,H,N,E)};this.reattachListeners=function(){if(this.bgPath){this.reattachListenersForElement(this.bgPath,this)}if(this.path){this.reattachListenersForElement(this.path,this)}}};jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,s);jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(E){return({Straight:function(){var F=E.getCoordinates();return"M "+F.x1+" "+F.y1+" L "+F.x2+" "+F.y2},Bezier:function(){var F=E.params;return"M "+F.x1+" "+F.y1+" C "+F.cp1x+" "+F.cp1y+" "+F.cp2x+" "+F.cp2y+" "+F.x2+" "+F.y2},Arc:function(){var H=E.params,F=E.sweep>Math.PI?1:0,G=E.anticlockwise?0:1;return"M"+E.x1+" "+E.y1+" A "+E.radius+" "+H.r+" 0 "+F+","+G+" "+E.x2+" "+E.y2}})[E.type]()}}};var y=window.SvgEndpoint=function(F){var E=s.apply(this,[{cssClass:F._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:true,_jsPlumb:F._jsPlumb}]);E.renderer.paint=function(H){var G=jsPlumb.extend({},H);if(G.outlineColor){G.strokeWidth=G.outlineWidth;G.strokeStyle=jsPlumbUtil.convertStyle(G.outlineColor,true)}if(this.node==null){this.node=this.makeNode(G);this.svg.appendChild(this.node);this.attachListeners(this.node,this)}else{if(this.updateNode!=null){this.updateNode(this.node)}}x(this.svg,this.node,G,[this.x,this.y,this.w,this.h],this);n(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(y,s,{reattachListeners:function(){if(this.node){this.reattachListenersForElement(this.node,this)}}});jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E){return f("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})};this.updateNode=function(E){g(E,{cx:this.w/2,cy:this.h/2,r:this.radius})}};jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,y]);jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);y.apply(this,arguments);this.makeNode=function(E){return f("rect",{width:this.w,height:this.h})};this.updateNode=function(E){g(E,{width:this.w,height:this.h})}};jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,y]);jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var p=function(H,G){H.apply(this,G);jsPlumb.jsPlumbUIComponent.apply(this,G);this.isAppendedAtTopLevel=false;var E=this;this.path=null;this.paint=function(L,I){if(L.component.svg&&I){if(this.path==null){this.path=f("path",{"pointer-events":"all"});L.component.svg.appendChild(this.path);this.attachListeners(this.path,L.component);this.attachListeners(this.path,this)}var J=G&&(G.length==1)?(G[0].cssClass||""):"",K=[0,0];if(I.xmin<0){K[0]=-I.xmin}if(I.ymin<0){K[1]=-I.ymin}g(this.path,{d:F(L.d),"class":J,stroke:L.strokeStyle?L.strokeStyle:null,fill:L.fillStyle?L.fillStyle:null,transform:"translate("+K[0]+","+K[1]+")"})}};var F=function(I){return"M"+I.hxy.x+","+I.hxy.y+" L"+I.tail[0].x+","+I.tail[0].y+" L"+I.cxy.x+","+I.cxy.y+" L"+I.tail[1].x+","+I.tail[1].y+" L"+I.hxy.x+","+I.hxy.y};this.reattachListeners=function(){if(this.path){this.reattachListenersForElement(this.path,this)}}};jsPlumbUtil.extend(p,jsPlumb.jsPlumbUIComponent,{cleanup:function(){if(this.path!=null){jsPlumb.CurrentLibrary.removeElement(this.path)}}});jsPlumb.Overlays.svg.Arrow=function(){p.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,p]);jsPlumb.Overlays.svg.PlainArrow=function(){p.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,p]);jsPlumb.Overlays.svg.Diamond=function(){p.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,p]);jsPlumb.Overlays.svg.GuideLines=function(){var I=null,E=this,H,G;jsPlumb.Overlays.GuideLines.apply(this,arguments);this.paint=function(L,J){if(I==null){I=f("path");L.connector.svg.appendChild(I);E.attachListeners(I,L.connector);E.attachListeners(I,E);H=f("path");L.connector.svg.appendChild(H);E.attachListeners(H,L.connector);E.attachListeners(H,E);G=f("path");L.connector.svg.appendChild(G);E.attachListeners(G,L.connector);E.attachListeners(G,E)}var K=[0,0];if(J.xmin<0){K[0]=-J.xmin}if(J.ymin<0){K[1]=-J.ymin}g(I,{d:F(L.head,L.tail),stroke:"red",fill:null,transform:"translate("+K[0]+","+K[1]+")"});g(H,{d:F(L.tailLine[0],L.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+K[0]+","+K[1]+")"});g(G,{d:F(L.headLine[0],L.headLine[1]),stroke:"green",fill:null,transform:"translate("+K[0]+","+K[1]+")"})};var F=function(K,J){return"M "+K.x+","+K.y+" L"+J.x+","+J.y}};jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)})();(function(){var h={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},c=null;if(document.createStyleSheet&&document.namespaces){var m=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],g="behavior:url(#default#VML);position:absolute;";c=document.createStyleSheet();for(var r=0;r<m.length;r++){c.addRule(m[r],g)}document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var t=1000,s={},a=function(u,i){var w=jsPlumb.getId(u),v=s[w];if(!v){v=f("group",[0,0,t,t],{"class":i});v.style.backgroundColor="red";s[w]=v}return v},e=function(v,w){for(var u in w){v[u]=w[u]}},f=function(u,y,z,w,i,v){z=z||{};var x=document.createElement("jsplumb:"+u);if(v){i.appendElement(x,w)}else{jsPlumb.CurrentLibrary.appendElement(x,w)}x.className=(z["class"]?z["class"]+" ":"")+"jsplumb_vml";k(x,y);e(x,z);return x},k=function(u,i,v){u.style.left=i[0]+"px";u.style.top=i[1]+"px";u.style.width=i[2]+"px";u.style.height=i[3]+"px";u.style.position="absolute";if(v){u.style.zIndex=v}},p=jsPlumb.vml.convertValue=function(i){return Math.floor(i*t)},b=function(w,u,v,i){if("transparent"===u){i.setOpacity(v,"0.0")}else{i.setOpacity(v,"1.0")}},q=function(y,u,B,C){var x={};if(u.strokeStyle){x.stroked="true";var D=jsPlumbUtil.convertStyle(u.strokeStyle,true);x.strokecolor=D;b(x,D,"stroke",B);x.strokeweight=u.lineWidth+"px"}else{x.stroked="false"}if(u.fillStyle){x.filled="true";var v=jsPlumbUtil.convertStyle(u.fillStyle,true);x.fillcolor=v;b(x,v,"fill",B)}else{x.filled="false"}if(u.dashstyle){if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:u.dashstyle},y,C)}else{B.strokeNode.dashstyle=u.dashstyle}}else{if(u["stroke-dasharray"]&&u.lineWidth){var E=u["stroke-dasharray"].indexOf(",")==-1?" ":",",z=u["stroke-dasharray"].split(E),w="";for(var A=0;A<z.length;A++){w+=(Math.floor(z[A]/u.lineWidth)+E)}if(B.strokeNode==null){B.strokeNode=f("stroke",[0,0,0,0],{dashstyle:w},y,C)}else{B.strokeNode.dashstyle=w}}}e(y,x)},n=function(){var i=this,v={};jsPlumb.jsPlumbUIComponent.apply(this,arguments);this.opacityNodes={stroke:null,fill:null};this.initOpacityNodes=function(w){i.opacityNodes.stroke=f("stroke",[0,0,1,1],{opacity:"0.0"},w,i._jsPlumb.instance);i.opacityNodes.fill=f("fill",[0,0,1,1],{opacity:"0.0"},w,i._jsPlumb.instance)};this.setOpacity=function(w,y){var x=i.opacityNodes[w];if(x){x.opacity=""+y}};var u=[];this.getDisplayElements=function(){return u};this.appendDisplayElement=function(x,w){if(!w){i.canvas.parentNode.appendChild(x)}u.push(x)}};jsPlumbUtil.extend(n,jsPlumb.jsPlumbUIComponent,{cleanup:function(){if(this.bgCanvas){jsPlumbUtil.removeElement(this.bgCanvas)}jsPlumbUtil.removeElement(this.canvas)}});var d=jsPlumb.ConnectorRenderers.vml=function(u){this.strokeNode=null;this.canvas=null;n.apply(this,arguments);var i=this._jsPlumb.instance.connectorClass+(u.cssClass?(" "+u.cssClass):"");this.paint=function(w){if(w!==null){var z=this.getSegments(),x={path:""},A=[this.x,this.y,this.w,this.h];for(var y=0;y<z.length;y++){x.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(z[y]);x.path+=" "}if(w.outlineColor){var C=w.outlineWidth||1,D=w.lineWidth+(2*C),B={strokeStyle:jsPlumbUtil.convertStyle(w.outlineColor),lineWidth:D};for(var v in h){B[v]=w[v]}if(this.bgCanvas==null){x["class"]=i;x.coordsize=(A[2]*t)+","+(A[3]*t);this.bgCanvas=f("shape",A,x,u.parent,this._jsPlumb.instance,true);k(this.bgCanvas,A);this.appendDisplayElement(this.bgCanvas,true);this.attachListeners(this.bgCanvas,this);this.initOpacityNodes(this.bgCanvas,["stroke"])}else{x.coordsize=(A[2]*t)+","+(A[3]*t);k(this.bgCanvas,A);e(this.bgCanvas,x)}q(this.bgCanvas,B,this)}if(this.canvas==null){x["class"]=i;x.coordsize=(A[2]*t)+","+(A[3]*t);this.canvas=f("shape",A,x,u.parent,this._jsPlumb.instance,true);this.appendDisplayElement(this.canvas,true);this.attachListeners(this.canvas,this);this.initOpacityNodes(this.canvas,["stroke"])}else{x.coordsize=(A[2]*t)+","+(A[3]*t);k(this.canvas,A);e(this.canvas,x)}q(this.canvas,w,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(d,n,{reattachListeners:function(){if(this.canvas){this.reattachListenersForElement(this.canvas,this)}}});var l=window.VmlEndpoint=function(i){n.apply(this,arguments);this._jsPlumb.vml=null;this.canvas=document.createElement("div");this.canvas.style.position="absolute";this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(i.cssClass?(" "+i.cssClass):"");i._jsPlumb.appendElement(this.canvas,i.parent);this.paint=function(w,v){var x={},u=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h);if(this._jsPlumb.vml==null){x["class"]=this._jsPlumb.clazz;u=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],x,v,this.canvas,this._jsPlumb.instance);this.attachListeners(u,this);this.appendDisplayElement(u,true);this.appendDisplayElement(this.canvas,true);this.initOpacityNodes(u,["fill"])}else{k(u,[0,0,this.w,this.h]);e(u,x)}q(u,w,this)}};jsPlumbUtil.extend(l,n,{reattachListeners:function(){if(this._jsPlumb.vml){this.reattachListenersForElement(this._jsPlumb.vml,this)}}});jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(i){return({Straight:function(u){var v=u.params;return"m"+p(v.x1)+","+p(v.y1)+" l"+p(v.x2)+","+p(v.y2)+" e"},Bezier:function(u){var v=u.params;return"m"+p(v.x1)+","+p(v.y1)+" c"+p(v.cp1x)+","+p(v.cp1y)+","+p(v.cp2x)+","+p(v.cp2y)+","+p(v.x2)+","+p(v.y2)+" e"},Arc:function(z){var B=z.params,u=Math.min(B.x1,B.x2),y=Math.max(B.x1,B.x2),C=Math.min(B.y1,B.y2),w=Math.max(B.y1,B.y2),A=z.anticlockwise?1:0,v=(z.anticlockwise?"at ":"wa "),x=function(){var D=[null,[function(){return[u,C]},function(){return[u-B.r,C-B.r]}],[function(){return[u-B.r,C]},function(){return[u,C-B.r]}],[function(){return[u-B.r,C-B.r]},function(){return[u,C]}],[function(){return[u,C-B.r]},function(){return[u-B.r,C]}]][z.segment][A]();return p(D[0])+","+p(D[1])+","+p(D[0]+(2*B.r))+","+p(D[1]+(2*B.r))};return v+x()+","+p(B.x1)+","+p(B.y1)+","+p(B.x2)+","+p(B.y2)+" e"}})[i.type](i)}}};jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("oval",w,x,v,i)}};jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,l);jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments);l.apply(this,arguments);this.getVml=function(w,x,u,v,i){return f("rect",w,x,v,i)}};jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,l);jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image;jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank;jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label;jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var o=function(x,v){x.apply(this,v);n.apply(this,v);var u=this,w=null;u.canvas=null;u.isAppendedAtTopLevel=true;var i=function(y){return"m "+p(y.hxy.x)+","+p(y.hxy.y)+" l "+p(y.tail[0].x)+","+p(y.tail[0].y)+" "+p(y.cxy.x)+","+p(y.cxy.y)+" "+p(y.tail[1].x)+","+p(y.tail[1].y)+" x e"};this.paint=function(C,D){var z={},I=C.d,B=C.component;if(C.strokeStyle){z.stroked="true";z.strokecolor=jsPlumbUtil.convertStyle(C.strokeStyle,true)}if(C.lineWidth){z.strokeweight=C.lineWidth+"px"}if(C.fillStyle){z.filled="true";z.fillcolor=C.fillStyle}var y=Math.min(I.hxy.x,I.tail[0].x,I.tail[1].x,I.cxy.x),L=Math.min(I.hxy.y,I.tail[0].y,I.tail[1].y,I.cxy.y),E=Math.max(I.hxy.x,I.tail[0].x,I.tail[1].x,I.cxy.x),A=Math.max(I.hxy.y,I.tail[0].y,I.tail[1].y,I.cxy.y),K=Math.abs(E-y),G=Math.abs(A-L),F=[y,L,K,G];z.path=i(I);z.coordsize=(B.w*t)+","+(B.h*t);F[0]=B.x;F[1]=B.y;F[2]=B.w;F[3]=B.h;if(u.canvas==null){var J=B._jsPlumb.overlayClass||"";var H=v&&(v.length==1)?(v[0].cssClass||""):"";z["class"]=H+" "+J;u.canvas=f("shape",F,z,B.canvas.parentNode,B._jsPlumb.instance,true);B.appendDisplayElement(u.canvas,true);u.attachListeners(u.canvas,B);u.attachListeners(u.canvas,u)}else{k(u.canvas,F);e(u.canvas,z)}};this.reattachListeners=function(){if(u.canvas){u.reattachListenersForElement(u.canvas,u)}};this.cleanup=function(){if(u.canvas!=null){jsPlumb.CurrentLibrary.removeElement(u.canvas)}}};jsPlumbUtil.extend(o,n);jsPlumb.Overlays.vml.Arrow=function(){o.apply(this,[jsPlumb.Overlays.Arrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,o]);jsPlumb.Overlays.vml.PlainArrow=function(){o.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,o]);jsPlumb.Overlays.vml.Diamond=function(){o.apply(this,[jsPlumb.Overlays.Diamond,arguments])};jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,o])})();(function(b){var a=function(c){return typeof(c)=="string"?b("#"+c):b(c)};jsPlumb.CurrentLibrary={addClass:function(d,c){d=a(d);try{if(d[0].className.constructor==SVGAnimatedString){jsPlumbUtil.svg.addClass(d[0],c)}}catch(f){}try{d.addClass(c)}catch(f){}},animate:function(e,d,c){e.animate(d,c)},appendElement:function(d,c){a(c).append(d)},ajax:function(c){c=c||{};c.type=c.type||"get";b.ajax(c)},bind:function(c,d,e){c=a(c);c.bind(d,e)},destroyDraggable:function(c){if(b(c).data("draggable")){b(c).draggable("destroy")}},destroyDroppable:function(c){if(b(c).data("droppable")){b(c).droppable("destroy")}},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(d,c){return b.extend(d,c)},getClientXY:function(c){return[c.clientX,c.clientY]},getDragObject:function(c){return c[1].draggable||c[1].helper},getDragScope:function(c){return b(c).draggable("option","scope")},getDropEvent:function(c){return c[0]},getDropScope:function(c){return b(c).droppable("option","scope")},getDOMElement:function(c){if(c==null){return null}if(typeof(c)=="string"){return document.getElementById(c)}else{if(c.context||c.length!=null){return c[0]}else{return c}}},getElementObject:a,getOffset:function(c){return c.offset()},getOriginalEvent:function(c){return c.originalEvent},getPageXY:function(c){return[c.pageX,c.pageY]},getParent:function(c){return a(c).parent()},getScrollLeft:function(c){return c.scrollLeft()},getScrollTop:function(c){return c.scrollTop()},getSelector:function(d,c){if(arguments.length==2){return a(d).find(c)}else{return b(d)}},getSize:function(c){c=b(c);return[c.outerWidth(),c.outerHeight()]},getTagName:function(c){var d=a(c);return d.length>0?d[0].tagName:null},getUIPosition:function(d,e){e=e||1;if(d.length==1){ret={left:d[0].pageX,top:d[0].pageY}}else{var f=d[1],c=f.offset;ret=c||f.absolutePosition;f.position.left/=e;f.position.top/=e}return{left:ret.left/e,top:ret.top/e}},hasClass:function(d,c){return d.hasClass(c)},initDraggable:function(e,d,f,c){d=d||{};e=b(e);d.start=jsPlumbUtil.wrap(d.start,function(){b("body").addClass(c.dragSelectClass)},false);d.stop=jsPlumbUtil.wrap(d.stop,function(){b("body").removeClass(c.dragSelectClass)});if(!d.doNotRemoveHelper){d.helper=null}if(f){d.scope=d.scope||jsPlumb.Defaults.Scope}e.draggable(d)},initDroppable:function(d,c){c.scope=c.scope||jsPlumb.Defaults.Scope;b(d).droppable(c)},isAlreadyDraggable:function(c){return b(c).hasClass("ui-draggable")},isDragSupported:function(d,c){return b(d).draggable},isDropSupported:function(d,c){return b(d).droppable},removeClass:function(d,c){d=a(d);try{if(d[0].className.constructor==SVGAnimatedString){jsPlumbUtil.svg.removeClass(d[0],c);return}}catch(f){}d.removeClass(c)},removeElement:function(c){a(c).remove()},setDragFilter:function(d,c){if(jsPlumb.CurrentLibrary.isAlreadyDraggable(d)){d.draggable("option","cancel",c)}},setDraggable:function(d,c){d.draggable("option","disabled",!c)},setDragScope:function(d,c){d.draggable("option","scope",c)},setOffset:function(c,d){a(c).offset(d)},trigger:function(e,f,c){var d=jQuery._data(a(e)[0],"handle");d(c)},unbind:function(c,d,e){c=a(c);c.unbind(d,e)}};b(document).ready(jsPlumb.init)})(jQuery);