<?xml version="1.0"?>
<component name="org.nuxeo.ecm.platform.forms.layouts.webapp.base">

  <extension target="org.nuxeo.ecm.platform.forms.layout.LayoutStore"
    point="widgets">

    <widget name="userSuggestionSearchType" type="selectOneListbox">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Search type</label>
      </labels>
      <fields>
        <field>userSuggestionSearchType</field>
      </fields>
      <selectOptions>
        <option itemLabel="Users" itemValue="USER_TYPE" />
        <option itemLabel="Groups" itemValue="GROUP_TYPE" />
      </selectOptions>
    </widget>

    <widget name="userSuggestion_firstLabelField" type="text">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">First label field</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Field to use as the first label when displaying the
          selected user. Defaults to 'firstName'.
        </label>
      </helpLabels>
      <fields>
        <field>firstLabelField</field>
      </fields>
    </widget>

    <widget name="userSuggestion_secondLabelField" type="text">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Second label field</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Field to use as the second label when displaying the
          selected user. Defaults to 'lastName'.
        </label>
      </helpLabels>
      <fields>
        <field>secondLabelField</field>
      </fields>
    </widget>

    <widget name="userSuggestion_thirdLabelField" type="text">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Third label field</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Field to use as the third label when displaying the
          selected user. Defaults to 'email'. Available since 5.5.
        </label>
      </helpLabels>
      <fields>
        <field>thirdLabelField</field>
      </fields>
    </widget>

    <widget name="userSuggestion_hideFirstLabel" type="checkbox">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Hide first label</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Boolean indicating if the first label should be
          hidden. Defaults to false.
        </label>
      </helpLabels>
      <fields>
        <field>hideFirstLabel</field>
      </fields>
    </widget>

    <widget name="userSuggestion_hideSecondLabel" type="checkbox">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Hide second label</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Boolean indicating if the second label should be
          hidden.Defaults to false.
        </label>
      </helpLabels>
      <fields>
        <field>hideSecondLabel</field>
      </fields>
    </widget>

    <widget name="userSuggestion_hideThirdLabel" type="checkbox">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Hide third label</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Boolean indicating if the third label should be
          hidden. Defaults to false. Available since 5.5.
        </label>
      </helpLabels>
      <fields>
        <field>hideThirdLabel</field>
      </fields>
    </widget>

    <widget name="userSuggestion_displayAction" type="selectOneListbox">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Display action</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The display action to use when rendering the user or
          group. Can be 'nothing' to just display text only, 'view' to have a
          link going to the user or group view, or 'edit' to have a link going
          to the user or group edition. The 'edit' action assumes the widget is
          used in the Users and Groups management.
        </label>
      </helpLabels>
      <fields>
        <field>displayAction</field>
      </fields>
      <selectOptions>
        <option itemLabel="Nothing" itemValue="nothing" />
        <option itemLabel="View" itemValue="view" />
        <option itemLabel="Edit" itemValue="edit" />
      </selectOptions>
    </widget>

    <widget name="userSuggestion_displayEmailInSuggestion" type="checkbox">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Display email for users</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Boolean indicating if the email should be displayed
          for users. Defaults to false. Available since 5.5.
        </label>
      </helpLabels>
      <fields>
        <field>displayEmailInSuggestion</field>
      </fields>
    </widget>

    <widget name="userSuggestionMaxSearchResults" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Max search results</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Number of maximum search results in the suggestion
          (defaults to 0 that means no limit).
        </label>
      </helpLabels>
      <fields>
        <field>userSuggestionMaxSearchResults</field>
      </fields>
    </widget>

    <widget name="userSuggestion_minChars" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Minimum characters</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The minimal number of characters to type for the
          suggestion to be active. Defaults to 3.
        </label>
      </helpLabels>
      <fields>
        <field>minChars</field>
      </fields>
    </widget>

    <widget name="userSuggestion_frequency" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Frequency</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Delay (in seconds) before activating the suggestion
          pop-up. Default value is 0.
        </label>
      </helpLabels>

      <fields>
        <field>frequency</field>
      </fields>
    </widget>

    <widget name="userSuggestion_requestDelay" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Request delay</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The requestDelay attribute specifies an amount of time
          in milliseconds for the request to wait in the queue before being sent
          to the server. If a similar request is added to the queue before the
          delay is over, the original request is removed from the queue and not
          sent.
        </label>
      </helpLabels>
      <fields>
        <field>requestDelay</field>
      </fields>
    </widget>

    <widget name="userSuggestion_width" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Width</label>
      </labels>
      <helpLabels>
        <label mode="any">The suggestion width.</label>
      </helpLabels>
      <fields>
        <field>width</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_tab" type="text">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Tab</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The tab to select when clicking on the document link.
        </label>
      </helpLabels>
      <fields>
        <field>tab</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_subTab" type="text">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Sub Tab</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The sub tab to select when clicking on the document
          link.
        </label>
      </helpLabels>
      <fields>
        <field>subTab</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_pageProviderName" type="text">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Document page provider name</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The page provider that will be called to perform a
          search for the suggestion. It must accept one parameter that will be
          replaced by the suggestion input. If no name is defined, a default
          page provider is used.
        </label>
      </helpLabels>
      <fields>
        <field>pageProviderName</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_minChars" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Minimum characters</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The minimal number of characters to type for the
          suggestion to be active. Defaults to 3.
        </label>
      </helpLabels>
      <fields>
        <field>minChars</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_frequency" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Frequency</label>
      </labels>
      <helpLabels>
        <label mode="any">
          Delay (in seconds) before activating the suggestion
          pop-up. Default value is 0.
        </label>
      </helpLabels>
      <fields>
        <field>frequency</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_requestDelay" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Request delay</label>
      </labels>
      <helpLabels>
        <label mode="any">
          The requestDelay attribute specifies an amount of time
          in milliseconds for the request to wait in the queue before being sent
          to the server. If a similar request is added to the queue before the
          delay is over, the original request is removed from the queue and not
          sent.
        </label>
      </helpLabels>
      <fields>
        <field>requestDelay</field>
      </fields>
    </widget>

    <widget name="documentSuggestion_width" type="int">
      <categories>
        <category>widgetTypeConf</category>
      </categories>
      <labels>
        <label mode="any">Width</label>
      </labels>
      <helpLabels>
        <label mode="any">The suggestion width.</label>
      </helpLabels>
      <fields>
        <field>width</field>
      </fields>
    </widget>

  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgettypes">

    <widgetType name="select_path_tree">
      <configuration>
        <sinceVersion>5.4.0</sinceVersion>
        <title>Path tree</title>
        <description>
          Widget allowing to select one or more values from a Tree
          constructed
          from the navigation tree.

          Set 'showAllDomains' property to
          true if you want to be able to select
          a path from an other domain than
          the current one.
        </description>
        <categories>
          <category>configuration_not_ready</category>
        </categories>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/select_path_tree_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="singleUserSuggestion">
      <configuration>
        <title>Single user/group suggestion</title>
        <sinceVersion>5.4.2</sinceVersion>
        <supportedModes>
          <mode>edit</mode>
          <mode>view</mode>
        </supportedModes>
        <fields>
          <list>false</list>
          <complex>false</complex>
          <supportedTypes>
            <type>string</type>
          </supportedTypes>
        </fields>
        <categories>
          <category>document</category>
        </categories>
        <properties>
          <layouts mode="view">
            <layout name="singleUserSuggestion_widget_type_properties_view">
              <rows>
                <row>
                  <widget category="widgetTypeConf">userSuggestionSearchType</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_firstLabelField</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_secondLabelField</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_thirdLabelField</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_hideFirstLabel</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_hideSecondLabel</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_hideThirdLabel</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_displayAction</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_displayEmailInSuggestion</widget>
                </row>
              </rows>
            </layout>
          </layouts>
          <layouts mode="edit">
            <layout name="singleUserSuggestion_widget_type_properties_edit">
              <rows>
                <row>
                  <widget category="widgetTypeConf">required</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestionSearchType</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestionMaxSearchResults</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_minChars</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_frequency</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_requestDelay</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_width</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_displayEmailInSuggestion</widget>
                </row>
              </rows>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/single_user_suggestion_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="multipleUsersSuggestion">
      <configuration>
        <title>Multiple users/groups suggestion</title>
        <sinceVersion>5.4.2</sinceVersion>
        <supportedModes>
          <mode>edit</mode>
          <mode>view</mode>
        </supportedModes>
        <fields>
          <list>true</list>
          <complex>false</complex>
          <supportedTypes>
            <type>string</type>
          </supportedTypes>
        </fields>
        <categories>
          <category>document</category>
        </categories>
        <properties>
          <layouts mode="view">
            <layout name="multipleUsersSuggestion_widget_type_properties_view">
              <rows>
                <row>
                  <widget category="widgetTypeConf">userSuggestionSearchType</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_firstLabelField</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_secondLabelField</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_thirdLabelField</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_hideFirstLabel</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_hideSecondLabel</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_hideThirdLabel</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_displayEmailInSuggestion</widget>
                </row>
              </rows>
            </layout>
          </layouts>
          <layouts mode="edit">
            <layout name="multipleUsersSuggestion_widget_type_properties_edit">
              <rows>
                <row>
                  <widget category="widgetTypeConf">required</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestionSearchType</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestionMaxSearchResults</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_minChars</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_frequency</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_requestDelay</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_width</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_displayEmailInSuggestion</widget>
                </row>
              </rows>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/user_suggestion_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="multiplePrefixedUsersSuggestion">
      <configuration>
        <title>Multiple prefixed users/groups suggestion</title>
        <sinceVersion>5.4.2</sinceVersion>
        <supportedModes>
          <mode>view</mode>
          <mode>edit</mode>
        </supportedModes>
        <fields>
          <list>true</list>
          <complex>false</complex>
          <supportedTypes>
            <type>string</type>
          </supportedTypes>
        </fields>
        <categories>
          <category>document</category>
        </categories>
        <properties>
          <layouts mode="edit">
            <layout
              name="multiplePrefixedUsersSuggestion_widget_type_properties_edit">
              <rows>
                <row>
                  <widget category="widgetTypeConf">required</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestionSearchType</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestionMaxSearchResults</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_minChars</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_frequency</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_requestDelay</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">userSuggestion_width</widget>
                </row>
              </rows>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/user_prefixed_suggestion_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="multipleDocumentsSuggestion">
      <configuration>
        <title>Multiple documents suggestion</title>
        <sinceVersion>5.4.2</sinceVersion>
        <supportedModes>
          <mode>view</mode>
          <mode>edit</mode>
        </supportedModes>
        <fields>
          <list>true</list>
          <complex>false</complex>
          <supportedTypes>
            <type>string</type>
          </supportedTypes>
        </fields>
        <categories>
          <category>document</category>
        </categories>
        <properties>
          <layouts mode="view">
            <layout name="multipleDocumentsSuggestion_widget_type_properties_view">
              <rows>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_tab</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_subTab</widget>
                </row>
              </rows>
            </layout>
          </layouts>
          <layouts mode="edit">
            <layout name="multipleDocumentsSuggestion_widget_type_properties_edit">
              <rows>
                <row>
                  <widget category="widgetTypeConf">required</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_pageProviderName</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_tab</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_subTab</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_minChars</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_frequency</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_requestDelay</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_width</widget>
                </row>
              </rows>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/multiple_document_suggestion_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="singleDocumentSuggestion">
      <configuration>
        <title>Single document suggestion</title>
        <sinceVersion>5.5</sinceVersion>
        <supportedModes>
          <mode>view</mode>
          <mode>edit</mode>
        </supportedModes>
        <fields>
          <list>false</list>
          <complex>false</complex>
          <supportedTypes>
            <type>string</type>
          </supportedTypes>
        </fields>
        <categories>
          <category>document</category>
        </categories>
        <properties>
          <layouts mode="view">
            <layout name="singleDocumentSuggestion_widget_type_properties_view">
              <rows>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_tab</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_subTab</widget>
                </row>
              </rows>
            </layout>
          </layouts>
          <layouts mode="edit">
            <layout name="singleDocumentSuggestion_widget_type_properties_edit">
              <rows>
                <row>
                  <widget category="widgetTypeConf">required</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_tab</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_subTab</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_pageProviderName</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_minChars</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_frequency</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_requestDelay</widget>
                </row>
                <row>
                  <widget category="widgetTypeConf">documentSuggestion_width</widget>
                </row>
              </rows>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/single_document_suggestion_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="title_and_permlink">
      <configuration>
        <sinceVersion>5.4.2</sinceVersion>
        <title>Title and permanent link</title>
        <description>
          This widgets displays the document title with a permlink icon. If the
          document is a version, the major and minor are displayed in
          parenthesis.

          One field is required :
          <ul>
            <li>an empty field to map the document</li>
          </ul>

          Since 5.5, it also displays the document header related actions.
          They
          must be contributed in one of the following categories:
          <ul>
            <li>DOCUMENT_HEADER_ACTIONS_LIST</li>
            <li>DOCUMENT_HEADER_ACTIONS_LIST_HREF</li>
          </ul>

        </description>
        <fields>
          <list>false</list>
          <complex>false</complex>
          <defaultConfiguration>
            <field></field>
            <field>uid:major_version</field>
            <field>uid:minor_version</field>
          </defaultConfiguration>
        </fields>
        <categories>
          <category>document</category>
        </categories>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/title_with_permlink_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="select_l10n_vocabulary_tree">
      <configuration>
        <sinceVersion>5.5</sinceVersion>
        <title>Localized vocabulary tree</title>
        <description>
          Widget allowing to select one or more values in a tree
          constructed
          from a l10nvocabulary or l10nxvocabulary directory.
        </description>
        <categories>
          <category>configuration_not_ready</category>
        </categories>
        <properties>
          <layouts mode="any">
            <layout name="select_l10n_vocabulary_tree_widget_type_properties_any">
              <rows>
                <row>
                  <widget>directoryName</widget>
                </row>
                <row>
                  <widget>directoryNameDemoPreview</widget>
                </row>
                <row>
                  <widget>selectIdOnly</widget>
                </row>
                <row>
                  <widget>keySeparator</widget>
                </row>
              </rows>
              <widget name="directoryName" type="selectOneResource">
                <labels>
                  <label mode="any">Vocabulary</label>
                </labels>
                <fields>
                  <field>directoryName</field>
                </fields>
                <widgetModes>
                  <mode value="edit_demo_preview">hidden</mode>
                </widgetModes>
                <properties mode="any">
                  <property name="resourceName">vocabularies</property>
                </properties>
                <properties widgetMode="any">
                  <property name="required">true</property>
                </properties>
              </widget>
              <widget name="directoryNameDemoPreview" type="text">
                <labels>
                  <label mode="any">Vocabulary</label>
                </labels>
                <fields>
                  <field>directoryName</field>
                </fields>
                <widgetModes>
                  <mode value="any">hidden</mode>
                  <mode value="edit_demo_preview">view</mode>
                </widgetModes>
                <properties widgetMode="any">
                  <property name="required">true</property>
                </properties>
              </widget>
              <widget name="selectIdOnly" type="checkbox">
                <labels>
                  <label mode="any">Select id only</label>
                </labels>
                <helpLabels>
                  <label mode="any">
                    If set to true, only the entries id are
                    stored instead of
                    their path.
                  </label>
                </helpLabels>
                <fields>
                  <field>selectIdOnly</field>
                </fields>
              </widget>
              <widget name="keySeparator" type="text">
                <labels>
                  <label mode="any">Key separator</label>
                </labels>
                <helpLabels>
                  <label mode="any">
                    The string used to separate directory keys
                    in the value.
                    Defaults to "/".
                  </label>
                </helpLabels>
                <fields>
                  <field>keySeparator</field>
                </fields>
              </widget>
            </layout>
          </layouts>
          <layouts mode="edit">
            <layout name="select_l10n_vocabulary_tree_widget_type_properties_edit">
              <rows>
                <row>
                  <widget>multiSelect</widget>
                </row>
                <row>
                  <widget>displayObsoleteEntries</widget>
                </row>
                <row>
                  <widget>ordering</widget>
                </row>
              </rows>
              <widget name="multiSelect" type="checkbox">
                <labels>
                  <label mode="any">Multiple selection</label>
                </labels>
                <fields>
                  <field>multiSelect</field>
                </fields>
              </widget>
              <widget name="displayObsoleteEntries" type="checkbox">
                <labels>
                  <label mode="any">Display obsolete entries</label>
                </labels>
                <fields>
                  <field>displayObsoleteEntries</field>
                </fields>
              </widget>
              <widget name="ordering" type="selectOneListbox">
                <labels>
                  <label mode="any">Sort criterion</label>
                </labels>
                <fields>
                  <field>ordering</field>
                </fields>
                <selectOptions>
                  <option itemLabel="Label (default)" itemValue="label" />
                  <option itemLabel="Ordering" itemValue="ordering" />
                  <option itemLabel="Id" itemValue="id" />
                </selectOptions>
              </widget>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/select_l10n_vocabulary_tree_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="contentViewWithForms">
      <configuration>
        <sinceVersion>5.5</sinceVersion>
        <title>Content view</title>
        <description>
          This widget displays a content view, with forms inside it.
        </description>
        <categories>
          <!-- don't export it yet -->
          <category>configuration_not_ready</category>
          <!--
            <category>summary</category>
          -->
        </categories>
        <supportedModes>
          <mode>view</mode>
        </supportedModes>
        <properties>
          <layouts mode="any">
            <layout name="contentView_widget_type_properties_any">
              <rows>
                <row>
                  <widget>contentViewName</widget>
                </row>
              </rows>
              <widget name="contentViewName" type="selectOneResource">
                <labels>
                  <label mode="any">Content View name</label>
                </labels>
                <fields>
                  <field>contentViewName</field>
                </fields>
                <properties mode="any">
                  <property name="resourceName">contentViews</property>
                </properties>
              </widget>
            </layout>
          </layouts>
        </properties>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/content_view_with_forms_widget.xhtml
      </property>
    </widgetType>

    <widgetType name="userVirtualGroups">
      <configuration>
        <sinceVersion>5.5</sinceVersion>
        <title>User virtual groups</title>
        <description>
          This widget displays the user virtual groups.
        </description>
        <categories>
          <category>configuration_not_ready</category>
        </categories>
        <supportedModes>
          <mode>view</mode>
        </supportedModes>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /widgets/user_vgoups_widget_template.xhtml
      </property>
    </widgetType>

  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="layouts">

    <layout name="user">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <widget>username</widget>
        </row>
        <row>
          <widget>firstname</widget>
        </row>
        <row>
          <widget>lastname</widget>
        </row>
        <row>
          <widget>company</widget>
        </row>
        <row>
          <widget>email</widget>
        </row>
        <row>
          <widget>firstPassword</widget>
        </row>
        <row>
          <widget>secondPassword</widget>
        </row>
        <row>
          <widget>passwordMatcher</widget>
        </row>
        <row>
          <widget>groups</widget>
        </row>
        <row>
          <widget>vgroups</widget>
        </row>
      </rows>
      <widget name="username" type="text">
        <labels>
          <label mode="any">username</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">username</field>
        </fields>
        <widgetModes>
          <mode value="create">edit</mode>
          <mode value="editPassword">hidden</mode>
          <mode value="any">view</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="required">true</property>
          <property name="styleClass">dataInputText</property>
          <property name="validator">
            #{userManagementActions.validateUserName}
          </property>
        </properties>
      </widget>
      <widget name="firstname" type="text">
        <labels>
          <label mode="any">firstName</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">firstName</field>
        </fields>
        <widgetModes>
          <mode value="editPassword">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="lastname" type="text">
        <labels>
          <label mode="any">lastName</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">lastName</field>
        </fields>
        <widgetModes>
          <mode value="editPassword">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="company" type="text">
        <labels>
          <label mode="any">company</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">company</field>
        </fields>
        <widgetModes>
          <mode value="editPassword">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="email" type="text">
        <labels>
          <label mode="any">email</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">email</field>
        </fields>
        <widgetModes>
          <mode value="editPassword">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="required">true</property>
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="firstPassword" type="secret">
        <labels>
          <label mode="any">password</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">password</field>
        </fields>
        <widgetModes>
          <mode value="create">edit</mode>
          <mode value="editPassword">edit</mode>
          <mode value="any">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="required">true</property>
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="secondPassword" type="secret">
        <labels>
          <label mode="any">password.verify</label>
        </labels>
        <translated>true</translated>
        <widgetModes>
          <mode value="create">edit</mode>
          <mode value="editPassword">edit</mode>
          <mode value="any">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <property name="required">true</property>
          <property name="styleClass">dataInputText</property>
        </properties>
      </widget>
      <widget name="passwordMatcher" type="template">
        <labels>
          <label mode="any"></label>
        </labels>
        <translated>true</translated>
        <widgetModes>
          <mode value="create">edit</mode>
          <mode value="editPassword">edit</mode>
          <mode value="any">hidden</mode>
        </widgetModes>
        <properties widgetMode="edit">
          <!-- XXX: depends on firstPassword and secondPassword widget names -->
          <property name="template">
            /widgets/user_password_validation_widget_template.xhtml
          </property>
        </properties>
      </widget>
      <widget name="groups" type="template">
        <labels>
          <label mode="any">label.userManager.userGroups</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">groups</field>
        </fields>
        <widgetModes>
          <mode value="edit">
            #{nxu:test(currentUser.administrator, 'edit',
            'view')}
          </mode>
          <mode value="editPassword">hidden</mode>
        </widgetModes>
        <properties widgetMode="any">
          <property name="template">
            /widgets/user_suggestion_widget_template.xhtml
          </property>
          <property name="hideVirtualGroups">true</property>
          <property name="userSuggestionSearchType">GROUP_TYPE</property>
        </properties>
      </widget>
      <widget name="vgroups" type="userVirtualGroups">
        <labels>
          <label mode="any">label.userManager.userVirtualGroups</label>
        </labels>
        <translated>true</translated>
        <fields>
          <field schema="user">username</field>
        </fields>
        <widgetModes>
          <mode value="create">hidden</mode>
          <mode value="editPassword">hidden</mode>
        </widgetModes>
      </widget>
    </layout>

    <layout name="group">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <widget>group_name</widget>
        </row>
        <row>
          <widget>group_label</widget>
        </row>
        <row>
          <widget>group_members</widget>
        </row>
        <row>
          <widget>group_subgroups</widget>
        </row>
      </rows>
    </layout>

    <layout name="user_group_suggestion">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <widget>selection</widget>
        </row>
      </rows>
      <widget name="selection" type="template">
        <!-- add empty field to map layout value directly -->
        <fields>
          <field></field>
        </fields>
        <labels>
          <label mode="any"></label>
        </labels>
        <properties mode="any">
          <property name="template">
            /widgets/user_suggestion_widget_template.xhtml
          </property>
        </properties>

      </widget>
    </layout>

    <layout name="user_group_prefixed_suggestion">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <widget>selection</widget>
        </row>
      </rows>
      <widget name="selection" type="template">
        <!-- add empty field to map layout value directly -->
        <fields>
          <field></field>
        </fields>
        <labels>
          <label mode="any"></label>
        </labels>
        <properties mode="any">
          <property name="template">
            /widgets/user_prefixed_suggestion_widget_template.xhtml
          </property>
        </properties>
      </widget>
    </layout>

    <layout name="document_content_filter">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <widget>search_title</widget>
        </row>
        <row>
          <widget>search_modified_min</widget>
          <widget>search_modified_max</widget>
        </row>
      </rows>
    </layout>

  </extension>

</component>
